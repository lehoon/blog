<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>tcpdump使用文档 | 豌豆荚博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="tcpdump可以将网络中传送的数据包的“头”完全截获下来提供分析。它支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息。tcpdump就是一种免费的网络分析工具，尤其其提供了源代码，公开了接口，因此具备很强的可扩展性，对于网络维护和入侵者都是非常有用的工具。tcpdump存在于基本的FreeBSD系统中，由于它需要将网络界面设置为混杂模式，普">
<meta property="og:type" content="article">
<meta property="og:title" content="tcpdump使用文档">
<meta property="og:url" content="http://lehoon.cn/backend/2016/09/26/tcpdump.html">
<meta property="og:site_name" content="豌豆荚博客">
<meta property="og:description" content="tcpdump可以将网络中传送的数据包的“头”完全截获下来提供分析。它支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息。tcpdump就是一种免费的网络分析工具，尤其其提供了源代码，公开了接口，因此具备很强的可扩展性，对于网络维护和入侵者都是非常有用的工具。tcpdump存在于基本的FreeBSD系统中，由于它需要将网络界面设置为混杂模式，普">
<meta property="og:locale">
<meta property="article:published_time" content="2016-09-26T02:49:41.000Z">
<meta property="article:modified_time" content="2023-06-25T06:08:59.061Z">
<meta property="article:author" content="lehoon">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="tcpdump">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="豌豆荚博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
  <script src="/js/pace.js"></script>
  <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: 'https://lehoon.cn',
          fancybox: true,
          animate: false,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Lehoon"></a></h1>
        </hgroup>

        
        
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives">文章</a></li>
                        
                            <li><a href="/projects">项目</a></li>
                        
                            <li><a href="/polymerization">聚合</a></li>
                        
                            <li><a href="/about">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/lehoon" title="github">github</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a>
                            
                                <a class="fl rss" target="_blank" href="/rss.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">热爱生活，享受生活。</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives">文章</a></li>
                
                    <li><a href="/projects">项目</a></li>
                
                    <li><a href="/polymerization">聚合</a></li>
                
                    <li><a href="/about">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/lehoon" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/rss.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-tcpdump" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/backend/2016/09/26/tcpdump.html" class="article-date">
      <time datetime="2016-09-26T02:49:41.000Z" itemprop="datePublished">2016-09-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      tcpdump使用文档
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/backend/">后端</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tcpdump/" rel="tag">tcpdump</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>tcpdump可以将网络中传送的数据包的“头”完全截获下来提供分析。它支持针对网络层、协议、主机、网络或端口的过滤，并提供and、or、not等逻辑语句来帮助你去掉无用的信息。tcpdump就是一种免费的网络分析工具，尤其其提供了源代码，公开了接口，因此具备很强的可扩展性，对于网络维护和入侵者都是非常有用的工具。tcpdump存在于基本的FreeBSD系统中，由于它需要将网络界面设置为混杂模式，普通用户不能正常执行，但具备root权限的用户可以直接执行它来获取网络上的信息。因此系统中存在网络分析工具主要不是对本机安全的威胁，而是对网络上的其他计算机的安全存在威胁。<br>我们用尽量简单的话来定义tcpdump，就是：dump the traffice on anetwork。根据使用者的定义对网络上的数据包进行截获的包分析工具。作为互联网上经典的的系统管理员必备工具，tcpdump以其强大的功能，灵活的截取策略，成为每个高级的系统管理员分析网络，排查问题等所必备的东西之一。tcpdump提供了源代码，公开了接口，因此具备很强的可扩展性，对于网络维护和入侵者都是非常有用的工具。tcpdump存在于基本的FreeBSD系统中，由于它需要将网络界面设置为混杂模式，普通用户不能正常执行，但具备root权限的用户可以直接执行它来获取网络上的信息。因此系统中存在网络分析工具主要不是对本机安全的威胁，而是对网络上的其他计算机的安全存在威胁。  </p>
<span id="more"></span>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="命令格式"><a href="#命令格式" class="headerlink" title="命令格式"></a>命令格式</h3><p>tcpdump采用命令行方式，它的命令格式为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tcpdump <span class="selector-attr">[ -AbdDefhHIJKlLnNOpqRStuUvxX ]</span> <span class="selector-attr">[ -B buffer_size ]</span> <span class="selector-attr">[ -c count ]</span></span><br><span class="line">        <span class="selector-attr">[ -C file_size ]</span> <span class="selector-attr">[ -G rotate_seconds ]</span> <span class="selector-attr">[ -F file ]</span></span><br><span class="line">        <span class="selector-attr">[ -i interface ]</span> <span class="selector-attr">[ -j tstamp_type ]</span> <span class="selector-attr">[ -m module ]</span> <span class="selector-attr">[ -M secret ]</span></span><br><span class="line">        <span class="selector-attr">[ -P in|out|inout ]</span></span><br><span class="line">        <span class="selector-attr">[ -r file ]</span> <span class="selector-attr">[ -V file ]</span> <span class="selector-attr">[ -s snaplen ]</span> <span class="selector-attr">[ -T type ]</span> <span class="selector-attr">[ -w file ]</span></span><br><span class="line">        <span class="selector-attr">[ -W filecount ]</span></span><br><span class="line">        <span class="selector-attr">[ -E spi@ipaddr algo:secret,...  ]</span></span><br><span class="line">        <span class="selector-attr">[ -y datalinktype ]</span> <span class="selector-attr">[ -z postrotate-command ]</span> <span class="selector-attr">[ -Z user ]</span></span><br><span class="line">        <span class="selector-attr">[ expression ]</span></span><br></pre></td></tr></table></figure>

<h3 id="命令介绍"><a href="#命令介绍" class="headerlink" title="命令介绍"></a>命令介绍</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-A</span>  以<span class="selector-tag">ASCII</span>码方式显示每一个数据包(不会显示数据包中链路层头部信息). 在抓取包含网页数据的数据包时, 可方便查看数据(<span class="attribute">nt</span>: 即Handy for capturing web pages).</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-c</span>  <span class="selector-tag">count</span></span><br><span class="line">    <span class="selector-tag">tcpdump</span>将在接受到<span class="selector-tag">count</span>个数据包后退出.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-C</span>  <span class="selector-tag">file-size</span> (<span class="attribute">nt</span>: 此选项用于配合-w file 选项使用)</span><br><span class="line">    该选项使得<span class="selector-tag">tcpdump</span> 在把原始数据包直接保存到文件中之前, 检查此文件大小是否超过<span class="selector-tag">file-size</span>. 如果超过了, 将关闭此文件,另创一个文件继续用于原始数据包的记录. 新创建的文件名与<span class="selector-tag">-w</span> 选项指定的文件名一致, 但文件名后多了一个数字.该数字会从<span class="number">1</span>开始随着新创建文件的增多而增加. <span class="selector-tag">file-size</span>的单位是百万字节(<span class="attribute">nt</span>: 这里指<span class="number">1</span>,<span class="number">000</span>,<span class="number">000</span>个字节,并非<span class="number">1</span>,<span class="number">048</span>,<span class="number">576</span>个字节, 后者是以<span class="number">1024</span>字节为<span class="number">1</span>k, <span class="number">1024</span>k字节为<span class="number">1</span>M计算所得, 即<span class="number">1</span>M=<span class="number">1024</span> ＊ <span class="number">1024</span> ＝ <span class="number">1</span>,<span class="number">048</span>,<span class="number">576</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-d</span>  以容易阅读的形式,在标准输出上打印出编排过的包匹配码, 随后<span class="selector-tag">tcpdump</span>停止.(nt | <span class="attribute">rt</span>: human readable, 容易阅读的,通常是指以ascii码来打印一些信息. compiled, 编排过的. packet-matching code, 包匹配码,含义未知, 需补充)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-dd</span> 以<span class="selector-tag">C</span>语言的形式打印出包匹配码.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-ddd</span> 以十进制数的形式打印出包匹配码(会在包匹配码之前有一个附加的<span class="string">&#x27;count&#x27;</span>前缀).</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-D</span>  打印系统中所有<span class="selector-tag">tcpdump</span>可以在其上进行抓包的网络接口. 每一个接口会打印出数字编号, 相应的接口名字, 以及可能的一个网络接口描述. 其中网络接口名字和数字编号可以用在<span class="selector-tag">tcpdump</span> 的<span class="selector-tag">-i</span> <span class="selector-tag">flag</span> 选项(<span class="attribute">nt</span>: 把名字或数字代替flag), 来指定要在其上抓包的网络接口.</span><br><span class="line"></span><br><span class="line">    此选项在不支持接口列表命令的系统上很有用(<span class="attribute">nt</span>: 比如, Windows 系统, 或缺乏 ifconfig -a 的UNIX系统); 接口的数字编号在<span class="selector-tag">windows</span> <span class="number">2000</span> 或其后的系统中很有用, 因为这些系统上的接口名字比较复杂, 而不易使用.</span><br><span class="line"></span><br><span class="line">    如果<span class="selector-tag">tcpdump</span>编译时所依赖的<span class="selector-tag">libpcap</span>库太老,<span class="selector-tag">-D</span> 选项不会被支持, 因为其中缺乏 <span class="selector-tag">pcap_findalldevs</span>()函数.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-e</span>  每行的打印输出中将包括数据包的数据链路层头部信息</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-E</span>  <span class="selector-tag">spi</span>@<span class="selector-tag">ipaddr</span> <span class="selector-tag">algo</span>:<span class="selector-tag">secret</span>,...</span><br><span class="line"></span><br><span class="line">    可通过<span class="selector-tag">spi</span>@<span class="selector-tag">ipaddr</span> <span class="selector-tag">algo</span>:<span class="selector-tag">secret</span> 来解密<span class="selector-tag">IPsec</span> <span class="selector-tag">ESP</span>包(nt | <span class="attribute">rt</span>:IPsec Encapsulating Security Payload,IPsec 封装安全负载, IPsec可理解为, 一整套对ip数据包的加密协议, ESP 为整个IP 数据包或其中上层协议部分被加密后的数据,前者的工作模式称为隧道模式; 后者的工作模式称为传输模式 . 工作原理, 另需补充).</span><br><span class="line"></span><br><span class="line">    需要注意的是, 在终端启动<span class="selector-tag">tcpdump</span> 时, 可以为<span class="selector-tag">IPv4</span> <span class="selector-tag">ESP</span> <span class="selector-tag">packets</span> 设置密钥(secret）.</span><br><span class="line"></span><br><span class="line">    可用于加密的算法包括des-cbc, <span class="number">3</span>des-cbc, blowfish-cbc, rc3-cbc, cast128-cbc, 或者没有(none).默认的是<span class="built_in">des-cbc</span>(<span class="attribute">nt</span>: des, Data Encryption Standard, 数据加密标准, 加密算法未知, 另需补充).secret 为用于ESP 的密钥, 使用ASCII 字符串方式表达. 如果以 <span class="number">0</span>x 开头, 该密钥将以<span class="number">16</span>进制方式读入.</span><br><span class="line"></span><br><span class="line">    该选项中ESP 的定义遵循RFC2406, 而不是 RFC1827. 并且, 此选项只是用来调试的, 不推荐以真实密钥(secret)来使用该选项, 因为这样不安全: 在命令行中输入的secret 可以被其他人通过ps 等命令查看到.</span><br><span class="line"></span><br><span class="line">    除了以上的语法格式(<span class="attribute">nt</span>: 指spi<span class="variable">@ipaddr</span> <span class="attribute">algo</span>:secret), 还可以在后面添加一个语法输入文件名字供tcpdump 使用(nt：即把spi<span class="variable">@ipaddr</span> <span class="attribute">algo</span>:secret,... 中...换成一个语法文件名). 此文件在接受到第一个ESP　包时会打开此文件, 所以最好此时把赋予tcpdump 的一些特权取消(<span class="attribute">nt</span>: 可理解为, 这样防范之后, 当该文件为恶意编写时,不至于造成过大损害).</span><br><span class="line"></span><br><span class="line">-f  显示外部的IPv4 地址时(<span class="attribute">nt</span>: foreign IPv4 addresses, 可理解为, 非本机ip地址), 采用数字方式而不是名字.(此选项是用来对付Sun公司的NIS服务器的缺陷(<span class="attribute">nt</span>: NIS, 网络信息服务, tcpdump 显示外部地址的名字时会用到她提供的名称服务): 此NIS服务器在查询非本地地址名字时,常常会陷入无尽的查询循环).</span><br><span class="line"></span><br><span class="line">    由于对外部(foreign)IPv4地址的测试需要用到本地网络接口(<span class="attribute">nt</span>: tcpdump 抓包时用到的接口)及其IPv4 地址和网络掩码. 如果此地址或网络掩码不可用, 或者此接口根本就没有设置相应网络地址和网络掩码(<span class="attribute">nt</span>: linux 下的 <span class="string">&#x27;any&#x27;</span> 网络接口就不需要设置地址和掩码, 不过此<span class="string">&#x27;any&#x27;</span>接口可以收到系统中所有接口的数据包), 该选项不能正常工作.</span><br><span class="line"></span><br><span class="line">-F  file</span><br><span class="line">    使用file 文件作为过滤条件表达式的输入, 此时命令行上的输入将被忽略.</span><br><span class="line"></span><br><span class="line">-i  interface</span><br><span class="line"></span><br><span class="line">    指定tcpdump 需要监听的接口.  如果没有指定, tcpdump 会从系统接口列表中搜寻编号最小的已配置好的接口(不包括 loopback 接口).一但找到第一个符合条件的接口, 搜寻马上结束.</span><br><span class="line"></span><br><span class="line">    在采用<span class="number">2.2</span>版本或之后版本内核的Linux 操作系统上, <span class="string">&#x27;any&#x27;</span> 这个虚拟网络接口可被用来接收所有网络接口上的数据包(<span class="attribute">nt</span>: 这会包括目的是该网络接口的, 也包括目的不是该网络接口的). 需要注意的是如果真实网络接口不能工作在<span class="string">&#x27;混杂&#x27;</span>模式(promiscuous)下,则无法在<span class="string">&#x27;any&#x27;</span>这个虚拟的网络接口上抓取其数据包.</span><br><span class="line"></span><br><span class="line">    如果 -D 标志被指定, tcpdump会打印系统中的接口编号，而该编号就可用于此处的interface 参数.</span><br><span class="line"></span><br><span class="line">-l  对标准输出进行行缓冲(<span class="attribute">nt</span>: 使标准输出设备遇到一个换行符就马上把这行的内容打印出来).在需要同时观察抓包打印以及保存抓包记录的时候很有用. 比如, 可通过以下命令组合来达到此目的:</span><br><span class="line">    <span class="built_in">``</span>tcpdump  -l  |  tee dat<span class="string">&#x27;&#x27;</span> 或者 <span class="built_in">``</span>tcpdump  -l   &gt; dat  &amp;  tail  -f  dat<span class="string">&#x27;&#x27;</span>.(<span class="attribute">nt</span>: 前者使用tee来把tcpdump 的输出同时放到文件dat和标准输出中, 而后者通过重定向操作<span class="string">&#x27;&gt;&#x27;</span>, 把tcpdump的输出放到dat 文件中, 同时通过tail把dat文件中的内容放到标准输出中)</span><br><span class="line"></span><br><span class="line">-L  列出指定网络接口所支持的数据链路层的类型后退出.(<span class="attribute">nt</span>: 指定接口通过-i 来指定)</span><br><span class="line"></span><br><span class="line">-m  module</span><br><span class="line">    通过module 指定的file 装载SMI MIB 模块(<span class="attribute">nt</span>: SMI，Structure of Management Information, 管理信息结构MIB, Management Information Base, 管理信息库. 可理解为, 这两者用于<span class="built_in">SNMP</span>(Simple Network Management Protoco)协议数据包的抓取. 具体SNMP 的工作原理未知, 另需补充).</span><br><span class="line"></span><br><span class="line">    此选项可多次使用, 从而为tcpdump 装载不同的MIB 模块.</span><br><span class="line"></span><br><span class="line">-M  secret  如果TCP 数据包(TCP segments)有TCP-MD5选项(在RFC <span class="number">2385</span>有相关描述), 则为其摘要的验证指定一个公共的密钥secret.</span><br><span class="line"></span><br><span class="line">-n  不对地址(比如, 主机地址, 端口号)进行数字表示到名字表示的转换.</span><br><span class="line"></span><br><span class="line">-N  不打印出host 的域名部分. 比如, 如果设置了此选现, tcpdump 将会打印<span class="string">&#x27;nic&#x27;</span> 而不是 <span class="string">&#x27;nic.ddn.mil&#x27;</span>.</span><br><span class="line"></span><br><span class="line">-O  不启用进行包匹配时所用的优化代码. 当怀疑某些bug是由优化代码引起的, 此选项将很有用.</span><br><span class="line"></span><br><span class="line">-p  一般情况下, 把网络接口设置为非<span class="string">&#x27;混杂&#x27;</span>模式. 但必须注意 , 在特殊情况下此网络接口还是会以<span class="string">&#x27;混杂&#x27;</span>模式来工作； 从而, <span class="string">&#x27;-p&#x27;</span> 的设与不设, 不能当做以下选现的代名词:<span class="string">&#x27;ether host &#123;local-hw-add&#125;&#x27;</span> 或  <span class="string">&#x27;ether broadcast&#x27;</span>(<span class="attribute">nt</span>: 前者表示只匹配以太网地址为host 的包, 后者表示匹配以太网地址为广播地址的数据包).</span><br><span class="line"></span><br><span class="line">-q  快速(也许用<span class="string">&#x27;安静&#x27;</span>更好?)打印输出. 即打印很少的协议相关信息, 从而输出行都比较简短.</span><br><span class="line"></span><br><span class="line">-R  设定tcpdump 对 ESP/AH 数据包的解析按照 RFC1825而不是<span class="built_in">RFC1829</span>(<span class="attribute">nt</span>: AH, 认证头, ESP， 安全负载封装, 这两者会用在IP包的安全传输机制中). 如果此选项被设置, tcpdump 将不会打印出<span class="string">&#x27;禁止中继&#x27;</span>域(<span class="attribute">nt</span>: relay prevention field). 另外,由于ESP/AH规范中没有规定ESP/AH数据包必须拥有协议版本号域,所以tcpdump不能从收到的ESP/AH数据包中推导出协议版本号.</span><br><span class="line"></span><br><span class="line">-r  file</span><br><span class="line">    从文件file 中读取包数据. 如果file 字段为 <span class="string">&#x27;-&#x27;</span> 符号, 则tcpdump 会从标准输入中读取包数据.</span><br><span class="line"></span><br><span class="line">-S  打印TCP 数据包的顺序号时, 使用绝对的顺序号, 而不是相对的顺序号.(<span class="attribute">nt</span>: 相对顺序号可理解为, 相对第一个TCP 包顺序号的差距,比如, 接受方收到第一个数据包的绝对顺序号为<span class="number">232323</span>, 对于后来接收到的第<span class="number">2</span>个,第<span class="number">3</span>个数据包, tcpdump会打印其序列号为<span class="number">1</span>, <span class="number">2</span>分别表示与第一个数据包的差距为<span class="number">1</span> 和 <span class="number">2</span>. 而如果此时-S 选项被设置, 对于后来接收到的第<span class="number">2</span>个, 第<span class="number">3</span>个数据包会打印出其绝对顺序号:<span class="number">232324</span>, <span class="number">232325</span>).</span><br><span class="line"></span><br><span class="line">-s  snaplen</span><br><span class="line">    设置tcpdump的数据包抓取长度为snaplen, 如果不设置默认将会是<span class="number">68</span>字节(而支持网络接口分接头(<span class="attribute">nt</span>: NIT, 上文已有描述,可搜索<span class="string">&#x27;网络接口分接头&#x27;</span>关键字找到那里)的SunOS系列操作系统中默认的也是最小值是<span class="number">96</span>).<span class="number">68</span>字节对于IP, <span class="built_in">ICMP</span>(<span class="attribute">nt</span>: Internet Control Message Protocol,因特网控制报文协议), TCP 以及 UDP 协议的报文已足够, 但对于名称服务(<span class="attribute">nt</span>: 可理解为dns, nis等服务), NFS服务相关的数据包会产生包截短. 如果产生包截短这种情况, tcpdump的相应打印输出行中会出现<span class="string">&#x27;&#x27;</span>[|proto]<span class="string">&#x27;&#x27;</span>的标志（proto 实际会显示为被截短的数据包的相关协议层次). 需要注意的是, 采用长的抓取长度(<span class="attribute">nt</span>: snaplen比较大), 会增加包的处理时间, 并且会减少<span class="selector-tag">tcpdump</span> 可缓存的数据包的数量， 从而会导致数据包的丢失. 所以, 在能抓取我们想要的包的前提下, 抓取长度越小越好.把<span class="selector-tag">snaplen</span> 设置为<span class="number">0</span> 意味着让<span class="selector-tag">tcpdump</span>自动选择合适的长度来抓取数据包.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-T</span>  <span class="selector-tag">type</span></span><br><span class="line">    强制<span class="selector-tag">tcpdump</span>按<span class="selector-tag">type</span>指定的协议所描述的包结构来分析收到的数据包.  目前已知的<span class="selector-tag">type</span> 可取的协议为:</span><br><span class="line">    <span class="selector-tag">aodv</span> (Ad-hoc On-demand Distance Vector protocol, 按需距离向量路由协议, 在Ad <span class="built_in">hoc</span>(点对点模式)网络中使用),</span><br><span class="line">    <span class="selector-tag">cnfp</span> (Cisco  NetFlow  protocol),  <span class="selector-tag">rpc</span>(Remote Procedure Call), <span class="selector-tag">rtp</span> (Real-Time Applications protocol),</span><br><span class="line">    <span class="selector-tag">rtcp</span> (Real-Time Applications con-trol protocol), <span class="selector-tag">snmp</span> (Simple Network Management Protocol),</span><br><span class="line">    <span class="selector-tag">tftp</span> (Trivial File Transfer Protocol, 碎文件协议), <span class="selector-tag">vat</span> (Visual Audio Tool, 可用于在internet 上进行电</span><br><span class="line">    视电话会议的应用层协议), 以及<span class="selector-tag">wb</span> (distributed White Board, 可用于网络会议的应用层协议).</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-t</span>     在每行输出中不打印时间戳</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-tt</span>    不对每行输出的时间进行格式处理(<span class="attribute">nt</span>: 这种格式一眼可能看不出其含义, 如时间戳打印成<span class="number">1261798315</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-ttt</span>   <span class="selector-tag">tcpdump</span> 输出时, 每两行打印之间会延迟一个段时间(以毫秒为单位)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-tttt</span>  在每行打印的时间戳之前添加日期的打印</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-u</span>     打印出未加密的<span class="selector-tag">NFS</span> 句柄(<span class="attribute">nt</span>: handle可理解为NFS 中使用的文件句柄, 这将包括文件夹和文件夹中的文件)</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-U</span>    使得当<span class="selector-tag">tcpdump</span>在使用<span class="selector-tag">-w</span> 选项时, 其文件写入与包的保存同步.(<span class="attribute">nt</span>: 即, 当每个数据包被保存时, 它将及时被写入文件中,而不是等文件的输出缓冲已满时才真正写入此文件)</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">-U</span> 标志在老版本的<span class="selector-tag">libcap</span>库(<span class="attribute">nt</span>: tcpdump 所依赖的报文捕获库)上不起作用, 因为其中缺乏<span class="selector-tag">pcap_cump_flush</span>()函数.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-v</span>    当分析和打印的时候, 产生详细的输出. 比如, 包的生存时间, 标识, 总长度以及<span class="selector-tag">IP</span>包的一些选项. 这也会打开一些附加的包完整性检测, 比如对<span class="selector-tag">IP</span>或<span class="selector-tag">ICMP</span>包头部的校验和.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-vv</span>   产生比<span class="selector-tag">-v</span>更详细的输出. 比如, <span class="selector-tag">NFS</span>回应包中的附加域将会被打印, <span class="selector-tag">SMB</span>数据包也会被完全解码.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-vvv</span>  产生比<span class="selector-tag">-vv</span>更详细的输出. 比如, <span class="selector-tag">telent</span> 时所使用的<span class="selector-tag">SB</span>, <span class="selector-tag">SE</span> 选项将会被打印, 如果<span class="selector-tag">telnet</span>同时使用的是图形界面,</span><br><span class="line">      其相应的图形选项将会以<span class="number">16</span>进制的方式打印出来(<span class="attribute">nt</span>: telnet 的SB,SE选项含义未知, 另需补充).</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-w</span>    把包数据直接写入文件而不进行分析和打印输出. 这些包数据可在随后通过<span class="selector-tag">-r</span> 选项来重新读入并进行分析和打印.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-W</span>    <span class="selector-tag">filecount</span></span><br><span class="line">      此选项与<span class="selector-tag">-C</span> 选项配合使用, 这将限制可打开的文件数目, 并且当文件数据超过这里设置的限制时, 依次循环替代之前的文件, 这相当于一个拥有<span class="selector-tag">filecount</span> 个文件的文件缓冲池. 同时, 该选项会使得每个文件名的开头会出现足够多并用来占位的<span class="number">0</span>, 这可以方便这些文件被正确的排序.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-x</span>    当分析和打印时, <span class="selector-tag">tcpdump</span> 会打印每个包的头部数据, 同时会以<span class="number">16</span>进制打印出每个包的数据(但不包括连接层的头部).总共打印的数据大小不会超过整个数据包的大小与<span class="selector-tag">snaplen</span> 中的最小值. 必须要注意的是, 如果高层协议数据没有<span class="selector-tag">snaplen</span> 这么长,并且数据链路层(比如, Ethernet层)有填充数据, 则这些填充数据也会被打印.(<span class="attribute">nt</span>: so for link  layers  that pad, 未能衔接理解和翻译, 需补充 )</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-xx</span>   <span class="selector-tag">tcpdump</span> 会打印每个包的头部数据, 同时会以<span class="number">16</span>进制打印出每个包的数据, 其中包括数据链路层的头部.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-X</span>    当分析和打印时, <span class="selector-tag">tcpdump</span> 会打印每个包的头部数据, 同时会以<span class="number">16</span>进制和<span class="selector-tag">ASCII</span>码形式打印出每个包的数据(但不包括连接层的头部).这对于分析一些新协议的数据包很方便.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-XX</span>   当分析和打印时, <span class="selector-tag">tcpdump</span> 会打印每个包的头部数据, 同时会以<span class="number">16</span>进制和<span class="selector-tag">ASCII</span>码形式打印出每个包的数据, 其中包括数据链路层的头部.这对于分析一些新协议的数据包很方便.</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-y</span>    <span class="selector-tag">datalinktype</span></span><br><span class="line">      设置<span class="selector-tag">tcpdump</span> 只捕获数据链路层协议类型是<span class="selector-tag">datalinktype</span>的数据包</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-Z</span>    <span class="selector-tag">user</span></span><br><span class="line">      使<span class="selector-tag">tcpdump</span> 放弃自己的超级权限(如果以root用户启动tcpdump, tcpdump将会有超级用户权限), 并把当前<span class="selector-tag">tcpdump</span>的用户<span class="selector-tag">ID</span>设置为<span class="selector-tag">user</span>, 组<span class="selector-tag">ID</span>设置为<span class="selector-tag">user</span>首要所属组的<span class="selector-tag">ID</span>(<span class="attribute">nt</span>: tcpdump 此处可理解为tcpdump 运行之后对应的进程)</span><br><span class="line"></span><br><span class="line">      此选项也可在编译的时候被设置为默认打开.(<span class="attribute">nt</span>: 此时user 的取值未知, 需补充)</span><br></pre></td></tr></table></figure>
<h3 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h3><p>该表达式用于决定哪些数据包将被打印. 如果不给定条件表达式, 网络上所有被捕获的包都会被打印,否则, 只有满足条件表达式的数据包被打印.(nt: all packets, 可理解为, 所有被指定接口捕获的数据包).</p>
<p>表达式由一个或多个’表达元’组成(nt: primitive, 表达元, 可理解为组成表达式的基本元素). 一个表达元通常由一个或多个修饰符(qualifiers)后跟一个名字或数字表示的id组成(nt: 即, ‘qualifiers id’).有三种不同类型的修饰符:type, dir以及 proto.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> 修饰符指定<span class="built_in">id</span> 所代表的对象类型, <span class="built_in">id</span>可以是名字也可以是数字. 可选的对象类型有: host, net, port 以及portrange(nt: host 表明<span class="built_in">id</span>表示主机, net 表明<span class="built_in">id</span>是网络, port 表明<span class="built_in">id</span>是端而portrange 表明<span class="built_in">id</span> 是一个端口范围).  如, <span class="string">&#x27;host foo&#x27;</span>, <span class="string">&#x27;net 128.3&#x27;</span>, <span class="string">&#x27;port 20&#x27;</span>, <span class="string">&#x27;portrange 6000-6008&#x27;</span>(nt: 分别表示主机 foo,网络 <span class="number">128.3</span>, 端口 <span class="number">20</span>, 端口范围 <span class="number">6000</span>-<span class="number">6008</span>). 如果不指定<span class="built_in">type</span> 修饰符, <span class="built_in">id</span>默认的修饰符为host.</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> 修饰符描述<span class="built_in">id</span> 所对应的传输方向, 即发往<span class="built_in">id</span> 还是从<span class="built_in">id</span> 接收（nt: 而<span class="built_in">id</span> 到底指什么需要看其前面的<span class="built_in">type</span> 修饰符）.可取的方向为: src, dst, src 或 dst, src并且dst.(nt:分别表示, <span class="built_in">id</span>是传输源, <span class="built_in">id</span>是传输目的, <span class="built_in">id</span>是传输源或者传输目的, <span class="built_in">id</span>是传输源并且是传输目的). 例如, <span class="string">&#x27;src foo&#x27;</span>,<span class="string">&#x27;dst net 128.3&#x27;</span>, <span class="string">&#x27;src or dst port ftp-data&#x27;</span>.(nt: 分别表示符合条件的数据包中, 源主机是foo, 目的网络是<span class="number">128.3</span>, 源或目的端口为 ftp-data).如果不指定<span class="built_in">dir</span>修饰符, <span class="built_in">id</span> 默认的修饰符为src 或 dst.对于链路层的协议,比如SLIP(nt: Serial Line InternetProtocol, 串联线路网际网络协议), 以及linux下指定<span class="string">&#x27;any&#x27;</span> 设备, 并指定<span class="string">&#x27;cooked&#x27;</span>(nt | rt: cooked 含义未知, 需补充) 抓取类型, 或其他设备类型,可以用<span class="string">&#x27;inbound&#x27;</span> 和 <span class="string">&#x27;outbount&#x27;</span> 修饰符来指定想要的传输方向.</span><br><span class="line"></span><br><span class="line">proto 修饰符描述<span class="built_in">id</span> 所属的协议. 可选的协议有: ether, fddi, tr, wlan, ip, ip6, arp, rarp, decnet, tcp以及 upd.(nt | rt: ether, fddi, tr, 具体含义未知, 需补充. 可理解为物理以太网传输协议, 光纤分布数据网传输协议,以及用于路由跟踪的协议.  wlan, 无线局域网协议; ip,ip6 即通常的TCP/IP协议栈中所使用的ipv4以及ipv6网络层协议;arp, rarp 即地址解析协议,反向地址解析协议; decnet, Digital Equipment Corporation开发的, 最早用于PDP-<span class="number">11</span> 机器互联的网络协议; tcp <span class="keyword">and</span> udp, 即通常TCP/IP协议栈中的两个传输层协议).</span><br><span class="line"></span><br><span class="line">例如, `ether src foo<span class="string">&#x27;, `arp net 128.3&#x27;</span>, `tcp port <span class="number">21</span><span class="string">&#x27;, `udp portrange 7000-7009&#x27;</span>分别表示 <span class="string">&#x27;从以太网地址foo 来的数据包&#x27;</span>,<span class="string">&#x27;发往或来自128.3网络的arp协议数据包&#x27;</span>, <span class="string">&#x27;发送或接收端口为21的tcp协议数据包&#x27;</span>, <span class="string">&#x27;发送或接收端口范围为7000-7009的udp协议数据包&#x27;</span>.</span><br><span class="line"></span><br><span class="line">如果不指定proto 修饰符, 则默认为与相应<span class="built_in">type</span>匹配的修饰符. 例如, <span class="string">&#x27;src foo&#x27;</span> 含义是 <span class="string">&#x27;(ip or arp or rarp) src foo&#x27;</span> (nt: 即, 来自主机foo的ip/arp/rarp协议数据包, 默认<span class="built_in">type</span>为host),`net ba<span class="string">r&#x27; 含义是`(ip  or  arp  or rarp) net bar&#x27;</span>(nt: 即, 来自或发往bar网络的ip/arp/rarp协议数据包),`port <span class="number">53</span><span class="string">&#x27; 含义是 `(tcp or udp) port 53&#x27;</span>(nt: 即, 发送或接收端口为<span class="number">53</span>的tcp/udp协议数据包).(nt: 由于tcpdump 直接通过数据链路层的 BSD 数据包过滤器或 DLPI(datalink provider interface, 数据链层提供者接口)来直接获得网络数据包, 其可抓取的数据包可涵盖上层的各种协议, 包括arp, rarp, icmp(因特网控制报文协议),ip, ip6, tcp, udp, sctp(流控制传输协议).</span><br><span class="line"></span><br><span class="line">对于修饰符后跟<span class="built_in">id</span> 的格式,可理解为, <span class="built_in">type</span> <span class="built_in">id</span> 是对包最基本的过滤条件: 即对包相关的主机, 网络, 端口的限制;<span class="built_in">dir</span> 表示对包的传送方向的限制; proto表示对包相关的协议限制)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;fddi&#x27;</span>(nt: Fiber Distributed Data Interface) 实际上与<span class="string">&#x27;ether&#x27;</span> 含义一样: tcpdump 会把他们当作一种<span class="string">&#x27;&#x27;</span>指定网络接口上的数据链路层协议<span class="string">&#x27;&#x27;</span>. 如同ehter网(以太网), FDDI 的头部通常也会有源, 目的, 以及包类型, 从而可以像ether网数据包一样对这些域进行过滤. 此外, FDDI 头部还有其他的域, 但不能被放到表达式中用来过滤</span><br><span class="line"></span><br><span class="line">同样, <span class="string">&#x27;tr&#x27;</span> 和 <span class="string">&#x27;wlan&#x27;</span> 也和 <span class="string">&#x27;ether&#x27;</span> 含义一致, 上一段对fddi 的描述同样适用于tr(Token Ring) 和wlan(<span class="number">802.11</span> wireless LAN)的头部. 对于<span class="number">802.11</span> 协议数据包的头部, 目的域称为DA, 源域称为 SA;而其中的 BSSID, RA, TA 域(nt | rt: 具体含义需补充)不会被检测(nt: 不能被用于包过虑表达式中).</span><br></pre></td></tr></table></figure>
<p>除以上所描述的表达元(‘primitive’)， 还有其他形式的表达元, 并且与上述表达元格式不同. 比如: gateway, broadcast, less, greater以及算术表达式(nt: 其中每一个都算一种新的表达元). 下面将会对这些表达元进行说明.</p>
<p>表达元之间还可以通过关键字and, or 以及 not 进行连接, 从而可组成比较复杂的条件表达式. 比如,`host foo and not port ftp and not port ftp-data’(nt: 其过滤条件可理解为, 数据包的主机为foo,并且端口不是ftp(端口21) 和ftp-data(端口20, 常用端口和名字的对应可在linux 系统中的/etc/service 文件中找到)).</p>
<p>为了表示方便, 同样的修饰符可以被省略, 如’tcp dst port ftp or ftp-data or domain’ 与以下的表达式含义相同’tcp dst port ftp or tcp dst port ftp-data or tcp dst port domain’.(nt: 其过滤条件可理解为,包的协议为tcp, 目的端口为ftp 或 ftp-data 或 domain(端口53) ).</p>
<p>借助括号以及相应操作符,可把表达元组合在一起使用(由于括号是shell的特殊字符, 所以在shell脚本或终端中使用时必须对括号进行转义, 即’(‘ 与’)’需要分别表达成’(‘ 与 ‘)‘).</p>
<p>有效的操作符有:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">否定操作 (<span class="string">`!&#x27;</span> 或 <span class="string">`not&#x27;</span>)</span><br><span class="line">与操作(<span class="string">`&amp;&amp;&#x27;</span> 或 <span class="string">`and&#x27;</span>)</span><br><span class="line">或操作(<span class="string">`||&#x27;</span> 或 <span class="string">`or&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>否定操作符的优先级别最高. 与操作和或操作优先级别相同, 并且二者的结合顺序是从左到右. 要注意的是, 表达’与操作’时,<br>需要显式写出’and’操作符, 而不只是把前后表达元并列放置(nt: 二者中间的’and’ 操作符不可省略).</p>
<p>如果一个标识符前没有关键字, 则表达式的解析过程中最近用过的关键字(往往也是从左往右距离标识符最近的关键字)将被使用.比如,<br>not host vs and ace<br>是以下表达的精简:<br>not host vs and host ace<br>而不是not (host vs or ace).(nt: 前两者表示, 所需数据包不是来自或发往host vs, 而是来自或发往ace.而后者表示数据包只要不是来自或发往vs或ac都符合要求)</p>
<p>整个条件表达式可以被当作一个单独的字符串参数也可以被当作空格分割的多个参数传入tcpdump, 后者更方便些. 通常, 如果表达式中包含元字符(nt: 如正则表达式中的’*’, ‘.’以及shell中的’(‘等字符)， 最好还是使用单独字符串的方式传入. 这时,整个表达式需要被单引号括起来. 多参数的传入方式中, 所有参数最终还是被空格串联在一起, 作为一个字符串被解析.</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>(true 在以下的描述中含义为: 相应条件表达式中只含有以下所列的一个特定表达元, 此时表达式为真, 即条件得到满足)</p>
<figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br></pre></td><td class="code"><pre><span class="line">dst host host</span><br><span class="line">如果IPv4/v6 数据包的目的域是host, 则与此对应的条件表达式为真.host 可以是一个ip地址, 也可以是一个主机名.</span><br><span class="line">src host host</span><br><span class="line">如果IPv4/v6 数据包的源域是host, 则与此对应的条件表达式为真.</span><br><span class="line">host 可以是一个ip地址, 也可以是一个主机名.</span><br><span class="line">host host</span><br><span class="line"></span><br><span class="line">如果IPv4/v6数据包的源或目的地址是 host, 则与此对应的条件表达式为真.以上的几个host 表达式之前可以添加以下关键字:ip, arp, rarp, 以及 ip6.比如:</span><br><span class="line"><span class="attribute">ip host host</span></span><br><span class="line"><span class="attribute">也可以表达为</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">ether proto \ip and host host(nt</span><span class="punctuation">:</span> <span class="string">这种表达方式在下面有说明, 其中ip之前需要有\来转义,因为ip 对tcpdump 来说已经是一个关键字了.)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">如果host 是一个拥有多个IP 的主机, 那么任何一个地址都会用于包的匹配(nt</span><span class="punctuation">:</span> <span class="string">即发向host 的数据包的目的地址可以是这几个IP中的任何一个, 从host 接收的数据包的源地址也可以是这几个IP中的任何一个).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ether dst ehost</span></span><br><span class="line"><span class="attribute">如果数据包(nt</span><span class="punctuation">:</span> <span class="string">指tcpdump 可抓取的数据包, 包括ip 数据包, tcp数据包)的以太网目标地址是ehost,则与此对应的条件表达式为真. Ehost 可以是/etc/ethers 文件中的名字或一个数字地址(nt: 可通过 man ethers 看到对/etc/ethers 文件的描述, 样例中用的是数字地址)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ether src ehost</span></span><br><span class="line"><span class="attribute">如果数据包的以太网源地址是ehost, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ether host ehost</span></span><br><span class="line"><span class="attribute">如果数据包的以太网源地址或目标地址是ehost, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">gateway host</span></span><br><span class="line"><span class="attribute">如果数据包的网关地址是host, 则与此对应的条件表达式为真. 需要注意的是, 这里的网关地址是指以太网地址, 而不是IP 地址(nt | rt</span><span class="punctuation">:</span> <span class="string">I.e., 例如, 可理解为&#x27;注意&#x27;.the Ethernet source or destination address, 以太网源和目标地址, 可理解为, 指代上句中的&#x27;网关地址&#x27; ).host 必须是名字而不是数字, 并且必须在机器的&#x27;主机名-ip地址&#x27;以及&#x27;主机名-以太地址&#x27;两大映射关系中 有其条目(前一映射关系可通过/etc/hosts文件, DNS 或 NIS得到, 而后一映射关系可通过/etc/ethers 文件得到. nt: /etc/ethers并不一定存在 , 可通过man ethers 看到其数据格式, 如何创建该文件, 未知,需补充).也就是说host 的含义是 ether host ehost 而不是 host host, 并且ehost必须是名字而不是数字.</span></span><br><span class="line"><span class="attribute">目前, 该选项在支持IPv6地址格式的配置环境中不起作用(nt</span><span class="punctuation">:</span> <span class="string">configuration, 配置环境, 可理解为,通信双方的网络配置).</span></span><br><span class="line"></span><br><span class="line">dst net net</span><br><span class="line">如果数据包的目标地址(IPv4或IPv6格式)的网络号字段为 net, 则与此对应的条件表达式为真.</span><br><span class="line">net 可以是从网络数据库文件/etc/networks 中的名字, 也可以是一个数字形式的网络编号.</span><br><span class="line"></span><br><span class="line">一个数字IPv4 网络编号将以点分四元组(比如, 192.168.1.0), 或点分三元组(比如, 192.168.1 ), 或点分二元组(比如, 172.16), 或单一单元组(比如, 10)来表达;</span><br><span class="line"></span><br><span class="line">对应于这四种情况的网络掩码分别是:四元组:255.255.255.255(这也意味着对net 的匹配如同对主机地址(host)的匹配:地址的四个部分都用到了),三元组:255.255.255.0, 二元组: 255.255.0.0, 一元组:255.0.0.0.</span><br><span class="line"></span><br><span class="line"><span class="attribute">对于IPv6 的地址格式, 网络编号必须全部写出来(8个部分必须全部写出来); 相应网络掩码为</span><span class="punctuation">:</span></span><br><span class="line">ff:ff:ff:ff:ff:ff:ff:ff, 所以IPv6 的网络匹配是真正的&#x27;host&#x27;方式的匹配(nt | rt | rc:地址的8个部分都会用到,是否不属于网络的字节填写0, 需接下来补充), 但同时需要一个网络掩码长度参数来具体指定前面多少字节为网络掩码(nt: 可通过下面的net net/len 来指定)</span><br><span class="line"></span><br><span class="line"><span class="attribute">src net net</span></span><br><span class="line"><span class="attribute">如果数据包的源地址(IPv4或IPv6格式)的网络号字段为 net, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">net net</span></span><br><span class="line"><span class="attribute">如果数据包的源或目的地址(IPv4或IPv6格式)的网络号字段为 net, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">net net mask netmask</span></span><br><span class="line"><span class="attribute">如果数据包的源或目的地址(IPv4或IPv6格式)的网络掩码与netmask 匹配, 则与此对应的条件表达式为真.此选项之前还可以配合src和dst来匹配源网络地址或目标网络地址(nt</span><span class="punctuation">:</span> <span class="string">比如 src net net mask 255.255.255.0).该选项对于ipv6 网络地址无效.</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">net net/len</span></span><br><span class="line"><span class="attribute">如果数据包的源或目的地址(IPv4或IPv6格式)的网络编号字段的比特数与len相同, 则与此对应的条件表达式为真.此选项之前还可以配合src和dst来匹配源网络地址或目标网络地址(nt | rt | tt</span><span class="punctuation">:</span> <span class="string">src net net/24, 表示需要匹配源地址的网络编号有24位的数据包).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">dst port port</span></span><br><span class="line"><span class="attribute">如果数据包(包括ip/tcp, ip/udp, ip6/tcp or ip6/udp协议)的目的端口为port, 则与此对应的条件表达式为真.port 可以是一个数字也可以是一个名字(相应名字可以在/etc/services 中找到该名字, 也可以通过man tcp 和man udp来得到相关描述信息 ). 如果使用名字, 则该名字对应的端口号和相应使用的协议都会被检查. 如果只是使用一个数字端口号,则只有相应端口号被检查(比如, dst port 513 将会使tcpdump抓取tcp协议的login 服务和udp协议的who 服务数据包, 而port domain 将会使tcpdump 抓取tcp协议的domain 服务数据包, 以及udp 协议的domain 数据包)(nt | rt</span><span class="punctuation">:</span> <span class="string">ambiguous name is used 不可理解, 需补充).</span></span><br><span class="line"></span><br><span class="line">src port port</span><br><span class="line">如果数据包的源端口为port, 则与此对应的条件表达式为真.</span><br><span class="line"></span><br><span class="line">port port</span><br><span class="line">如果数据包的源或目的端口为port, 则与此对应的条件表达式为真.</span><br><span class="line"></span><br><span class="line">dst portrange port1-port2</span><br><span class="line">如果数据包(包括ip/tcp, ip/udp, ip6/tcp or ip6/udp协议)的目的端口属于port1到port2这个端口范围(包括port1, port2), 则与此对应的条件表达式为真. tcpdump 对port1 和port2 解析与对port 的解析一致(nt:在dst port port 选项的描述中有说明).</span><br><span class="line"></span><br><span class="line">src portrange port1-port2</span><br><span class="line">如果数据包的源端口属于port1到port2这个端口范围(包括 port1, port2), 则与此对应的条件表达式为真.</span><br><span class="line"></span><br><span class="line">portrange port1-port2</span><br><span class="line">如果数据包的源端口或目的端口属于port1到port2这个端口范围(包括 port1, port2), 则与此对应的条件表达式为真.</span><br><span class="line"></span><br><span class="line">以上关于port 的选项都可以在其前面添加关键字:tcp 或者udp, 比如:</span><br><span class="line">tcp src port port</span><br><span class="line">这将使tcpdump 只抓取源端口是port 的tcp数据包.</span><br><span class="line"></span><br><span class="line">less length</span><br><span class="line">如果数据包的长度比length 小或等于length, 则与此对应的条件表达式为真. 这与&#x27;len &lt;= length&#x27; 的含义一致.</span><br><span class="line"></span><br><span class="line">greater length</span><br><span class="line">如果数据包的长度比length 大或等于length, 则与此对应的条件表达式为真. 这与&#x27;len &gt;= length&#x27; 的含义一致.</span><br><span class="line"></span><br><span class="line">ip proto protocol</span><br><span class="line">如果数据包为ipv4数据包并且其协议类型为protocol, 则与此对应的条件表达式为真.</span><br><span class="line">Protocol 可以是一个数字也可以是名字, 比如:icmp6, igmp, igrp(nt: Interior Gateway Routing Protocol,内部网关路由协议), pim(Protocol Independent Multicast, 独立组播协议, 应用于组播路由器),ah, esp(nt: ah, 认证头, esp 安全负载封装, 这两者会用在IP包的安全传输机制中 ), vrrp(Virtual Router Redundancy Protocol, 虚拟路由器冗余协议), udp, or tcp. 由于tcp , udp 以及icmp是tcpdump 的关键字,所以在这些协议名字之前必须要用\来进行转义(如果在C-shell 中需要用\\来进行转义). 注意此表达元不会把数据包中协议头链中所有协议头内容全部打印出来(nt: 实际上只会打印指定协议的一些头部信息, 比如可以用tcpdump -i eth0 &#x27;ip proto \tcp and host 192.168.3.144&#x27;, 则只打印主机192.168.3.144 发出或接收的数据包中tcp 协议头所包含的信息)</span><br><span class="line"></span><br><span class="line"><span class="attribute">ip6 proto protocol</span></span><br><span class="line"><span class="attribute">如果数据包为ipv6数据包并且其协议类型为protocol, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">注意此表达元不会把数据包中协议头链中所有协议头内容全部打印出来</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ip6 protochain protocol</span></span><br><span class="line"><span class="attribute">如果数据包为ipv6数据包并且其协议链中包含类型为protocol协议头, 则与此对应的条件表达式为真. 比如,</span></span><br><span class="line"><span class="attribute">ip6 protochain 6</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">将匹配其协议头链中拥有TCP 协议头的IPv6数据包.此数据包的IPv6头和TCP头之间可能还会包含验证头, 路由头, 或者逐跳寻径选项头.</span></span><br><span class="line"><span class="attribute">由此所触发的相应BPF(Berkeley Packets Filter, 可理解为, 在数据链路层提供数据包过滤的一种机制)代码比较繁琐,</span></span><br><span class="line"><span class="attribute">并且BPF优化代码也未能照顾到此部分, 从而此选项所触发的包匹配可能会比较慢.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ip protochain protocol</span></span><br><span class="line"><span class="attribute">与ip6 protochain protocol 含义相同, 但这用在IPv4数据包.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ether broadcast</span></span><br><span class="line"><span class="attribute">如果数据包是以太网广播数据包, 则与此对应的条件表达式为真. ether 关键字是可选的.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ip broadcast</span></span><br><span class="line"><span class="attribute">如果数据包是IPv4广播数据包, 则与此对应的条件表达式为真. 这将使tcpdump 检查广播地址是否符合全0和全1的一些约定,并查找网络接口的网络掩码(网络接口为当时在其上抓包的网络接口).</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">如果抓包所在网络接口的网络掩码不合法, 或者此接口根本就没有设置相应网络地址和网络， 亦或是在linux下的&#x27;any&#x27;网络接口上抓包(此&#x27;any&#x27;接口可以收到系统中不止一个接口的数据包(nt</span><span class="punctuation">:</span> <span class="string">实际上, 可理解为系统中所有可用的接口)),网络掩码的检查不能正常进行.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">ether multicast</span></span><br><span class="line"><span class="attribute">如果数据包是一个以太网多点广播数据包(nt</span><span class="punctuation">:</span> <span class="string">多点广播, 可理解为把消息同时传递给一组目的地址, 而不是网络中所有地址,后者为可称为广播(broadcast)), 则与此对应的条件表达式为真. 关键字ether 可以省略. 此选项的含义与以下条件表达式含义一致:`ether[0] &amp; 1 != 0&#x27;(nt: 可理解为, 以太网数据包中第0个字节的最低位是1, 这意味这是一个多点广播数据包).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ip multicast</span></span><br><span class="line"><span class="attribute">如果数据包是ipv4多点广播数据包, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ip6 multicast</span></span><br><span class="line"><span class="attribute">如果数据包是ipv6多点广播数据包, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ether proto protocol</span></span><br><span class="line"><span class="attribute">如果数据包属于以下以太协议类型, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">协议(protocol)字段, 可以是数字或以下所列出了名字</span><span class="punctuation">:</span> <span class="string">ip, ip6, arp, rarp, atalk(AppleTalk网络协议),</span></span><br><span class="line"><span class="attribute">aarp(nt</span><span class="punctuation">:</span> <span class="string">AppleTalk Address Resolution Protocol, AppleTalk网络的地址解析协议),</span></span><br><span class="line"><span class="attribute">decnet(nt</span><span class="punctuation">:</span> <span class="string">一个由DEC公司所提供的网络协议栈), sca(nt: 未知, 需补充),</span></span><br><span class="line"><span class="attribute">lat(Local Area Transport, 区域传输协议, 由DEC公司开发的以太网主机互联协议),</span></span><br><span class="line"><span class="attribute">mopdl, moprc, iso(nt</span><span class="punctuation">:</span> <span class="string">未知, 需补充), stp(Spanning tree protocol, 生成树协议, 可用于防止网络中产生链接循环),</span></span><br><span class="line"><span class="attribute">ipx（nt</span><span class="punctuation">:</span> <span class="string">Internetwork Packet Exchange, Novell 网络中使用的网络层协议）, 或者</span></span><br><span class="line"><span class="attribute">netbeui(nt</span><span class="punctuation">:</span> <span class="string">NetBIOS Extended User Interface，可理解为, 网络基本输入输出系统接口扩展).</span></span><br><span class="line"></span><br><span class="line">protocol字段可以是一个数字或以下协议名之一:ip, ip6, arp, rarp, atalk, aarp, decnet, sca, lat,</span><br><span class="line"><span class="attribute">mopdl, moprc, iso, stp, ipx, 或者netbeui.</span></span><br><span class="line"><span class="attribute">必须要注意的是标识符也是关键字, 从而必须通过&#x27;\&#x27;来进行转义.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">(SNAP：子网接入协议 （SubNetwork Access Protocol）)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">在光纤分布式数据网络接口(其表达元形式可以是&#x27;fddi protocol arp&#x27;), 令牌环网(其表达元形式可以是&#x27;tr protocol arp&#x27;),</span></span><br><span class="line"><span class="attribute">以及IEEE 802.11 无线局域网(其表达元形式可以是&#x27;wlan protocol arp&#x27;)中, protocol</span></span><br><span class="line"><span class="attribute">标识符来自802.2 逻辑链路控制层头,</span></span><br><span class="line"><span class="attribute">在FDDI, Token Ring 或 802.1头中会包含此逻辑链路控制层头.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">当以这些网络上的相应的协议标识为过滤条件时, tcpdump只是检查LLC头部中以0x000000为组成单元标识符(OUI, 0x000000</span></span><br><span class="line"><span class="attribute">标识一个内部以太网)的一段&#x27;SNAP格式结构&#x27;中的protocol ID 域, 而不会管包中是否有一段OUI为0x000000的&#x27;SNAP格式</span></span><br><span class="line"><span class="attribute">结构&#x27;(nt</span><span class="punctuation">:</span> <span class="string">SNAP, SubNetwork Access Protocol,子网接入协议 ). 以下例外:</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">iso tcpdump 会检查LLC头部中的DSAP域(Destination service Access Point, 目标服务接入点)和</span></span><br><span class="line"><span class="attribute">SSAP域(源服务接入点).(nt</span><span class="punctuation">:</span> <span class="string">iso 协议未知, 需补充)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">stp 以及 netbeui</span></span><br><span class="line"><span class="attribute">tcpdump 将会检查LLC 头部中的目标服务接入点(Destination service Access Point);</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">atalk</span></span><br><span class="line"><span class="attribute">tcpdump 将会检查LLC 头部中以0x080007 为OUI标识的&#x27;SNAP格式结构&#x27;, 并会检查AppleTalk etype域.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">AppleTalk etype 是否位于SNAP格式结构中, 未知, 需补充).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">此外, 在以太网中, 对于ether proto protocol 选项, tcpdump 会为 protocol 所指定的协议检查</span></span><br><span class="line"><span class="attribute">以太网类型域(the Ethernet type field), 但以下这些协议除外</span><span class="punctuation">:</span></span><br><span class="line"><span class="punctuation"></span></span><br><span class="line"><span class="attribute">iso, stp, and netbeui</span></span><br><span class="line"><span class="attribute">tcpdump 将会检查802.3 物理帧以及LLC 头(这两种检查与FDDI, TR, 802.11网络中的相应检查一致);</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">802.3, 理解为IEEE 802.3, 其为一系列IEEE 标准的集合. 此集合定义了有线以太网络中的物理层以及数据</span></span><br><span class="line"><span class="attribute">链路层的媒体接入控制子层. stp 在上文已有描述)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">atalk</span></span><br><span class="line"><span class="attribute">tcpdump 将会检查以太网物理帧中的AppleTalk etype 域 ,　同时也会检查数据包中LLC头部中的&#x27;SNAP格式结构&#x27;</span></span><br><span class="line"><span class="attribute">(这两种检查与FDDI, TR, 802.11网络中的相应检查一致)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">aarp tcpdump 将会检查AppleTalk ARP etype 域, 此域或存在于以太网物理帧中, 或存在于LLC(由802.2 所定义)的</span></span><br><span class="line"><span class="attribute">&#x27;SNAP格式结构&#x27;中, 当为后者时, 该&#x27;SNAP格式结构&#x27;的OUI标识为0x000000;</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">802.2, 可理解为, IEEE802.2, 其中定义了逻辑链路控制层(LLC), 该层对应于OSI 网络模型中数据链路层的上层部分.</span></span><br><span class="line"><span class="attribute">LLC 层为使用数据链路层的用户提供了一个统一的接口(通常用户是网络层). LLC层以下是媒体接入控制层(nt</span><span class="punctuation">:</span> <span class="string">MAC层,</span></span><br><span class="line"><span class="attribute">对应于数据链路层的下层部分).该层的实现以及工作方式会根据不同物理传输媒介的不同而有所区别(比如, 以太网, 令牌环网,</span></span><br><span class="line"><span class="attribute">光纤分布数据接口(nt</span><span class="punctuation">:</span> <span class="string">实际可理解为一种光纤网络), 无线局域网(802.11), 等等.)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ipx tcpdump 将会检查物理以太帧中的IPX etype域, LLC头中的IPX DSAP域，无LLC头并对IPX进行了封装的802.3帧,</span></span><br><span class="line"><span class="attribute">以及LLC 头部&#x27;SNAP格式结构&#x27;中的IPX etype 域(nt | rt</span><span class="punctuation">:</span> <span class="string">SNAP frame, 可理解为, LLC 头中的&#x27;SNAP格式结构&#x27;.</span></span><br><span class="line">该含义属初步理解阶段, 需补充).</span><br><span class="line"></span><br><span class="line">decnet src host</span><br><span class="line">如果数据包中DECNET源地址为host, 则与此对应的条件表达式为真.</span><br><span class="line">(nt:decnet, 由Digital Equipment Corporation 开发, 最早用于PDP-11 机器互联的网络协议)</span><br><span class="line"></span><br><span class="line"><span class="attribute">decnet dst host</span></span><br><span class="line"><span class="attribute">如果数据包中DECNET目的地址为host, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">decnet 在上文已有说明)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">decnet host host</span></span><br><span class="line"><span class="attribute">如果数据包中DECNET目的地址或DECNET源地址为host, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">decnet 在上文已有说明)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ifname interface</span></span><br><span class="line"><span class="attribute">如果数据包已被标记为从指定的网络接口中接收的, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为OpenBSD中的防火墙程序))</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">on interface</span></span><br><span class="line"><span class="attribute">与 ifname interface 含义一致.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">rnr num</span></span><br><span class="line"><span class="attribute">如果数据包已被标记为匹配PF的规则, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为OpenBSD中的防火墙程序))</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">rulenum num</span></span><br><span class="line"><span class="attribute">与 rulenum num 含义一致.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">reason code</span></span><br><span class="line"><span class="attribute">如果数据包已被标记为包含PF的匹配结果代码, 则与此对应的条件表达式为真.有效的结果代码有</span><span class="punctuation">:</span> <span class="string">match, bad-offset,</span></span><br><span class="line"><span class="attribute">fragment, short, normalize, 以及memory.</span></span><br><span class="line"><span class="attribute">(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为OpenBSD中的防火墙程序))</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">rset name</span></span><br><span class="line"><span class="attribute">如果数据包已被标记为匹配指定的规则集, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为OpenBSD中的防火墙程序))</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ruleset name</span></span><br><span class="line"><span class="attribute">与 rset name 含义一致.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">srnr num</span></span><br><span class="line"><span class="attribute">如果数据包已被标记为匹配指定的规则集中的特定规则(nt</span><span class="punctuation">:</span> <span class="string">specified PF rule number, 特定规则编号, 即特定规则),</span></span><br><span class="line"><span class="attribute">则与此对应的条件表达式为真.(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为</span></span><br><span class="line"><span class="attribute">OpenBSD中的防火墙程序))</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">subrulenum num</span></span><br><span class="line"><span class="attribute">与 srnr 含义一致.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">action act</span></span><br><span class="line"><span class="attribute">如果包被记录时PF会执行act指定的动作, 则与此对应的条件表达式为真. 有效的动作有</span><span class="punctuation">:</span> <span class="string">pass, block.</span></span><br><span class="line"><span class="attribute">(此选项只适用于被OpenBSD中pf程序做过标记的包(nt</span><span class="punctuation">:</span> <span class="string">pf, packet filter, 可理解为OpenBSD中的防火墙程序))</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ip, ip6, arp, rarp, atalk, aarp, decnet, iso, stp, ipx, netbeui</span></span><br><span class="line"><span class="attribute">与以下表达元含义一致</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">ether proto p</span></span><br><span class="line"><span class="attribute">p是以上协议中的一个.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">lat, moprc, mopdl</span></span><br><span class="line"><span class="attribute">与以下表达元含义一致</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">ether proto p</span></span><br><span class="line"><span class="attribute">p是以上协议中的一个. 必须要注意的是tcpdump目前还不能分析这些协议.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">vlan [vlan_id]</span></span><br><span class="line"><span class="attribute">如果数据包为IEEE802.1Q VLAN 数据包, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">IEEE802.1Q VLAN, 即IEEE802.1Q 虚拟网络协议, 此协议用于不同网络的之间的互联).</span></span><br><span class="line"><span class="attribute">如果[vlan_id] 被指定, 则只有数据包含有指定的虚拟网络id(vlan_id), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">要注意的是, 对于VLAN数据包, 在表达式中遇到的第一个vlan关键字会改变表达式中接下来关键字所对应数据包中数据的</span></span><br><span class="line"><span class="attribute">开始位置(即解码偏移). 在VLAN网络体系中过滤数据包时, vlan [vlan_id]表达式可以被多次使用. 关键字vlan每出现一次都会增加</span></span><br><span class="line"><span class="attribute">4字节过滤偏移(nt</span><span class="punctuation">:</span> <span class="string">过滤偏移, 可理解为上面的解码偏移).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">例如</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">vlan 100 &amp;&amp; vlan 200</span></span><br><span class="line"><span class="attribute">表示</span><span class="punctuation">:</span> <span class="string">过滤封装在VLAN100中的VLAN200网络上的数据包</span></span><br><span class="line"><span class="attribute">再例如</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">vlan &amp;&amp; vlan 300 &amp;&amp; ip</span></span><br><span class="line"><span class="attribute">表示</span><span class="punctuation">:</span> <span class="string">过滤封装在VLAN300 网络中的IPv4数据包, 而VLAN300网络又被更外层的VLAN封装</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">mpls [label_num]</span></span><br><span class="line"><span class="attribute">如果数据包为MPLS数据包, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">MPLS, Multi-Protocol Label Switch, 多协议标签交换, 一种在开放的通信网上利用标签引导数据传输的技术).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">如果[label_num] 被指定, 则只有数据包含有指定的标签id(label_num), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">要注意的是, 对于内含MPLS信息的IP数据包(即MPLS数据包), 在表达式中遇到的第一个MPLS关键字会改变表达式中接下来关键字所对应数据包中数据的</span></span><br><span class="line"><span class="attribute">开始位置(即解码偏移). 在MPLS网络体系中过滤数据包时, mpls [label_num]表达式可以被多次使用. 关键字mpls每出现一次都会增加</span></span><br><span class="line"><span class="attribute">4字节过滤偏移(nt</span><span class="punctuation">:</span> <span class="string">过滤偏移, 可理解为上面的解码偏移).</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">例如</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">mpls 100000 &amp;&amp; mpls 1024</span></span><br><span class="line"><span class="attribute">表示</span><span class="punctuation">:</span> <span class="string">过滤外层标签为100000 而层标签为1024的数据包</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">再如</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">mpls &amp;&amp; mpls 1024 &amp;&amp; host 192.9.200.1</span></span><br><span class="line"><span class="attribute">表示</span><span class="punctuation">:</span> <span class="string">过滤发往或来自192.9.200.1的数据包, 该数据包的内层标签为1024, 且拥有一个外层标签.</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">pppoed</span></span><br><span class="line"><span class="attribute">如果数据包为PPP-over-Ethernet的服务器探寻数据包(nt</span><span class="punctuation">:</span> <span class="string">Discovery packet,</span></span><br><span class="line"><span class="attribute">其ethernet type 为0x8863),则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">PPP-over-Ethernet, 点对点以太网承载协议, 其点对点的连接建立分为Discovery阶段(地址发现) 和</span></span><br><span class="line"><span class="attribute">PPPoE 会话建立阶段 , discovery 数据包就是第一阶段发出来的包. ethernet type</span></span><br><span class="line"><span class="attribute">是以太帧里的一个字段，用来指明应用于帧数据字段的协议)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">pppoes</span></span><br><span class="line"><span class="attribute">如果数据包为PPP-over-Ethernet会话数据包(nt</span><span class="punctuation">:</span> <span class="string">ethernet type 为0x8864, PPP-over-Ethernet在上文已有说明, 可搜索</span></span><br><span class="line"><span class="attribute">关键字&#x27;PPP-over-Ethernet&#x27;找到其描述), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">要注意的是, 对于PPP-over-Ethernet会话数据包, 在表达式中遇到的第一个pppoes关键字会改变表达式中接下来关键字所对应数据包中数据的</span></span><br><span class="line"><span class="attribute">开始位置(即解码偏移).</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">例如</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">pppoes &amp;&amp; ip</span></span><br><span class="line"><span class="attribute">表示</span><span class="punctuation">:</span> <span class="string">过滤嵌入在PPPoE数据包中的ipv4数据包</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">tcp, udp, icmp</span></span><br><span class="line"><span class="attribute">与以下表达元含义一致</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">ip proto p or ip6 proto p</span></span><br><span class="line"><span class="attribute">其中p 是以上协议之一(含义分别为</span><span class="punctuation">:</span> <span class="string">如果数据包为ipv4或ipv6数据包并且其协议类型为 tcp,udp, 或icmp则与此对</span></span><br><span class="line"><span class="attribute">应的条件表达式为真)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">iso proto protocol</span></span><br><span class="line"><span class="attribute">如果数据包的协议类型为iso-osi协议栈中protocol协议, 则与此对应的条件表达式为真.(nt</span><span class="punctuation">:</span> <span class="string">[初解]iso-osi 网络模型中每</span></span><br><span class="line"><span class="attribute">层的具体协议与tcp/ip相应层采用的协议不同. iso-osi各层中的具体协议另需补充 )</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">protocol 可以是一个数字编号, 或以下名字中之一</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">clnp, esis, or isis.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">clnp, Connectionless Network Protocol, 这是OSI网络模型中网络层协议 , esis, isis 未知, 需补充)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">clnp, esis, isis</span></span><br><span class="line"><span class="attribute">是以下表达的缩写</span></span><br><span class="line"><span class="attribute">iso proto p</span></span><br><span class="line"><span class="attribute">其中p 是以上协议之一</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">l1, l2, iih, lsp, snp, csnp, psnp</span></span><br><span class="line"><span class="attribute">为IS-IS PDU 类型 的缩写.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">IS-IS PDU, Intermediate system to intermediate system Protocol Data Unit, 中间系统到</span></span><br><span class="line"><span class="attribute">中间系统的协议数据单元. OSI(Open Systems Interconnection)网络由终端系统, 中间系统构成.</span></span><br><span class="line"><span class="attribute">终端系统指路由器, 而终端系统指用户设备. 路由器形成的本地组称之为&#x27;区域&#x27;（Area）和多个区域组成一个&#x27;域&#x27;（Domain）.</span></span><br><span class="line"><span class="attribute">IS-IS 提供域内或区域内的路由. l1, l2, iih, lsp, snp, csnp, psnp 表示PDU的类型, 具体含义另需补充)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">vpi n</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 ,</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 并且其虚拟路径标识为n, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">ATM, Asychronous Transfer Mode, 实际上可理解为由ITU-T(国际电信联盟电信标准化部门)提出的一个与</span></span><br><span class="line"><span class="attribute">TCP/IP中IP层功能等同的一系列协议, 具体协议层次另需补充)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">vci n</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 ,</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 并且其虚拟通道标识为n, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">ATM, 在上文已有描述)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">lane</span></span><br><span class="line"><span class="attribute">如果数据包为ATM LANE 数据包, 则与此对应的条件表达式为真. 要注意的是, 如果是模拟以太网的LANE数据包或者</span></span><br><span class="line"><span class="attribute">LANE逻辑单元控制包, 表达式中第一个lane关键字会改变表达式中随后条件的测试. 如果没有</span></span><br><span class="line"><span class="attribute">指定lane关键字, 条件测试将按照数据包中内含LLC(逻辑链路层)的ATM包来进行.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">llc</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 ,</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包,　并且内含LLC则与此对应的条件表达式为真</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">oamf4s</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是Segment OAM F4 信元(VPI=0 并且 VCI=3), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">OAM, Operation Administration and Maintenance, 操作管理和维护,可理解为:ATM网络中用于网络</span></span><br><span class="line"><span class="attribute">管理所产生的ATM信元的分类方式.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ATM网络中传输单位为信元, 要传输的数据终究会被分割成固定长度(53字节)的信元,</span></span><br><span class="line"><span class="attribute">(初理解</span><span class="punctuation">:</span> <span class="string">一条物理线路可被复用, 形成虚拟路径(virtual path). 而一条虚拟路径再次被复用, 形成虚拟信道(virtual channel)).</span></span><br><span class="line">通信双方的编址方式为:虚拟路径编号(VPI)/虚拟信道编号(VCI)).</span><br><span class="line"></span><br><span class="line"><span class="attribute">OAM F4 flow 信元又可分为segment 类和end-to-end 类, 其区别未知, 需补充.)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">oamf4e</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是 end-to-end OAM F4 信元(VPI=0 并且 VCI=4), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">OAM 与 end-to-end OAM F4 在上文已有描述, 可搜索&#x27;oamf4s&#x27;来定位)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">oamf4</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是 end-to-end 或 segment OAM F4 信元(VPI=0 并且 VCI=3 或者 VCI=4), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">OAM 与 end-to-end OAM F4 在上文已有描述, 可搜索&#x27;oamf4s&#x27;来定位)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">oam</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是 end-to-end 或 segment OAM F4 信元(VPI=0 并且 VCI=3 或者 VCI=4), 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">此选项与oamf4重复, 需确认)</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">metac</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;元信令线路&#x27;(nt</span><span class="punctuation">:</span> <span class="string">VPI=0 并且 VCI=1, &#x27;元信令线路&#x27;, meta signaling circuit, 具体含义未知, 需补充),</span></span><br><span class="line"><span class="attribute">则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">bcc</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;广播信令线路&#x27;(nt</span><span class="punctuation">:</span> <span class="string">VPI=0 并且 VCI=2, &#x27;广播信令线路&#x27;, broadcast signaling circuit, 具体含义未知, 需补充),</span></span><br><span class="line"><span class="attribute">则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">sc</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;信令线路&#x27;(nt</span><span class="punctuation">:</span> <span class="string">VPI=0 并且 VCI=5, &#x27;信令线路&#x27;, signaling circuit, 具体含义未知, 需补充),</span></span><br><span class="line"><span class="attribute">则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">ilmic</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;ILMI线路&#x27;(nt</span><span class="punctuation">:</span> <span class="string">VPI=0 并且 VCI=16, &#x27;ILMI&#x27;, Interim Local Management Interface , 可理解为</span></span><br><span class="line"><span class="attribute">基于SNMP(简易网络管理协议)的用于网络管理的接口)</span></span><br><span class="line"><span class="attribute">则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">connectmsg</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;信令线路&#x27;并且是Q.2931协议中规定的以下几种消息</span><span class="punctuation">:</span> <span class="string">Setup, Calling Proceeding, Connect,</span></span><br><span class="line"><span class="attribute">Connect Ack, Release, 或者Release Done. 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">(nt</span><span class="punctuation">:</span> <span class="string">Q.2931 为ITU(国际电信联盟)制定的信令协议. 其中规定了在宽带综合业务数字网络的用户接口层建立, 维护, 取消</span></span><br><span class="line"><span class="attribute">网络连接的相关步骤.)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">metaconnect</span></span><br><span class="line"><span class="attribute">如果数据包为ATM数据包, 则与此对应的条件表达式为真. 对于Solaris 操作系统上的SunATM设备 , 如果数据包为ATM数据包</span></span><br><span class="line"><span class="attribute">并且是来自&#x27;元信令线路&#x27;并且是Q.2931协议中规定的以下几种消息</span><span class="punctuation">:</span> <span class="string">Setup, Calling Proceeding, Connect,</span></span><br><span class="line"><span class="attribute">Connect Ack, Release, 或者Release Done. 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">expr relop expr</span></span><br><span class="line"><span class="attribute">如果relop 两侧的操作数(expr)满足relop 指定的关系, 则与此对应的条件表达式为真.</span></span><br><span class="line"><span class="attribute">relop 可以是以下关系操作符之一</span><span class="punctuation">:</span> <span class="string">&gt;, &lt;, &lt;=, =, !=.</span></span><br><span class="line"><span class="attribute">expr 是一个算术表达式. 此表达式中可使用整型常量(表示方式与标准C中一致), 二进制操作符(+, -, *, /, &amp;, |,</span></span><br><span class="line"><span class="attribute">&lt;&lt;, &gt;&gt;), 长度操作符, 以及对特定数据包中数据的引用操作符. 要注意的是, 所有的比较操作都默认操作数是无符号的,</span></span><br><span class="line"><span class="attribute">例如, 0x80000000 和 0xffffffff 都是大于0的(nt</span><span class="punctuation">:</span> <span class="string">对于有符号的比较, 按照补码规则, 0xffffffff</span></span><br><span class="line"><span class="attribute">会小于0). 如果要引用数据包中的数据, 可采用以下表达方式</span><span class="punctuation">:</span></span><br><span class="line"><span class="attribute">proto [expr</span><span class="punctuation"> :</span> <span class="string">size]</span></span><br><span class="line"></span><br><span class="line">proto 的取值可以是以下取值之一:ether, fddi, tr, wlan, ppp, slip, link, ip, arp, rarp,</span><br><span class="line"><span class="attribute">tcp, udp, icmp, ip6 或者 radio. 这指明了该引用操作所对应的协议层.(ether, fddi, wlan,</span></span><br><span class="line"><span class="attribute">tr, ppp, slip and link 对应于数据链路层, radio 对应于802.11(wlan,无线局域网)某些数据包中的附带的</span></span><br><span class="line"><span class="attribute">&quot;radio&quot;头(nt</span><span class="punctuation">:</span> <span class="string">其中描述了波特率, 数据加密等信息)).</span></span><br><span class="line">要注意的是, tcp, udp 等上层协议目前只能应用于网络层采用为IPv4或IPv6协议的网络(此限制会在tcpdump未来版本中</span><br><span class="line">进行修改). 对于指定协议的所需数据, 其在包数据中的偏移字节由expr 来指定.</span><br><span class="line"></span><br><span class="line">以上表达中size 是可选的, 用来指明我们关注那部分数据段的长度(nt:通常这段数据</span><br><span class="line"><span class="attribute">是数据包的一个域)， 其长度可以是1, 2, 或4个字节. 如果不给定size, 默认是1个字节. 长度操作符的关键字为len,</span></span><br><span class="line"><span class="attribute">这代码整个数据包的长度.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">例如, &#x27;ether[0] &amp; 1 != 0&#x27; 将会使tcpdump 抓取所有多点广播数据包.(nt</span><span class="punctuation">:</span> <span class="string">ether[0]字节的最低位为1表示</span></span><br><span class="line">数据包目的地址是多点广播地址). &#x27;ip[0] &amp; 0xf != 5&#x27; 对应抓取所有带有选项的</span><br><span class="line">IPv4数据包. &#x27;ip[6:2] &amp; 0x1fff = 0&#x27;对应抓取没被破碎的IPv4数据包或者</span><br><span class="line"><span class="attribute">其片段编号为0的已破碎的IPv4数据包. 这种数据检查方式也适用于tcp和udp数据的引用,</span></span><br><span class="line"><span class="attribute">即, tcp[0]对应于TCP 头中第一个字节, 而不是对应任何一个中间的字节.</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">一些偏移以及域的取值除了可以用数字也可用名字来表达. 以下为可用的一些域(协议头中的域)的名字</span><span class="punctuation">:</span> <span class="string">icmptype (指ICMP 协议头</span></span><br><span class="line"><span class="attribute">中type域), icmpcode (指ICMP 协议头code 域), 以及tcpflags(指TCP协议头的flags 域)</span></span><br><span class="line"><span class="attribute"></span></span><br><span class="line"><span class="attribute">以下为ICMP 协议头中type 域的可用取值</span><span class="punctuation">:</span></span><br><span class="line">icmp-echoreply, icmp-unreach, icmp-sourcequench, icmp-redirect, icmp-echo, icmp-routeradvert,</span><br><span class="line">icmp-routersolicit, icmp-timx-ceed, icmp-paramprob, icmp-tstamp, icmp-tstampreply,</span><br><span class="line">icmp-ireq, icmp-ireqreply, icmp-maskreq, icmp-maskreply.</span><br><span class="line"></span><br><span class="line">以下为TCP 协议头中flags 域的可用取值:tcp-fin, tcp-syn, tcp-rst, tcp-push,</span><br><span class="line">tcp-ack, tcp-urg.</span><br></pre></td></tr></table></figure>
<h2 id="常用收集"><a href="#常用收集" class="headerlink" title="常用收集"></a>常用收集</h2><p>常用案例收集</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、想要截获所有<span class="number">210.27.48.1</span> 的主机收到的和发出的所有的数据包：</span><br><span class="line">tcpdump host <span class="number">210.27.48.1</span></span><br><span class="line"><span class="number">2</span>、想要截获主机<span class="number">210.27.48.1</span> 和主机<span class="number">210.27.48.2</span> 或<span class="number">210.27.48.3</span>的通信，使用命令：(在命令行中使用括号时，一定要添加&#x27;\&#x27;)</span><br><span class="line">tcpdump host <span class="number">210.27.48.1</span> and \ (<span class="number">210.27.48.2</span> or <span class="number">210.27.48.3</span> \)</span><br><span class="line"><span class="number">3</span>、如果想要获取主机<span class="number">210.27.48.1</span>除了和主机<span class="number">210.27.48.2</span>之外所有主机通信的ip包，使用命令：</span><br><span class="line">tcpdump ip host <span class="number">210.27.48.1</span> and ! <span class="number">210.27.48.2</span></span><br><span class="line"><span class="number">4</span>、如果想要获取主机<span class="number">210.27.48.1</span>接收或发出的telnet包，使用如下命令：</span><br><span class="line">tcpdump tcp port <span class="number">23</span> host <span class="number">210.27.48.1</span></span><br><span class="line"><span class="number">5</span>、对本机的udp <span class="number">123</span> 端口进行监视 <span class="number">123</span> 为ntp的服务端口</span><br><span class="line">tcpdump udp port <span class="number">123</span></span><br><span class="line"><span class="number">6</span>、系统将只对名为hostname的主机的通信数据包进行监视。主机名可以是本地主机，也可以是网络上的任何一台计算机。</span><br><span class="line">下面的命令可以读取主机hostname发送的所有数据：</span><br><span class="line">tcpdump -i eth0 src host hostname</span><br><span class="line"><span class="number">7</span>、下面的命令可以监视所有送到主机hostname的数据包：</span><br><span class="line">tcpdump -i eth0 dst host hostname</span><br><span class="line"><span class="number">8</span>、我们还可以监视通过指定网关的数据包：</span><br><span class="line">tcpdump -i eth0 gateway Gatewayname</span><br><span class="line"><span class="number">9</span>、如果你还想监视编址到指定端口的TCP或UDP数据包，那么执行以下命令：</span><br><span class="line">tcpdump -i eth0 host hostname and port <span class="number">80</span></span><br><span class="line"><span class="number">10</span>、如果想要获取主机<span class="number">210.27.48.1</span>除了和主机<span class="number">210.27.48.2</span>之外所有主机通信的ip包，使用命令：</span><br><span class="line">tcpdump ip host <span class="number">210.27.48.1</span> and ! <span class="number">210.27.48.2</span></span><br><span class="line"><span class="number">11</span>、想要截获主机<span class="number">210.27.48.1</span> 和主机<span class="number">210.27.48.2</span> 或<span class="number">210.27.48.3</span>的通信，使用命令：</span><br><span class="line">tcpdump host <span class="number">210.27.48.1</span> and \ (<span class="number">210.27.48.2</span> or <span class="number">210.27.48.3</span> \)</span><br><span class="line"><span class="number">12</span>、如果想要获取主机<span class="number">210.27.48.1</span>除了和主机<span class="number">210.27.48.2</span>之外所有主机通信的ip包，使用命令：</span><br><span class="line">tcpdump ip host <span class="number">210.27.48.1</span> and ! <span class="number">210.27.48.2</span></span><br><span class="line"><span class="number">13</span>、如果想要获取主机<span class="number">210.27.48.1</span>接收或发出的telnet包，使用如下命令：</span><br><span class="line">tcpdump tcp port <span class="number">23</span> host <span class="number">210.27.48.1</span></span><br></pre></td></tr></table></figure>



      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/backend/2016/09/26/tcpdump.html">tcpdump使用文档</a></p>
        <p><span>文章作者:</span><a href="/" title="访问  的个人博客"></a></p>
        <p><span>发布时间:</span>2016年09月26日 - 10时49分</p>
        <p><span>最后更新:</span>2023年06月25日 - 14时08分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/backend/2016/09/26/tcpdump.html" title="tcpdump使用文档">http://lehoon.cn/backend/2016/09/26/tcpdump.html</a>
            <span class="copy-path" data-clipboard-text="原文: http://lehoon.cn/backend/2016/09/26/tcpdump.html　　作者: " title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/backend/2016/09/27/linux-c-func.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          Linux下C函数定义
        
      </div>
    </a>
  
  
    <a href="/%E7%BC%96%E7%A8%8B/2016/09/20/eim.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">eim</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">1.</span> <span class="toc-text">使用说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">命令格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.</span> <span class="toc-text">命令介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">条件表达式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-number">2.</span> <span class="toc-text">附录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%94%B6%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">常用收集</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">


<script src="/js/require-2.1.6.min.js"></script>


<script src="/js/jquery-1.9.1.min.js"></script>

<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>







    



    <div class="scroll" id="post-nav-button">
        
            <a href="/backend/2016/09/27/linux-c-func.html" title="上一篇: Linux下C函数定义">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/%E7%BC%96%E7%A8%8B/2016/09/20/eim.html" title="下一篇: eim">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/backend/2023/06/25/window-crashpad-build-note.html">window编译crashpad库</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2022/11/24/chrome-source-build-note.html">chrome源码编译笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2022/11/15/haikang-vedio-screenshot.html">海康摄像头截图实现</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2022/10/19/java-threadpool-task-cancel.html">java线程池任务取消注意点</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2022/10/17/c-embedded-v8-args.html">c++嵌入v8参数传递及返回值获取</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2022/09/26/v8-complie-win10.html">win10编译v8引擎</a></li><li class="post-list-item"><a class="post-list-link" href="/%E5%BC%80%E6%BA%90/2022/01/07/opensource-list.html">常用的开源解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2021/12/21/cplusplus-random.html">c++生成一定范围内随机数的通用算法公式</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2021/12/06/netty-client-demo.html">netty客户端与多个远程服务器连接</a></li><li class="post-list-item"><a class="post-list-link" href="/project/2021/03/24/finesys-devops.html">部署运维系统1.0</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2020/04/30/java-signal-ignore-note.html">java屏蔽控制台INT信号</a></li><li class="post-list-item"><a class="post-list-link" href="/project/2020/04/29/weixin-minishop-note.html">微信商城小程序</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2019/11/20/flink-study-note.html">flink安装部署</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2019/11/18/chrome-cpu-note.html">chrome占用cpu解决方法</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2019/06/21/python-note.html">python记录</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2019/06/17/maven-error-note.html">maven私服neuxs错误集合</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2019/04/12/linux-compile-php7.html">在centos7 linux上编译php-7.1.28</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2019/03/20/fix-protocol-note.html">金融信息交换fix协议文档</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2018/12/27/linux-using-note.html">linux使用记录笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/12/06/openjdk-makefile-note.html">openjdk1.8中的Makefile</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2018/11/27/openjdk-startup-note.html">OpenJdk1.8笔记--java启动流程</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2018/11/26/openjdk-study-note.html">OpenJdk1.8笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2018/11/19/win10-system-note.html">win10系统使用及问题解决记录</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/11/09/openjdk-compile-linux.html">Linux编译OpenJdk1.8</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/10/16/apama-deploy-note.html">apama发布笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/10/12/suse-leap15-install-note.html">SuSE 15.0安装备忘</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/10/09/ehcache-note.html">EhCache缓存使用</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2018/09/27/art-template-note.html">art-template使用笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/09/25/apama-note.html">apama笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2018/03/27/svn-showlog-date-1970.html">svn查看日志显示时间为1970解决方法</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/03/23/oracle12c-create-instance.html">oracle12c手动创建cdb实例</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2018/03/14/librdkafka-config.html">librdkafka配置参数详解</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/12/25/apk-decompile-tools.html">apk反编译工具</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/12/08/map-accuracy2scale.html">地图精度与电子地图比例尺的关系</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/12/08/window-big-file-tools.html">window系统大文件打开工具</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/10/27/gnss-gprmc-format.html">GPRMC格式详解</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2017/09/21/autobuild-static-version.html">通过gulp自动构建项目静态资源的版本号</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/08/28/load-session-persistent-exception.html">Exception loading sessions from persistent storage</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/06/20/mysql-reset-password.html">Mysql重设密码和远程访问</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/06/19/idea-file-format.html">Intellij-idea文件格式化</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/06/13/jstorm-hbase-issue.html">jstorm集成hbase、rocketmq</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/06/09/jps-process-information-unavailable.html">jps出现process information unavailable解决办法</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/05/31/linux-find-command-examples.html">Linux中find的用法</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/05/27/vs-compilemode-difference.html">VS运行库区别</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/05/19/cache-invalid-problem.html">缓存击穿、失效及热点key问题</a></li><li class="post-list-item"><a class="post-list-link" href="/%E8%BF%90%E7%BB%B4/2017/05/12/linux-operation-maintenance.html">linux运维</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/05/03/eight-diagram-tactics.html">八卦阵解释</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/05/03/gnss-terminology.html">gnss术语</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/04/28/ae-network-library.html">ae网络库</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/04/25/gnss-gpgga-formet.html">GPGGA格式详解</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/04/10/maven-download-timeout.html">maven下载文件超时</a></li><li class="post-list-item"><a class="post-list-link" href="/middleware/2017/03/31/storm-core-terminology.html">storm核心术语介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/03/30/hbase-insert-select.html">hbase通过api写入和查询</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/03/28/oracle-note-sql.html">oracle常用sql</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2017/03/27/extjs-treepanel-singleselect.html">extjs-treepanel实现单选功能</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/03/15/java-double-compare.html">java语言中double比较大小方法</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2017/03/10/extjs-form-submit.html">extjs中form表单提交注意点</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/02/25/rocketmq-client-sdk.html">rocketmq客户端sdk</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/02/22/source-insight4-crack.html">source insight4安装使用</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/02/21/rocketmq-topic-delete.html">rocketmq删除topic</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2017/02/21/rocketmq-message-store.html">rocketmq消息存储</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/02/20/idempotent-define.html">幂等介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/02/20/github-sync-fork-upstream.html">github上fork项目源同步</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/02/16/intellij-idea-2016.html">intellij-idea-2016下载安装</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/01/24/bubiao-protocol.html">部标808协议文件</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/01/24/life-secret.html">生活小秘方</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2017/01/10/mysql-odbc-driver-error.html">无法加载mysql odbc 5.3 unicode driver</a></li><li class="post-list-item"><a class="post-list-link" href="/rocketmq/2016/11/25/rocketmq-net-port.html">rocketmq服务中的端口号</a></li><li class="post-list-item"><a class="post-list-link" href="/rocketmq/2016/11/13/rocketmq-broker-synctopic2namesrv.html">rocketmq中broker启动同步topic到namesrv过程</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/11/10/java-error-note.html">java常见错误</a></li><li class="post-list-item"><a class="post-list-link" href="/rocketmq/2016/11/09/rocketmq-install-note.html">rocketmq安装记录</a></li><li class="post-list-item"><a class="post-list-link" href="/rocketmq/2016/11/09/rocketmq-docs.html">Rocketmq文档</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/10/28/game-develop-skill.html">游戏开发要点</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/10/14/oracle-error-note.html">oracle错误记录</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/10/11/oracle-materialized-view.html">oracle物化视图</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/10/09/centos-oracle11gr2-install.html">Centos7安装oracle11gr2</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/10/08/gdb-miss-debuginfo.html">gdb-miss-debuginfo</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/29/linux-io-schedule.html">Linux IO调度算法</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/27/linux-c-func.html">Linux下C函数定义</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/26/tcpdump.html">tcpdump使用文档</a></li><li class="post-list-item"><a class="post-list-link" href="/%E7%BC%96%E7%A8%8B/2016/09/20/eim.html">eim</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/16/linux-strace.html">linux-strace使用介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/16/linux-brk-sbrk.html">brk,sbrk--改变数据段长度</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/07/centos-note.html">Centos记录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/09/05/raid.html">raid磁盘阵列介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/02/nginx-load-balance.html">nginx负载均衡各种场景下的应用</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/09/01/usb-centos-error.html">U盘安装centos7，启动报错</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2016/09/01/js-generate-uuid.html">JavaScript生成全局唯一id的方法</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/29/notepad.html">随笔</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/08/22/kafka-window.html">kafka在window下部署</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/08/19/makefile.html">Makefile学习</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2016/08/16/http-etag-last-midified.html">HTTP缓存ETAG和Last-Modified</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/16/ip-catagory.html">ip地址分类</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/09/android-connection-session.html">android非浏览器应用程序与服务器会话保持实现</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/28/memcache-memcached-diff.html">memcache与memcached区别</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/19/centos-lvs.html">CentOS 7.0下安装部署LVS</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/07/19/awk.html">awk学习</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/11/epoll.html">Linux epoll学习</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/golang-deamon.html">go守护进程实现方式</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/tcp-load-balancing.html">tcp连接负载均衡</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/tcp-rst.html">tcp出现rst情况</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/05/26/linux-tcp-optimization.html">Linux下tcp的优化</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/05/08/oracle-merge-into.html">oracle中merge into语法注意点</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/02/05/window-batch.html">Window批处理记录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/10/11/kesankaoshi.html">机动车驾驶科目三操作要领</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2015/09/28/window-service-program.html">window服务编程</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/09/21/assembly-instruction.html">汇编指令集</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/09/15/bool-BOOL.html">bool和BOOL的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/08/20/ssh-limit.html">ssh限制ip远程登录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/08/18/ue-regex.html">ultraedit正则表达式使用</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2015/05/07/occi.html">c++使用occi连接oracle</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2015/03/06/gulp.html">gulp 提高页面加载速度</a></li></ul>
		
<script src="/js/require-2.1.6.min.js"></script>

		
<script src="/js/jquery-1.9.1.min.js"></script>

    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <a href="https://beian.miit.gov.cn/" target="_blank">鲁ICP备18042181号-1</a>
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
    </div>
</footer>

    </div>
    
<script src="/js/require-2.1.6.min.js"></script>


<script src="/js/jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 3;
            var backgroundimg = "url(/background/bg-" + backgroundnum +".jpg)";
            //$("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            //$(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>




	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?2dfe9be234e290e1635b659a55da3ab4";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>


  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>