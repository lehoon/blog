<!DOCTYPE html><html><head><meta charset="utf-8"><title>kafka在window下部署 | Lehoon</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="kafka在window下部署记录。"><meta property="og:type" content="article"><meta property="og:title" content="kafka在window下部署"><meta property="og:url" content="http://blog.lehoon.cn/backend/2016/08/22/kafka-window.html"><meta property="og:site_name" content="Lehoon"><meta property="og:description" content="kafka在window下部署记录。"><meta property="og:updated_time" content="2016-08-23T00:48:48.600Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="kafka在window下部署"><meta name="twitter:description" content="kafka在window下部署记录。"><link rel="alternative" href="/rss.xml" title="Lehoon" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><link rel="apple-touch-icon" href="/img/apple-touch-icon.png"><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/js/pace.js"></script><link href="/css/pace/pace-theme-flash.css" rel="stylesheet"><script>var yiliaConfig={rootUrl:"/",fancybox:!0,animate:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,open_in_new:!1}</script></head><body><div id="container"><div class="left-col"><div class="overlay"></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img lazy-src="http://7lrwpn.com1.z0.glb.clouddn.com/wandou.jpg" class="js-avatar"></a><hgroup><h1 class="header-author"><a href="/" title="Hi Lehoon">lehoon</a></h1></hgroup><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives">文章</a></li><li><a href="/projects">项目</a></li><li><a href="/categories/backend">后端</a></li><li><a href="/categories/frontend">前端</a></li><li><a href="/categories/orther">其他</a></li><li><a href="/about">关于</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fl mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a> <a class="fl github" target="_blank" href="https://github.com/lehoon" title="github">github</a> <a class="fl weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a> <a class="fl rss" target="_blank" href="/rss.xml" title="rss">rss</a></ul></nav></section><section class="switch-part switch-part3"><div id="js-aboutme">热爱生活，享受生活。</div></section></div></div></header></div></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="Me">lehoon</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img lazy-src="/http://7lrwpn.com1.z0.glb.clouddn.com/wandou.jpg" class="js-avatar"></a><hgroup><h1 class="header-author"><a href="/" title="Me">lehoon</a></h1></hgroup><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives">文章</a></li><li><a href="/projects">项目</a></li><li><a href="/categories/backend">后端</a></li><li><a href="/categories/frontend">前端</a></li><li><a href="/categories/orther">其他</a></li><li><a href="/about">关于</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><div class="social"><a class="mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a> <a class="github" target="_blank" href="https://github.com/lehoon" title="github">github</a> <a class="weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a> <a class="rss" target="_blank" href="/rss.xml" title="rss">rss</a></div></nav></header></div></nav><div class="body-wrap"><article id="post-kafka-window" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/backend/2016/08/22/kafka-window.html" class="article-date"><time datetime="2016-08-22T03:29:06.000Z" itemprop="datePublished">2016-08-22</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name">kafka在window下部署</h1></header><div class="article-info article-info-post"><div class="article-category tagcloud"><a class="article-category-link" href="/categories/backend/">后端</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mq/">mq</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/">rpc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/">scala</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/window/">window</a></li></ul></div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><p>kafka在window下部署记录。<br><a id="more"></a><br>一、环境<br>window 7 64位<br>jdk 1.7<br>kafka:2.10-0.10.0.1 (<a href="http://mirrors.cnnic.cn/apache/kafka/0.10.0.1/kafka_2.10-0.10.0.1.tgz" target="_blank" rel="external">http://mirrors.cnnic.cn/apache/kafka/0.10.0.1/kafka_2.10-0.10.0.1.tgz</a>)<br>下载后，解压到指定的目录下，例如：D:\home\kafka_2.10-0.10.0.1</p><p>二、修改配置文件<br>1、修改kafka_2.10-0.10.0.1\config\log4j.properties中的kafka.logs.dir 为/tmp。<br>2、复制kafka_2.10-0.10.0.1\config\server.properties 为server-9093.properties,然后修改新文件的内容，主要关注2点broker.id、listeners、log.dirs修改内容如下：<br></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">broker.id=<span class="number">1</span></div><div class="line">listeners=<span class="string">PLAINTEXT:</span><span class="comment">//:9093</span></div><div class="line">log.dirs=<span class="regexp">/tmp/</span>kafka-logs<span class="number">-9093</span></div></pre></td></tr></table></figure><p></p><p>3、复制kafka_2.10-0.10.0.1\config\server.properties 为server-9094.properties，然后修改新文件的内容，主要关注2点broker.id、listeners、log.dirs修改内容如下：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">broker.id=<span class="number">2</span></div><div class="line">listeners=<span class="string">PLAINTEXT:</span><span class="comment">//:9094</span></div><div class="line">log.dirs=<span class="regexp">/tmp/</span>kafka-logs<span class="number">-9094</span></div></pre></td></tr></table></figure><p>三、修改启动脚本文件<br>把kafka_2.10-0.10.0.1\bin目录下的.sh文件，删除掉。把kafka_2.10-0.10.0.1\bin\window文件夹下的拷贝到kafka_2.10-0.10.0.1\bin目录下，然后做相应的修改如下：<br>1、修改zookeeper-server-start.bat文件中的%~dp0../../为%~dp0/../。<br></p><figure class="highlight dos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line"><span class="comment">rem Licensed to the Apache Software Foundation (ASF) under one or more</span></div><div class="line"><span class="comment">rem contributor license agreements.  See the NOTICE file distributed with</span></div><div class="line"><span class="comment">rem this work for additional information regarding copyright ownership.</span></div><div class="line"><span class="comment">rem The ASF licenses this file to You under the Apache License, Version 2.0</span></div><div class="line"><span class="comment">rem (the "License"); you may not use this file except in compliance with</span></div><div class="line"><span class="comment">rem the License.  You may obtain a copy of the License at</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><span class="comment">rem distributed under the License is distributed on an "AS IS" BASIS,</span></div><div class="line"><span class="comment">rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><span class="comment">rem See the License for the specific language governing permissions and</span></div><div class="line"><span class="comment">rem limitations under the License.</span></div><div class="line"></div><div class="line">wmic process where (commandline like "<span class="variable">%%z</span>ookeeper<span class="variable">%%"</span> and <span class="keyword">not</span> name="wmic.exe") delete</div></pre></td></tr></table></figure><p></p><p>2、修改kafka-server-start.bat文件中的%~dp0../../为%~dp0/../。<br></p><figure class="highlight dos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line"><span class="comment">rem Licensed to the Apache Software Foundation (ASF) under one or more</span></div><div class="line"><span class="comment">rem contributor license agreements.  See the NOTICE file distributed with</span></div><div class="line"><span class="comment">rem this work for additional information regarding copyright ownership.</span></div><div class="line"><span class="comment">rem The ASF licenses this file to You under the Apache License, Version 2.0</span></div><div class="line"><span class="comment">rem (the "License"); you may not use this file except in compliance with</span></div><div class="line"><span class="comment">rem the License.  You may obtain a copy of the License at</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><span class="comment">rem distributed under the License is distributed on an "AS IS" BASIS,</span></div><div class="line"><span class="comment">rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><span class="comment">rem See the License for the specific language governing permissions and</span></div><div class="line"><span class="comment">rem limitations under the License.</span></div><div class="line"></div><div class="line"><span class="keyword">IF</span> [%<span class="number">1</span>] <span class="keyword">EQU</span> [] (</div><div class="line">    <span class="built_in">echo</span> USAGE: %<span class="number">0</span> server.properties</div><div class="line">    <span class="keyword">EXIT</span> /B <span class="number">1</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="built_in">SetLocal</span></div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_LOG4J_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_LOG4J_OPTS=-Dlog4j.configuration=file:%~dp0../config/log4j.properties</div><div class="line">)</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_HEAP_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_HEAP_OPTS=-Xmx1G -Xms1G</div><div class="line">)</div><div class="line">%~dp0kafka-run-class.bat kafka.Kafka %*</div><div class="line"><span class="built_in">EndLocal</span></div></pre></td></tr></table></figure><p></p><p>3、修改kafka-run-class.bat文件中的pushd %~dp0..\ 为 pushd %~dp0..\<br>修改通过for循环添加jar到classpath的代码部分为<br></p><figure class="highlight dos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">rem Classpath addition for kafka-core dependencies</span></div><div class="line"><span class="keyword">for</span> <span class="variable">%%i</span> <span class="keyword">in</span> (<span class="variable">%BASE_DIR%</span>\libs\*.jar) <span class="keyword">do</span> (</div><div class="line">    <span class="keyword">call</span> :concat <span class="variable">%%i</span></div><div class="line">)</div></pre></td></tr></table></figure><p></p><p>文件修改后为：<br></p><figure class="highlight dos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line"><span class="comment">rem Licensed to the Apache Software Foundation (ASF) under one or more</span></div><div class="line"><span class="comment">rem contributor license agreements.  See the NOTICE file distributed with</span></div><div class="line"><span class="comment">rem this work for additional information regarding copyright ownership.</span></div><div class="line"><span class="comment">rem The ASF licenses this file to You under the Apache License, Version 2.0</span></div><div class="line"><span class="comment">rem (the "License"); you may not use this file except in compliance with</span></div><div class="line"><span class="comment">rem the License.  You may obtain a copy of the License at</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><span class="comment">rem</span></div><div class="line"><span class="comment">rem Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><span class="comment">rem distributed under the License is distributed on an "AS IS" BASIS,</span></div><div class="line"><span class="comment">rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><span class="comment">rem See the License for the specific language governing permissions and</span></div><div class="line"><span class="comment">rem limitations under the License.</span></div><div class="line"></div><div class="line"><span class="built_in">setlocal</span> enabledelayedexpansion</div><div class="line"></div><div class="line"><span class="keyword">IF</span> [%<span class="number">1</span>] <span class="keyword">EQU</span> [] (</div><div class="line">    <span class="built_in">echo</span> USAGE: %<span class="number">0</span> classname [opts]</div><div class="line">    <span class="keyword">EXIT</span> /B <span class="number">1</span></div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Using pushd popd to set BASE_DIR to the absolute path</div><div class="line"><span class="built_in">pushd</span> %~dp0..\</div><div class="line"><span class="built_in">set</span> BASE_DIR=<span class="variable">%CD%</span></div><div class="line"><span class="built_in">popd</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="variable">%BASE_DIR%</span> </div><div class="line"></div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%SCALA_VERSION%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">  <span class="built_in">set</span> SCALA_VERSION=<span class="number">2</span>.<span class="number">10</span>.<span class="number">6</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%SCALA_BINARY_VERSION%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">  <span class="built_in">set</span> SCALA_BINARY_VERSION=<span class="number">2</span>.<span class="number">10</span></div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Classpath addition for kafka-core dependencies</div><div class="line"><span class="keyword">for</span> <span class="variable">%%i</span> <span class="keyword">in</span> (<span class="variable">%BASE_DIR%</span>\libs\*.jar) <span class="keyword">do</span> (</div><div class="line">    <span class="keyword">call</span> :concat <span class="variable">%%i</span></div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem JMX settings</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_JMX_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_JMX_OPTS=-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false  -Dcom.sun.management.jmxremote.ssl=false</div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem JMX port to use</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%JMX_PORT%</span>"] <span class="keyword">NEQ</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_JMX_OPTS=<span class="variable">%KAFKA_JMX_OPTS%</span> -Dcom.sun.management.jmxremote.port=<span class="variable">%JMX_PORT%</span></div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Log directory to use</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%LOG_DIR%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> LOG_DIR=<span class="variable">%BASE_DIR%</span>/logs</div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Log4j settings</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_LOG4J_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_LOG4J_OPTS=-Dlog4j.configuration=file:<span class="variable">%BASE_DIR%</span>/config/tools-log4j.properties</div><div class="line">) <span class="keyword">ELSE</span> (</div><div class="line">  # create logs directory</div><div class="line">  <span class="keyword">IF</span> <span class="keyword">not</span> <span class="keyword">exist</span> <span class="variable">%LOG_DIR%</span> (</div><div class="line">      <span class="built_in">mkdir</span> <span class="variable">%LOG_DIR%</span></div><div class="line">  )</div><div class="line">)</div><div class="line"></div><div class="line"><span class="built_in">set</span> KAFKA_LOG4J_OPTS=-Dkafka.logs.<span class="built_in">dir</span>=<span class="variable">%LOG_DIR%</span> <span class="variable">%KAFKA_LOG4J_OPTS%</span></div><div class="line"><span class="comment"></span></div><div class="line">rem Generic jvm settings you want to add</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_OPTS=</div><div class="line">)</div><div class="line"></div><div class="line"><span class="built_in">set</span> DEFAULT_JAVA_DEBUG_PORT=<span class="number">5005</span></div><div class="line"><span class="built_in">set</span> DEFAULT_DEBUG_SUSPEND_FLAG=n</div><div class="line"><span class="comment">rem Set Debug options if enabled</span></div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_DEBUG%</span>"] <span class="keyword">NEQ</span> [""] (</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">IF</span> ["<span class="variable">%JAVA_DEBUG_PORT%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">        <span class="built_in">set</span> JAVA_DEBUG_PORT=<span class="variable">%DEFAULT_JAVA_DEBUG_PORT%</span></div><div class="line">    )</div><div class="line"></div><div class="line">    <span class="keyword">IF</span> ["<span class="variable">%DEBUG_SUSPEND_FLAG%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">        <span class="built_in">set</span> DEBUG_SUSPEND_FLAG=<span class="variable">%DEFAULT_DEBUG_SUSPEND_FLAG%</span></div><div class="line">    )</div><div class="line">    <span class="built_in">set</span> DEFAULT_JAVA_DEBUG_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=<span class="variable">!DEBUG_SUSPEND_FLAG!</span>,address=<span class="variable">!JAVA_DEBUG_PORT!</span></div><div class="line"></div><div class="line">    <span class="keyword">IF</span> ["<span class="variable">%JAVA_DEBUG_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">        <span class="built_in">set</span> JAVA_DEBUG_OPTS=<span class="variable">!DEFAULT_JAVA_DEBUG_OPTS!</span></div><div class="line">    )</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> Enabling Java debug options: <span class="variable">!JAVA_DEBUG_OPTS!</span></div><div class="line">    <span class="built_in">set</span> KAFKA_OPTS=<span class="variable">!JAVA_DEBUG_OPTS!</span> <span class="variable">!KAFKA_OPTS!</span></div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Which java to use</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%JAVA_HOME%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> JAVA=java</div><div class="line">) <span class="keyword">ELSE</span> (</div><div class="line">    <span class="built_in">set</span> JAVA="<span class="variable">%JAVA_HOME%</span>/bin/java"</div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem Memory options</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_HEAP_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_HEAP_OPTS=-Xmx256M</div><div class="line">)</div><div class="line"><span class="comment"></span></div><div class="line">rem JVM performance options</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%KAFKA_JVM_PERFORMANCE_OPTS%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">set</span> KAFKA_JVM_PERFORMANCE_OPTS=-server -XX:+UseG1GC -XX:MaxGCPauseMillis=<span class="number">20</span> -XX:InitiatingHeapOccupancyPercent=<span class="number">35</span> -XX:+DisableExplicitGC -Djava.awt.headless=true</div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%CLASSPATH%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">    <span class="built_in">echo</span> Classpath is empty. Please build the project first e.g. by running 'gradlew jarAll'</div><div class="line">    <span class="keyword">EXIT</span> /B <span class="number">2</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="built_in">set</span> COMMAND=<span class="variable">%JAVA%</span> <span class="variable">%KAFKA_HEAP_OPTS%</span> <span class="variable">%KAFKA_JVM_PERFORMANCE_OPTS%</span> <span class="variable">%KAFKA_JMX_OPTS%</span> <span class="variable">%KAFKA_LOG4J_OPTS%</span> -cp <span class="variable">%CLASSPATH%</span> <span class="variable">%KAFKA_OPTS%</span> %*</div><div class="line"><span class="comment">rem echo.</span></div><div class="line"><span class="comment">rem echo %COMMAND%</span></div><div class="line"><span class="comment">rem echo.</span></div><div class="line"></div><div class="line"><span class="variable">%COMMAND%</span></div><div class="line"></div><div class="line"><span class="keyword">goto</span> :eof</div><div class="line">:concat</div><div class="line"><span class="keyword">IF</span> ["<span class="variable">%CLASSPATH%</span>"] <span class="keyword">EQU</span> [""] (</div><div class="line">  <span class="built_in">set</span> CLASSPATH="%<span class="number">1</span>"</div><div class="line">) <span class="keyword">ELSE</span> (</div><div class="line">  <span class="built_in">set</span> CLASSPATH=<span class="variable">%CLASSPATH%</span>;"%<span class="number">1</span>"</div><div class="line">)</div></pre></td></tr></table></figure><p></p><p>四、启动zookeeper<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">zookeeper-server-start</span><span class="selector-class">.bat</span> ..\<span class="selector-tag">config</span>\<span class="selector-tag">zookeeper</span><span class="selector-class">.properties</span></div></pre></td></tr></table></figure><p></p><p>提出创建成功，如果出现错误，请根据错误提示修改直到可以运行即可。</p><p>五、启动kafka<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kafka-<span class="keyword">server</span>-start.bat ..\config\<span class="keyword">server</span><span class="number">-9093.</span>properties</div></pre></td></tr></table></figure><p></p><p>在新开一个window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kafka-<span class="keyword">server</span>-start.bat ..\config\<span class="keyword">server</span><span class="number">-9094.</span>properties</div></pre></td></tr></table></figure><p></p><p>这就启动了2个kafka的broker节点。<br>如果出现错误，请根据错误做相应的修改。</p><p>六、创建topic<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">kafka-topics</span><span class="selector-class">.bat</span> <span class="selector-tag">--create</span> <span class="selector-tag">--zookeeper</span> <span class="selector-tag">localhost</span><span class="selector-pseudo">:2181</span> <span class="selector-tag">--replication-factor</span> 2 <span class="selector-tag">--partitions</span> 3 <span class="selector-tag">--topic</span> <span class="selector-tag">my-test-topic</span></div><div class="line"><span class="selector-tag">D</span>:\<span class="selector-tag">home</span>\<span class="selector-tag">kafka_2</span><span class="selector-class">.10-0</span><span class="selector-class">.10</span><span class="selector-class">.0</span><span class="selector-class">.1</span></div><div class="line"><span class="selector-tag">Created</span> <span class="selector-tag">topic</span> "<span class="selector-tag">my-test-topic</span>".</div></pre></td></tr></table></figure><p></p><p>提出创建成功.</p><p>七、查看topic信息<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">D</span>:\home\kafka_2.<span class="number">10</span>-<span class="number">0.10</span>.<span class="number">0.1</span>\bin&gt;kafka-topics.bat --describe --zookeeper <span class="attribute">localhost</span>:<span class="number">2181</span> --topic my-test-topic</div><div class="line"><span class="attribute">D</span>:\home\kafka_2.<span class="number">10</span>-<span class="number">0.10</span>.<span class="number">0.1</span></div><div class="line"><span class="attribute">Topic</span>:my-test-topic       <span class="attribute">PartitionCount</span>:<span class="number">3</span>        <span class="attribute">ReplicationFactor</span>:<span class="number">2</span></div><div class="line"><span class="attribute">Configs</span>:</div><div class="line">        <span class="attribute">Topic</span>: my-test-topic      <span class="attribute">Partition</span>: <span class="number">0</span>    <span class="attribute">Leader</span>: <span class="number">2</span>       <span class="attribute">Replicas</span>: <span class="number">2</span>,<span class="number">0</span>   <span class="attribute">Isr</span>: <span class="number">2</span></div><div class="line">        <span class="attribute">Topic</span>: my-test-topic      <span class="attribute">Partition</span>: <span class="number">1</span>    <span class="attribute">Leader</span>: <span class="number">2</span>       <span class="attribute">Replicas</span>: <span class="number">0</span>,<span class="number">2</span>   <span class="attribute">Isr</span>: <span class="number">2</span></div><div class="line">        <span class="attribute">Topic</span>: my-test-topic      <span class="attribute">Partition</span>: <span class="number">2</span>    <span class="attribute">Leader</span>: <span class="number">2</span>       <span class="attribute">Replicas</span>: <span class="number">2</span>,<span class="number">0</span>   <span class="attribute">Isr</span>: <span class="number">2</span></div></pre></td></tr></table></figure><p></p><p>八、通过脚本测试生产topic消息<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">D</span>:\<span class="selector-tag">home</span>\<span class="selector-tag">kafka_2</span><span class="selector-class">.10-0</span><span class="selector-class">.10</span><span class="selector-class">.0</span><span class="selector-class">.1</span>\<span class="selector-tag">bin</span>&gt;<span class="selector-tag">kafka-console-producer</span><span class="selector-class">.bat</span> <span class="selector-tag">--broker-list</span> <span class="selector-tag">localhost</span><span class="selector-pseudo">:9093</span> <span class="selector-tag">--topic</span> <span class="selector-tag">my-test-topic</span></div><div class="line"><span class="selector-tag">D</span>:\<span class="selector-tag">home</span>\<span class="selector-tag">kafka_2</span><span class="selector-class">.10-0</span><span class="selector-class">.10</span><span class="selector-class">.0</span><span class="selector-class">.1</span></div><div class="line">在这里输入要发送的消息，然后回车</div></pre></td></tr></table></figure><p></p><p>九、消费topic消息<br>打开window命令提示窗口，转到D:\home\kafka_2.10-0.10.0.1\bin目录下，执行一下命令：<br></p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">D</span>:\<span class="selector-tag">home</span>\<span class="selector-tag">kafka_2</span><span class="selector-class">.10-0</span><span class="selector-class">.10</span><span class="selector-class">.0</span><span class="selector-class">.1</span>\<span class="selector-tag">bin</span>&gt;<span class="selector-tag">kafka-console-consumer</span><span class="selector-class">.bat</span> <span class="selector-tag">--zookeeper</span> <span class="selector-tag">localhost</span><span class="selector-pseudo">:2181</span> <span class="selector-tag">--from-beginning</span> <span class="selector-tag">--topic</span> <span class="selector-tag">my-test-topic</span></div><div class="line"><span class="selector-tag">D</span>:\<span class="selector-tag">home</span>\<span class="selector-tag">kafka_2</span><span class="selector-class">.10-0</span><span class="selector-class">.10</span><span class="selector-class">.0</span><span class="selector-class">.1</span></div><div class="line">在这里可以看到生产者发出的消息内容。</div></pre></td></tr></table></figure><p></p><p><a href="http://o9tuhn58u.bkt.clouddn.com/kafka_2.10-0.10.0.1.zip" target="_blank" rel="external">修改后的文件下载地址</a></p></div></div><div class="copyright"><p><span>本文标题:</span><a href="/backend/2016/08/22/kafka-window.html">kafka在window下部署</a></p><p><span>文章作者:</span><a href="/" title="访问 lehoon 的个人博客">lehoon</a></p><p><span>发布时间:</span>2016年08月22日 - 11时29分</p><p><span>最后更新:</span>2016年08月23日 - 08时48分</p><p><span>原始链接:</span><a class="post-url" href="/backend/2016/08/22/kafka-window.html" title="kafka在window下部署">http://blog.lehoon.cn/backend/2016/08/22/kafka-window.html</a><span class="copy-path" data-clipboard-text="原文: http://blog.lehoon.cn/backend/2016/08/22/kafka-window.html　　作者: lehoon" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span><script src="/js/clipboard.min.js"></script><script>var clipboard=new Clipboard(".copy-path")</script></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target="_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><a href="/orther/2016/08/29/notepad.html" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">&lt;</strong><div class="article-nav-title">随笔</div></a><a href="/backend/2016/08/19/makefile.html" id="article-nav-older" class="article-nav-link-wrap"><div class="article-nav-title">Makefile学习</div><strong class="article-nav-caption">&gt;</strong></a></nav></article><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong></div><input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script><script>var valueHide="隐藏目录",valueShow="显示目录";$(".left-col").is(":hidden")&&$("#tocButton").attr("value",valueShow),$("#tocButton").click(function(){$("#toc").is(":hidden")?($("#tocButton").attr("value",valueHide),$("#toc").slideDown(320)):($("#tocButton").attr("value",valueShow),$("#toc").slideUp(350))}),$(".toc").length<1&&$("#toc, #tocButton").hide()</script><div class="scroll" id="post-nav-button"><a href="/orther/2016/08/29/notepad.html" title="上一篇: 随笔"><i class="fa fa-angle-left"></i></a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a><a href="/backend/2016/08/19/makefile.html" title="下一篇: Makefile学习"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/16/linux-strace.html">linux-strace使用介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/16/linux-brk-sbrk.html">brk,sbrk--改变数据段长度</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/07/centos-note.html">Centos记录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/09/05/raid.html">raid磁盘阵列介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/09/02/nginx-load-balance.html">nginx负载均衡各种场景下的应用</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/09/01/usb-centos-error.html">U盘安装centos7，启动报错</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2016/09/01/js-generate-uuid.html">JavaScript生成全局唯一id的方法</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/29/notepad.html">随笔</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/08/22/kafka-window.html">kafka在window下部署</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/08/19/makefile.html">Makefile学习</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2016/08/16/http-etag-last-midified.html">HTTP缓存ETAG和Last-Modified</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/16/ip-catagory.html">ip地址分类</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/08/09/android-connection-session.html">android非浏览器应用程序与服务器会话保持实现</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/28/memcache-memcached-diff.html">memcache与memcached区别</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/19/centos-lvs.html">CentOS 7.0下安装部署LVS</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/07/19/awk.html">awk学习</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/11/epoll.html">Linux epoll学习</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/golang-deamon.html">go守护进程实现方式</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/tcp-load-balancing.html">tcp连接负载均衡</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/07/04/tcp-rst.html">tcp出现rst情况</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2016/05/26/linux-tcp-optimization.html">Linux下tcp的优化</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/05/08/oracle-merge-into.html">oracle中merge into语法注意点</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2016/02/05/window-batch.html">Window批处理记录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/10/11/kesankaoshi.html">机动车驾驶科目三操作要领</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2015/09/28/window-service-program.html">window服务编程</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/09/21/assembly-instruction.html">汇编指令集</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/09/15/bool-BOOL.html">bool和BOOL的区别</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/08/20/ssh-limit.html">ssh限制ip远程登录</a></li><li class="post-list-item"><a class="post-list-link" href="/orther/2015/08/18/ue-regex.html">ultraedit正则表达式使用</a></li><li class="post-list-item"><a class="post-list-link" href="/backend/2015/05/07/occi.html">c++使用occi连接oracle</a></li><li class="post-list-item"><a class="post-list-link" href="/frontend/2015/03/06/gulp.html">gulp 提高页面加载速度</a></li></ul><script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script><script>$(".post-list").addClass("toc-article"),$(".post-list-item a").attr("target","_blank"),$("#post-nav-button > a:nth-child(2)").click(function(){$(".fa-bars, .fa-times").toggle(),$(".post-list").toggle(300),$(".toc").length>0&&$("#toc, #tocButton").toggle(200,function(){$(".switch-area").is(":visible")&&$("#tocButton").attr("value",valueHide)})})</script><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left">&copy; 2016 lehoon</div><div class="footer-right"><a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman</div></div></div></footer></div><script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script><script src="/js/main.js"></script><script>$(document).ready(function(){})</script><div class="scroll" id="scroll"><a href="#"><i class="fa fa-arrow-up"></i></a><a href="#comments"><i class="fa fa-comments-o"></i></a><a href="#footer"><i class="fa fa-arrow-down"></i></a></div><script>$(document).ready(function(){$("#comments").length<1&&$("#scroll > a:nth-child(2)").hide()})</script><script language="javascript">$(function(){$("a[title]").each(function(){var t=$(this),e=t.attr("title");void 0!=e&&""!=e&&t.data("title",e).removeAttr("title").hover(function(){var i=t.offset();$('<div id="anchortitlecontainer"></div>').appendTo($("body")).html(e).css({top:i.top-t.outerHeight()-15,left:i.left+t.outerWidth()/2+1}).fadeIn(function(){var t=$(this);setTimeout(function(){t.remove()},800*t.text().length)})},function(){$("#anchortitlecontainer").remove()})})})</script></div></body></html>