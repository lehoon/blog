<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>linux使用记录笔记 | 豌豆荚博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="记录linux日常使用过程中的一些使用方式、记录，比较少用的、少见的一些问题及解决方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="linux使用记录笔记">
<meta property="og:url" content="http://lehoon.cn/orther/2018/12/27/linux-using-note.html">
<meta property="og:site_name" content="豌豆荚博客">
<meta property="og:description" content="记录linux日常使用过程中的一些使用方式、记录，比较少用的、少见的一些问题及解决方法。">
<meta property="og:locale">
<meta property="article:published_time" content="2018-12-27T02:02:25.000Z">
<meta property="article:modified_time" content="2019-06-28T02:18:39.212Z">
<meta property="article:author" content="lehoon">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="使用记录">
<meta property="article:tag" content="常用备忘">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="豌豆荚博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
  <script src="/js/pace.js"></script>
  <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: 'https://lehoon.cn',
          fancybox: true,
          animate: false,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Lehoon"></a></h1>
        </hgroup>

        
        
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives">文章</a></li>
                        
                            <li><a href="/projects">项目</a></li>
                        
                            <li><a href="/polymerization">聚合</a></li>
                        
                            <li><a href="/about">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/lehoon" title="github">github</a>
                            
                                <a class="fl weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a>
                            
                                <a class="fl rss" target="_blank" href="/rss.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">热爱生活，享受生活。</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives">文章</a></li>
                
                    <li><a href="/projects">项目</a></li>
                
                    <li><a href="/polymerization">聚合</a></li>
                
                    <li><a href="/about">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:lehoon@lehoon.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/lehoon" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="http://weibo.com/lehoons" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/rss.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-linux-using-note" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/orther/2018/12/27/linux-using-note.html" class="article-date">
      <time datetime="2018-12-27T02:02:25.000Z" itemprop="datePublished">2018-12-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      linux使用记录笔记
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/orther/">其他</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/" rel="tag">使用记录</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E5%A4%87%E5%BF%98/" rel="tag">常用备忘</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>记录linux日常使用过程中的一些使用方式、记录，比较少用的、少见的一些问题及解决方法。</p>
<span id="more"></span>
<p>平时使用linux遇到的比较少见的问题及解决方法，便于后期再次遇到。</p>
<h1 id="Shell命令"><a href="#Shell命令" class="headerlink" title="Shell命令"></a>Shell命令</h1><h2 id="删除特殊字符的目录、文件"><a href="#删除特殊字符的目录、文件" class="headerlink" title="删除特殊字符的目录、文件"></a>删除特殊字符的目录、文件</h2><p>程序开发中经常使用配置文件，然后在程序中引用使用，但是如果配置参数没有定义，则程序不能正确替换，就会生成一些特殊字符的目录、文件，例如： ${app.conf.name} 文件名的文件，使用rm -rf {app.conf.name} 删不掉。需要使用转义字符删除。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lehoon<span class="variable">@lehoon</span> ~]<span class="variable">$ </span>rm -rf \<span class="variable">$\</span>&#123;app.conf.name\&#125;/</span><br></pre></td></tr></table></figure>
<h2 id="计算数组大小"><a href="#计算数组大小" class="headerlink" title="计算数组大小"></a>计算数组大小</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">OLD_IFS</span>=<span class="string">&quot;<span class="variable">$IFS</span>&quot;</span></span><br><span class="line"><span class="attribute">IFS</span>=<span class="string">&quot; &quot;</span></span><br><span class="line"><span class="comment">#query nginx program is exits</span></span><br><span class="line"><span class="attribute">nginx_pid</span>=$(ps -fe | grep ./nginx | grep -v grep | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">nginx_pid_array=(<span class="variable">$nginx_pid</span>)</span><br><span class="line"><span class="attribute">nginx_pid_len</span>=<span class="variable">$&#123;#nginx_pid_array[@]&#125;</span></span><br><span class="line">echo nginx进程已经启动成功，进程数为 <span class="variable">$nginx_pid_len</span></span><br><span class="line"><span class="attribute">IFS</span>=<span class="string">&quot;<span class="variable">$OLD_IFS</span>&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="判断tomcat是否启动成功"><a href="#判断tomcat是否启动成功" class="headerlink" title="判断tomcat是否启动成功"></a>判断tomcat是否启动成功</h2><p>通过查进程检查tomcat是否启动成功，通过curl查询应用的http状态码判断应用是否启动成功。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ps -u lehoon | grep -E <span class="string">&quot;java&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ $? != <span class="number">0</span> ]</span><br><span class="line">then </span><br><span class="line">	su - lehoon -c <span class="string">&quot;sh $tomcat_home/bin/startup.sh&quot;</span></span><br><span class="line">	sleep <span class="number">30</span></span><br><span class="line">	tomcat_status=`curl -I -s -w <span class="string">&quot;%&#123;http_code&#125;&quot;</span> -o <span class="regexp">/dev/</span>null http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">1.178</span>:<span class="number">8080</span>/systemName`</span><br><span class="line">	<span class="keyword">if</span> [ <span class="variable">$tomcat_status</span> -eq <span class="number">200</span> ] ;then</span><br><span class="line">		echo <span class="string">&quot;tomcat,应用启动成功&quot;</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	   echo <span class="string">&quot;tomcat,应用启动失败&quot;</span></span><br><span class="line">	fi;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">	echo <span class="string">&quot;tomcat程序已存在&quot;</span></span><br><span class="line">	<span class="keyword">exit</span> <span class="number">1</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h2 id="no-version-information-available"><a href="#no-version-information-available" class="headerlink" title="no version information available"></a>no version information available</h2><p>执行命令提示free: /opt/SoftwareAG/Apama_5.3/lib/libz.so.1: no version information available (required by /lib64/libdw.so.1)<br>需要把环境变量lib增加</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=<span class="regexp">/usr/lib</span>64<span class="symbol">:/usr/lib</span><span class="symbol">:/lib</span><span class="symbol">:/lib64</span><span class="symbol">:</span><span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure>

<h2 id="普通用户新建crontab任务"><a href="#普通用户新建crontab任务" class="headerlink" title="普通用户新建crontab任务"></a>普通用户新建crontab任务</h2><p>一般使用root创建定时任务，普通用户创建后保存失败。<br>解决方法：使用root创建定时任务，增加指定用户。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@lehoon</span>-server001 ~]<span class="meta"># crontab -u lehoon -e</span></span><br></pre></td></tr></table></figure>
<p>编辑完保存，然后切换到lehoon用户，使用crontab -l查看创建的定时任务。</p>
<h2 id="vi修改文件格式"><a href="#vi修改文件格式" class="headerlink" title="vi修改文件格式"></a>vi修改文件格式</h2><p>日常使用window上传到linux下的shell文件中有回车换行符，在linux下会显示^M导致shell解析错误。<br>使用vi打开文件，然后通过:set ff?查看文件编码格式，在通过:set ff=unix或者:set ff=doc修改格式。</p>
<h2 id="检查文件组和用户"><a href="#检查文件组和用户" class="headerlink" title="检查文件组和用户"></a>检查文件组和用户</h2><p>在linux下使用crontab+shell脚本定时检查文件夹属性group、user是否是指定用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">path=/var/lib/php/session</span><br><span class="line">group_name=$(<span class="built_in">stat</span> -c%G <span class="variable">$&#123;path&#125;</span>)</span><br><span class="line">user_name=$(<span class="built_in">stat</span> -c%U <span class="variable">$&#123;path&#125;</span>)</span><br><span class="line"></span><br><span class="line">datetime=`date +%Y-%m-%d-%H-%M-%S`</span><br><span class="line"><span class="comment">#echo $&#123;datetime&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$group_name</span>&quot;</span>www != <span class="string">&quot;nginx&quot;</span>www ]; <span class=