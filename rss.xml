<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>豌豆荚博客</title>
  
  
  <link href="http://lehoon.cn/rss.xml" rel="self"/>
  
  <link href="http://lehoon.cn/"/>
  <updated>2021-03-24T02:35:55.027Z</updated>
  <id>http://lehoon.cn/</id>
  
  <author>
    <name>lehoon</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>部署运维系统1.0</title>
    <link href="http://lehoon.cn/project/2021/03/24/finesys-devops.html"/>
    <id>http://lehoon.cn/project/2021/03/24/finesys-devops.html</id>
    <published>2021-03-24T02:19:46.000Z</published>
    <updated>2021-03-24T02:35:55.027Z</updated>
    
    <content type="html"><![CDATA[<p>使用springboot2.3.0.RELEASE、Dubbo2.7.5、rocketmq4.7.1、vuejs、golang开发的部署、运维、监控平台.</p><span id="more"></span><h2 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h2><img src="https://lehoon.cn/static/upload/finesys-devops.jpg"/><h2 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h2><ul><li>Springboot2.3.0.RELEASE</li><li>Dubbo2.7.5</li><li>rocketmq4.7.1</li><li>vuejs</li><li>golang</li><li>c/c++</li><li>javaagent</li><li>tdengine2.0.16.0</li></ul><h2 id="当前支持功能"><a href="#当前支持功能" class="headerlink" title="当前支持功能"></a>当前支持功能</h2><h3 id="管理服务器集群"><a href="#管理服务器集群" class="headerlink" title="管理服务器集群"></a>管理服务器集群</h3><p>通过部署golang开发的agent进程，统一管理当前服务器节点，支持下发的部署服务指令、定期采集服务器监控指标信息上报到网关，网关写入到rocketmq中。<br><img src="https://lehoon.cn/static/upload/devops-server.jpg"/></p><h3 id="应用app管理"><a href="#应用app管理" class="headerlink" title="应用app管理"></a>应用app管理</h3><p>把应用app上传到系统中，需要该app的客户可以申请授权，授权后，可以把app部署到自己的服务器节点上去<br><img src="https://lehoon.cn/static/upload/devops-app.jpg"/></p><h3 id="服务管理"><a href="#服务管理" class="headerlink" title="服务管理"></a>服务管理</h3><p>通过选择服务器节点、app应用、用户、部署目录等参数可以发布一个新的服务<br><img src="https://lehoon.cn/static/upload/devops-service.jpg"/></p><h3 id="服务监控"><a href="#服务监控" class="headerlink" title="服务监控"></a>服务监控</h3><p>没启动一个新的服务器，就会实施采集该服务的监控指标信息，java项目通过javaagent启动一个agent进程每隔指定时间就会采集jvm的监控进程、cpu、内存、线程等信息。<br><img src="https://lehoon.cn/static/upload/devops-monitor-jvm-list.jpg"/></p><h3 id="jvm实时监控"><a href="#jvm实时监控" class="headerlink" title="jvm实时监控"></a>jvm实时监控</h3><img src="https://lehoon.cn/static/upload/devops-monitor-jvm.jpg"/>]]></content>
    
    
    <summary type="html">&lt;p&gt;使用springboot2.3.0.RELEASE、Dubbo2.7.5、rocketmq4.7.1、vuejs、golang开发的部署、运维、监控平台.&lt;/p&gt;</summary>
    
    
    
    <category term="项目" scheme="http://lehoon.cn/categories/project/"/>
    
    
    <category term="部署" scheme="http://lehoon.cn/tags/%E9%83%A8%E7%BD%B2/"/>
    
    <category term="运维" scheme="http://lehoon.cn/tags/%E8%BF%90%E7%BB%B4/"/>
    
    <category term="监控" scheme="http://lehoon.cn/tags/%E7%9B%91%E6%8E%A7/"/>
    
    <category term="devops" scheme="http://lehoon.cn/tags/devops/"/>
    
  </entry>
  
  <entry>
    <title>java屏蔽控制台INT信号</title>
    <link href="http://lehoon.cn/orther/2020/04/30/java-signal-ignore-note.html"/>
    <id>http://lehoon.cn/orther/2020/04/30/java-signal-ignore-note.html</id>
    <published>2020-04-30T02:15:53.000Z</published>
    <updated>2020-04-30T02:18:48.711Z</updated>
    
    <content type="html"><![CDATA[<p>java控制台程序屏蔽结束信号ctrl-c。</p><span id="more"></span><p>mian方法里面添加下面代码，经过测试有效。</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sun.misc.SignalHandler <span class="keyword">handler</span> = <span class="keyword">new</span> sun.misc.SignalHandler() &#123;  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">(sun.misc.Signal signal)</span> </span>&#123;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line">sun.misc.Signal.handle(<span class="keyword">new</span> sun.misc.Signal(<span class="string">&quot;INT&quot;</span>), <span class="keyword">handler</span>); </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;java控制台程序屏蔽结束信号ctrl-c。&lt;/p&gt;</summary>
    
    
    
    <category term="其他" scheme="http://lehoon.cn/categories/orther/"/>
    
    
    <category term="java" scheme="http://lehoon.cn/tags/java/"/>
    
    <category term="控制台" scheme="http://lehoon.cn/tags/%E6%8E%A7%E5%88%B6%E5%8F%B0/"/>
    
    <category term="屏蔽信号" scheme="http://lehoon.cn/tags/%E5%B1%8F%E8%94%BD%E4%BF%A1%E5%8F%B7/"/>
    
  </entry>
  
  <entry>
    <title>微信商城小程序</title>
    <link href="http://lehoon.cn/project/2020/04/29/weixin-minishop-note.html"/>
    <id>http://lehoon.cn/project/2020/04/29/weixin-minishop-note.html</id>
    <published>2020-04-29T07:56:01.000Z</published>
    <updated>2020-04-29T09:58:22.690Z</updated>
    
    <content type="html"><![CDATA[<p>微信小程序网上商城，使用php开发的微商城.</p><span id="more"></span><img src="https://lehoon.cn/static/images/gh_f459a92816f5_344.jpg"/>]]></content>
    
    
    <summary type="html">&lt;p&gt;微信小程序网上商城，使用php开发的微商城.&lt;/p&gt;</summary>
    
    
    
    <category term="项目" scheme="http://lehoon.cn/categories/project/"/>
    
    
    <category term="微信" scheme="http://lehoon.cn/tags/%E5%BE%AE%E4%BF%A1/"/>
    
    <category term="小程序" scheme="http://lehoon.cn/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
    <category term="商城" scheme="http://lehoon.cn/tags/%E5%95%86%E5%9F%8E/"/>
    
  </entry>
  
  <entry>
    <title>flink安装部署</title>
    <link href="http://lehoon.cn/backend/2019/11/20/flink-study-note.html"/>
    <id>http://lehoon.cn/backend/2019/11/20/flink-study-note.html</id>
    <published>2019-11-20T02:18:23.000Z</published>
    <updated>2019-11-20T02:50:44.836Z</updated>
    
    <content type="html"><![CDATA[<p>Flink-1.9.0 Standalone安装部署记录。</p><span id="more"></span><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="硬件环境"><a href="#硬件环境" class="headerlink" title="硬件环境"></a>硬件环境</h3><p>1、cpu 4核<br>2、内存16g</p><h3 id="软件环境"><a href="#软件环境" class="headerlink" title="软件环境"></a>软件环境</h3><p>1、<a href="http://archive.apache.org/dist/flink/flink-1.9.0/flink-1.9.0-bin-scala_2.11.tgz">flink版本为1.9.0</a><br>2、<a href="http://centos.org/">CentOS Linux release 7.6.1810 (Core)</a><br>3、<a href="http://www.oracle.com/">1.8.0_201 64-Bit Server</a></p><h3 id="节点环境"><a href="#节点环境" class="headerlink" title="节点环境"></a>节点环境</h3><p>master  192.168.1.56<br>slave01 192.168.1.58<br>slave02 192.168.1.59<br>slave03 192.168.1.60<br>修改/etc/hosts文件，添加映射关系</p><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><h3 id="创建flink账号，密码flink"><a href="#创建flink账号，密码flink" class="headerlink" title="创建flink账号，密码flink"></a>创建flink账号，密码flink</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">adduser flink</span></span><br><span class="line"><span class="attribute">passwd flink</span></span><br></pre></td></tr></table></figure><h3 id="添加ssh免密码登陆"><a href="#添加ssh免密码登陆" class="headerlink" title="添加ssh免密码登陆"></a>添加ssh免密码登陆</h3><p>在master上使用ssh-keygen -t rsa生成公钥后，使用ssh-copyid复制master公钥到salve机器上。</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[flink<span class="meta">@master</span> ~]$ ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/home/flink/.ssh/id_rsa): </span><br><span class="line">Created directory &#x27;/home/flink/.ssh&#x27;.</span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /home/flink/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /home/flink/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:dMjfT7GUSv03bXpdYb038gsB5XEcGtWylc9oSDhkLhw flink<span class="meta">@master</span></span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|<span class="string">        E.o. +o++</span>|</span><br><span class="line">|<span class="string">       o =o +.*++</span>|</span><br><span class="line">|<span class="string">        * o+.+=Oo</span>|</span><br><span class="line">|<span class="string">       . + ooo=+*</span>|</span><br><span class="line">|<span class="string">        S . o+o+B</span>|</span><br><span class="line">|<span class="string">             o+oB</span>|</span><br><span class="line">|<span class="string">             .o.o</span>|</span><br><span class="line">|<span class="string">              ...</span>|</span><br><span class="line">|<span class="string">               . </span>|</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line"></span><br><span class="line">然后使用ssh-copyid复制</span><br><span class="line">[flink<span class="meta">@master</span> ~]$ ssh-copy-id flink<span class="meta">@slave01</span></span><br><span class="line">[flink<span class="meta">@master</span> ~]$ ssh-copy-id flink<span class="meta">@slave02</span></span><br><span class="line">[flink<span class="meta">@master</span> ~]$ ssh-copy-id flink<span class="meta">@slave03</span></span><br></pre></td></tr></table></figure><h3 id="切换flink账号下载flink-解压flink"><a href="#切换flink账号下载flink-解压flink" class="headerlink" title="切换flink账号下载flink,解压flink"></a>切换flink账号下载flink,解压flink</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[flink@master ~]$ wget http:<span class="regexp">//</span>archive.apache.org<span class="regexp">/dist/</span>flink<span class="regexp">/flink-1.9.0/</span>flink-<span class="number">1.9</span>.<span class="number">0</span>-bin-scala_2.<span class="number">11</span>.tgz</span><br><span class="line"></span><br><span class="line">[flink@master ~]$ tar zxvf flink-<span class="number">1.9</span>.<span class="number">0</span>-bin-scala_2.<span class="number">11</span>.tgz</span><br></pre></td></tr></table></figure><h3 id="添加flink环境变量"><a href="#添加flink环境变量" class="headerlink" title="添加flink环境变量"></a>添加flink环境变量</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi ~ /.bash_profile</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">FLINK_HOME</span>=/home/flink/flink-1.9.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$PATH</span>:$FLINK_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="修改flink配置文件"><a href="#修改flink配置文件" class="headerlink" title="修改flink配置文件"></a>修改flink配置文件</h3><p>进入目录/home/flink/flink-1.9.0/conf<br>修改flink-conf.yaml,主要修改项：jobmanager.rpc.address</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi flink-conf.yaml</span><br><span class="line">jobmanager<span class="selector-class">.rpc</span><span class="selector-class">.address</span>: master</span><br></pre></td></tr></table></figure><p>修改masters 文件,添加master映射名称到master文件中</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vi</span> /home/flink/flink-<span class="number">1</span>.<span class="number">9</span>.<span class="number">0</span>/conf/masters </span><br><span class="line"><span class="attribute">master</span>:<span class="number">8081</span></span><br></pre></td></tr></table></figure><p>修改slaves文件，添加slave到文件中</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/home/</span>flink<span class="regexp">/flink-1.9.0/</span>conf/slaves</span><br><span class="line">slave01</span><br><span class="line">slave02</span><br><span class="line">slave03</span><br></pre></td></tr></table></figure><h3 id="分发flink到slave机器"><a href="#分发flink到slave机器" class="headerlink" title="分发flink到slave机器"></a>分发flink到slave机器</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/flink</span><br><span class="line">scp -r flink<span class="number">-1.9</span>.0/ flink<span class="variable">@slave01</span><span class="symbol">:/home/flink</span></span><br><span class="line">scp -r flink<span class="number">-1.9</span>.0/ flink<span class="variable">@slave02</span><span class="symbol">:/home/flink</span></span><br><span class="line">scp -r flink<span class="number">-1.9</span>.0/ flink<span class="variable">@slave03</span><span class="symbol">:/home/flink</span></span><br></pre></td></tr></table></figure><h2 id="启动flink"><a href="#启动flink" class="headerlink" title="启动flink"></a>启动flink</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/home/</span>flink<span class="regexp">/flink-1.9.0/</span>bin</span><br><span class="line">./start-cluster.sh</span><br></pre></td></tr></table></figure><h2 id="停止flink"><a href="#停止flink" class="headerlink" title="停止flink"></a>停止flink</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/home/</span>flink<span class="regexp">/flink-1.9.0/</span>bin</span><br><span class="line">./stop-cluster.sh</span><br></pre></td></tr></table></figure><h2 id="查看控制台"><a href="#查看控制台" class="headerlink" title="查看控制台"></a>查看控制台</h2><p>打开网址: <a href="http://master:8081/">http://master:8081</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Flink-1.9.0 Standalone安装部署记录。&lt;/p&gt;</summary>
    
    
    
    <category term="后端" scheme="http://lehoon.cn/categories/backend/"/>
    
    
    <category term="flink" scheme="http://lehoon.cn/tags/flink/"/>
    
  </entry>
  
  <entry>
    <title>chrome占用cpu解决方法</title>
    <link href="http://lehoon.cn/orther/2019/11/18/chrome-cpu-note.html"/>
    <id>http://lehoon.cn/orther/2019/11/18/chrome-cpu-note.html</id>
    <published>2019-11-18T02:39:10.000Z</published>
    <updated>2019-11-18T02:43:06.475Z</updated>
    
    <content type="html"><![CDATA[<p>chrome长时间占用cpu解决方法。</p><h2 id="清理浏览器缓存"><a href="#清理浏览器缓存" class="headerlink" title="清理浏览器缓存"></a>清理浏览器缓存</h2><p>通过清理浏览器缓存有时可以解决chrome占用cpu过多问题。<br>菜单—设置—–高级——隐私设置和安全性,点击清除浏览数据。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;chrome长时间占用cpu解决方法。&lt;/p&gt;
&lt;h2 id=&quot;清理浏览器缓存&quot;&gt;&lt;a href=&quot;#清理浏览器缓存&quot; class=&quot;headerlink&quot; title=&quot;清理浏览器缓存&quot;&gt;&lt;/a&gt;清理浏览器缓存&lt;/h2&gt;&lt;p&gt;通过清理浏览器缓存有时可以解决chrome占用</summary>
      
    
    
    
    <category term="其他" scheme="http://lehoon.cn/categories/orther/"/>
    
    
    <category term="chrome" scheme="http://lehoon.cn/tags/chrome/"/>
    
    <category term="占用cpu" scheme="http://lehoon.cn/tags/%E5%8D%A0%E7%94%A8cpu/"/>
    
  </entry>
  
  <entry>
    <title>python记录</title>
    <link href="http://lehoon.cn/backend/2019/06/21/python-note.html"/>
    <id>http://lehoon.cn/backend/2019/06/21/python-note.html</id>
    <published>2019-06-21T02:02:11.000Z</published>
    <updated>2019-06-25T00:56:27.273Z</updated>
    
    <content type="html"><![CDATA[<p>python使用中一些问题记录。</p><span id="more"></span><hr><h1 id="日常使用"><a href="#日常使用" class="headerlink" title="日常使用"></a>日常使用</h1><h2 id="修改pip使用国内源安装软件"><a href="#修改pip使用国内源安装软件" class="headerlink" title="修改pip使用国内源安装软件"></a>修改pip使用国内源安装软件</h2><p>在window系统上，需要在c:\users\用户名  文件夹下新建pip文件夹，里面新建pip.ini文件，增加使用国内清华的pip源，文件内容如下：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line"><span class="built_in">index</span>-url = http<span class="variable">s:</span>//pypi.tuna.tsinghua.edu.<span class="keyword">cn</span>/simple</span><br></pre></td></tr></table></figure><p>再使用pip安装软件的时候就使用清华的源下载软件。不需要退出控制台即可生效。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;python使用中一些问题记录。&lt;/p&gt;</summary>
    
    
    
    <category term="后端" scheme="http://lehoon.cn/categories/backend/"/>
    
    
    <category term="python" scheme="http://lehoon.cn/tags/python/"/>
    
    <category term="pip" scheme="http://lehoon.cn/tags/pip/"/>
    
    <category term="国内源" scheme="http://lehoon.cn/tags/%E5%9B%BD%E5%86%85%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>maven私服neuxs错误集合</title>
    <link href="http://lehoon.cn/backend/2019/06/17/maven-error-note.html"/>
    <id>http://lehoon.cn/backend/2019/06/17/maven-error-note.html</id>
    <published>2019-06-17T06:05:20.000Z</published>
    <updated>2019-06-18T07:59:08.789Z</updated>
    
    <content type="html"><![CDATA[<p>记录使用nexus搭建maven私服日常使用中遇到的错误。</p><span id="more"></span><h1 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h1><h2 id="上传大文件-一直显示滚动条"><a href="#上传大文件-一直显示滚动条" class="headerlink" title="上传大文件,一直显示滚动条"></a>上传大文件,一直显示滚动条</h2><p>上传比较大的jar到nexus私服中时，一直显示上传进度滚动条，最后上传失败。是因为前端使用了nginx反向代理，而且nginx中配置的客户端上传的body请求最大值小于该jar包实际大小导致。<br>只要修改nginx的配置文件，修改client_max_body_size 20m;保证该数值大于你要上传的jar包大小即可解决。<br>nginx.conf配置文件。</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client_max_body_size <span class="number">20</span>m<span class="comment">;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录使用nexus搭建maven私服日常使用中遇到的错误。&lt;/p&gt;</summary>
    
    
    
    <category term="后端" scheme="http://lehoon.cn/categories/backend/"/>
    
    
    <category term="maven" scheme="http://lehoon.cn/tags/maven/"/>
    
    <category term="nexus" scheme="http://lehoon.cn/tags/nexus/"/>
    
    <category term="私服" scheme="http://lehoon.cn/tags/%E7%A7%81%E6%9C%8D/"/>
    
    <category term="错误集合" scheme="http://lehoon.cn/tags/%E9%94%99%E8%AF%AF%E9%9B%86%E5%90%88/"/>
    
  </entry>
  
  <entry>
    <title>在centos7 linux上编译php-7.1.28</title>
    <link href="http://lehoon.cn/backend/2019/04/12/linux-compile-php7.html"/>
    <id>http://lehoon.cn/backend/2019/04/12/linux-compile-php7.html</id>
    <published>2019-04-12T02:01:08.000Z</published>
    <updated>2019-06-21T02:10:17.965Z</updated>
    
    <content type="html"><![CDATA[<p>在centos7上边编译php7.1.28版本过程记录。</p><span id="more"></span><h1 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h1><h1 id="编译php"><a href="#编译php" class="headerlink" title="编译php"></a>编译php</h1><h1 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h1><p>1、 configure: error: Unable to detect ICU prefix or no failed. Please verify ICU install prefix and make sure icu-config works.<br>yum -y install libicu-devel</p><p>configure: error: mcrypt.h not found. Please reinstall libmcrypt.</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;在centos7上边编译php7.1.28版本过程记录。&lt;/p&gt;</summary>
    
    
    
    <category term="后端" scheme="http://lehoon.cn/categories/backend/"/>
    
    
    <category term="centos7" scheme="http://lehoon.cn/tags/centos7/"/>
    
    <category term="php7" scheme="http://lehoon.cn/tags/php7/"/>
    
    <category term="编译php7" scheme="http://lehoon.cn/tags/%E7%BC%96%E8%AF%91php7/"/>
    
  </entry>
  
  <entry>
    <title>金融信息交换fix协议文档</title>
    <link href="http://lehoon.cn/orther/2019/03/20/fix-protocol-note.html"/>
    <id>http://lehoon.cn/orther/2019/03/20/fix-protocol-note.html</id>
    <published>2019-03-20T07:47:56.000Z</published>
    <updated>2019-03-21T06:55:04.026Z</updated>
    
    <content type="html"><![CDATA[<p>Financial Information eXchange(FIX)金融信息交换协议的制定是由多个致力于提升其相互间交易流程效率的金融机构和经纪商于1992年共同发起。这些企业把他们及他们的行业视为一个整体，认为能够从对交易指示，交易指令及交易执行的高效电子数据交换的驱动中获利。FIX由此诞生，一个不受单一实体控制的开放消息标准，一个能够被调整组建适用于任何一个企业的商务需求的协议。</p><span id="more"></span><h1 id="协议定义"><a href="#协议定义" class="headerlink" title="协议定义"></a>协议定义</h1><h2 id="协议格式"><a href="#协议格式" class="headerlink" title="协议格式"></a>协议格式</h2><p>—-消息头—-|—-消息体——|—-消息尾——<br>fix协议由三部分组成，消息头、消息体、消息尾。</p><ul><li>各自组成</li></ul><ul><li>消息头：起始tag、消息长度两部分组成。</li><li>消息体：由约定好的各个tag=value组成,一般由上游厂家制定好协议，提供具体消息格式给下游商家使用。</li><li>消息尾:消息体校验码，一般类似crc校验，主要是消息体信息的校验码。</li></ul><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ul><li>fix协议定义的数据类型包括：</li></ul><ul><li>整数int  没有小数点，逗号，可以包含正负号的数字序列。注，int的值前面可以包含0。(如 “00023” = “23”).</li><li>浮点数float 可包含小数点和正负号的数字序。累计总长度为15个数字。前面可以有0，小数末尾可加零，或截尾</li><li>单个字符char 除分界符号SOH外的字符。大小写敏感</li><li>布尔Boolean</li><li>字符串String 是大小写敏感的</li><li>数据data  没有格式和内容限制。之前紧接有一个长度域。长度域应制定data数据域包含的字节数（不好含分界符所占字节）。数据中可能包含分界符字节，所以需要用data类型数据长度来辅助区别。</li></ul><h2 id="属性域"><a href="#属性域" class="headerlink" title="属性域"></a>属性域</h2><p>fix协议中域的概念类似于消息中表达独立含义的属性，在fix协议中都固化了一个tag来约定特殊含义，比如把xml的node名称使用数字来替代。</p><ul><li>定义</li></ul><ul><li>开始部分是消息头，随后是消息体，最后是消息结尾;</li><li>消息头的前3个域的顺序不能改变:起始(tag=8)、消息体长度(tag=9)、消息类型(tag=35);</li><li>消息尾的最后一个域是校验和域(tag=10)</li><li>重复组中，域出现的顺序应遵顼该重复组在消息或组件中定义的顺序;</li><li>在一条消息中，除重复组域外任何其他域不能重复出现;</li></ul><h2 id="域标识"><a href="#域标识" class="headerlink" title="域标识"></a>域标识</h2><table><thead><tr><th>域标识</th><th>名称</th><th>备注</th></tr></thead><tbody><tr><td>8</td><td>BeginString</td><td>fix协议消息起始串</td></tr><tr><td>9</td><td>BodyLength</td><td>消息体长度，不是fix协议消息长度</td></tr><tr><td>10</td><td>校验码</td><td>消息体的校验码参考crc校验码，实现数据有效校验使用</td></tr><tr><td>11</td><td>CIOrdID</td><td>客户端订单ID</td></tr><tr><td>35</td><td>MsgType</td><td>消息类型，表明该消息是具体哪个业务类型，比如登陆、注销、下订单等</td></tr><tr><td>37</td><td>OrderID</td><td>服务端订单ID</td></tr><tr><td>41</td><td>OrigCIOrdID</td><td>原始客户端订单ID</td></tr><tr><td>54</td><td>Side</td><td>买卖类型，例如：1 = Buy，2 = Sell</td></tr><tr><td>55</td><td>Symbol</td><td>股票代码。例如：YRD</td></tr></tbody></table><h2 id="安全与加密"><a href="#安全与加密" class="headerlink" title="安全与加密"></a>安全与加密</h2><ul><li>由于消息有可能在公网或不安全的网络上传输交换，因此需要对相关的敏感数据加密处理。</li><li>具体加密的方法由连接双方达成的协议而定。</li><li>消息内除某些需要公开识别的域以明文传输外其他任何域都可以加密放置密文数据域 (SecureData)内。当然，这些被加密的域也可以同时保留明文的表示方式。</li><li>当决定使用加密方案时，可以对消息正文内所有的域加密。如果消息的重复组内有部分需要加密的，那么要求对整个重复组加密。</li><li>本协议还提供的一些域用以支持数字签名、密钥交换和正文加密等安全技术。</li></ul><h2 id="消息"><a href="#消息" class="headerlink" title="消息"></a>消息</h2><h3 id="消息头"><a href="#消息头" class="headerlink" title="消息头"></a>消息头</h3><p>每一个会话或应用消息有一个消息头，该消息头指明消息类型、消息体长度、发送目的地、消息序号、发送起始点和发送时间。</p><table><thead><tr><th>域标识</th><th>名称</th><th>是否必须</th><th>备注</th></tr></thead><tbody><tr><td>8</td><td>BeginString</td><td>Y</td><td>起始串，取值:FIX.4.2(不可加密，消息的第一个域)</td></tr><tr><td>9</td><td>BodyLength</td><td>Y</td><td>消息体长度(不可加密，消息的第二个域)</td></tr></tbody></table><h3 id="消息体"><a href="#消息体" class="headerlink" title="消息体"></a>消息体</h3><p>消息体是业务数据实体，承载了每个协议具体业务操作和数据</p><table><thead><tr><th>域标识</th><th>名称</th><th>是否必须</th><th>备注</th></tr></thead><tbody><tr><td>35</td><td>MsgType</td><td>Y</td><td>消息类型(不可加密，消息的第三个域)</td></tr><tr><td>49</td><td>SenderCompID</td><td>Y</td><td>发送方代码(不可加密，发送方标识符)</td></tr><tr><td>56</td><td>TargetCompID</td><td>Y</td><td>接收方代码(不可加密，接收方标识符)</td></tr><tr><td>115</td><td>OnBehalfOfCompID</td><td>N</td><td>最初发送方标识符(可加密)，用于经第三方发送。</td></tr><tr><td>128</td><td>DeliverToCompID</td><td>N</td><td>最终接收方标识符(可加密)，用于经第三方发送。</td></tr><tr><td>90</td><td>SecureDataLen</td><td>N</td><td>密文数据长度</td></tr><tr><td>91</td><td>SecureData</td><td>N</td><td>密文数据(紧跟密文数据长度域)</td></tr><tr><td>34</td><td>MsgSeqNum</td><td>Y</td><td>消息序号(可加密)，如果交易双方不采用 FIX 会话 机制，可将该 tag 置为一个固定的值，例如 0。</td></tr><tr><td>50</td><td>SenderSubID</td><td>N</td><td>发送方子标识符(可加密)</td></tr><tr><td>142</td><td>SenderLocationID</td><td>N</td><td>发送方方位标识符(可加密)</td></tr><tr><td>57</td><td>TargetSubID</td><td>N</td><td>接收方子标识符(可加密)</td></tr><tr><td>143</td><td>TargetLocationID</td><td>N</td><td>接收方方位标识符(可加密)</td></tr><tr><td>116</td><td>OnBehalfOfSubID</td><td>N</td><td>最初发送方子标识符(可加密)</td></tr><tr><td>144</td><td>OnBehalfOfLocationID</td><td>N</td><td>最初发送方方位标识符(可加密)</td></tr><tr><td>129</td><td>DeliverToSubID</td><td>N</td><td>最终接收方子标识符(可加密)</td></tr><tr><td>145</td><td>DeliverToLocationID</td><td>N</td><td>最终接收方方位标识符(可加密)</td></tr><tr><td>43</td><td>PossDupFlag</td><td>N</td><td>可能重复标志，重复发送时，作此标记。(可加密)</td></tr><tr><td>97</td><td>PossResend</td><td>N</td><td>可能重发标志。(可加密)</td></tr><tr><td>52</td><td>SendingTime</td><td>Y</td><td>发送时间(可加密)</td></tr><tr><td>122</td><td>OrigSendingTime</td><td>N</td><td>原始发送时间(可加密)</td></tr><tr><td>347</td><td>MessageEncoding</td><td>N</td><td>消息中 Encoded 域的字符编码类型(非 ASCII 码)</td></tr><tr><td>369</td><td>LastMsgSeqNumProcessed</td><td>N</td><td>最后处理消息序号(可加密)</td></tr><tr><td>370</td><td>OnBehalfOfSendingTime</td><td>N</td><td>最初发送时间(用 UTC 表示时间)</td></tr></tbody></table><h3 id="消息尾"><a href="#消息尾" class="headerlink" title="消息尾"></a>消息尾</h3><p>每一个消息(会话或应用消息)有一个消息尾，并以此终止。消息尾可用于分隔多个消息，包含有 3 位数的校验和值。</p><table><thead><tr><th>域标识</th><th>名称</th><th>是否必须</th><th>备注</th></tr></thead><tbody><tr><td>93</td><td>SignatureLength</td><td>N</td><td>数字签名长度(不可加密)</td></tr><tr><td>89</td><td>Signature</td><td>N</td><td>数字签名(不可加密)</td></tr><tr><td>10</td><td>CheckSum</td><td>Y</td><td>校验和，消息的最末域。(不可加密)</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;p&gt;Financial Information eXchange(FIX)金融信息交换协议的制定是由多个致力于提升其相互间交易流程效率的金融机构和经纪商于1992年共同发起。这些企业把他们及他们的行业视为一个整体，认为能够从对交易指示，交易指令及交易执行的高效电子数据交换的驱动中获利。FIX由此诞生，一个不受单一实体控制的开放消息标准，一个能够被调整组建适用于任何一个企业的商务需求的协议。&lt;/p&gt;</summary>
    
    
    
    <category term="其他" scheme="http://lehoon.cn/categories/orther/"/>
    
    
    <category term="金融信息交换" scheme="http://lehoon.cn/tags/%E9%87%91%E8%9E%8D%E4%BF%A1%E6%81%AF%E4%BA%A4%E6%8D%A2/"/>
    
    <category term="fix协议" scheme="http://lehoon.cn/tags/fix%E5%8D%8F%E8%AE%AE/"/>
    
    <category term="协议" scheme="http://lehoon.cn/tags/%E5%8D%8F%E8%AE%AE/"/>
    
  </entry>
  
  <entry>
    <title>linux使用记录笔记</title>
    <link href="http://lehoon.cn/orther/2018/12/27/linux-using-note.html"/>
    <id>http://lehoon.cn/orther/2018/12/27/linux-using-note.html</id>
    <published>2018-12-27T02:02:25.000Z</published>
    <updated>2019-06-28T02:18:39.212Z</updated>
    
    <content type="html"><![CDATA[<p>记录linux日常使用过程中的一些使用方式、记录，比较少用的、少见的一些问题及解决方法。</p><span id="more"></span><p>平时使用linux遇到的比较少见的问题及解决方法，便于后期再次遇到。</p><h1 id="Shell命令"><a href="#Shell命令" class="headerlink" title="Shell命令"></a>Shell命令</h1><h2 id="删除特殊字符的目录、文件"><a href="#删除特殊字符的目录、文件" class="headerlink" title="删除特殊字符的目录、文件"></a>删除特殊字符的目录、文件</h2><p>程序开发中经常使用配置文件，然后在程序中引用使用，但是如果配置参数没有定义，则程序不能正确替换，就会生成一些特殊字符的目录、文件，例如： ${app.conf.name} 文件名的文件，使用rm -rf {app.conf.name} 删不掉。需要使用转义字符删除。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lehoon<span class="variable">@lehoon</span> ~]<span class="variable">$ </span>rm -rf \<span class="variable">$\</span>&#123;app.conf.name\&#125;/</span><br></pre></td></tr></table></figure><h2 id="计算数组大小"><a href="#计算数组大小" class="headerlink" title="计算数组大小"></a>计算数组大小</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">OLD_IFS</span>=<span class="string">&quot;<span class="variable">$IFS</span>&quot;</span></span><br><span class="line"><span class="attribute">IFS</span>=<span class="string">&quot; &quot;</span></span><br><span class="line"><span class="comment">#query nginx program is exits</span></span><br><span class="line"><span class="attribute">nginx_pid</span>=$(ps -fe | grep ./nginx | grep -v grep | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">nginx_pid_array=(<span class="variable">$nginx_pid</span>)</span><br><span class="line"><span class="attribute">nginx_pid_len</span>=<span class="variable">$&#123;#nginx_pid_array[@]&#125;</span></span><br><span class="line">echo nginx进程已经启动成功，进程数为 <span class="variable">$nginx_pid_len</span></span><br><span class="line"><span class="attribute">IFS</span>=<span class="string">&quot;<span class="variable">$OLD_IFS</span>&quot;</span></span><br></pre></td></tr></table></figure><h2 id="判断tomcat是否启动成功"><a href="#判断tomcat是否启动成功" class="headerlink" title="判断tomcat是否启动成功"></a>判断tomcat是否启动成功</h2><p>通过查进程检查tomcat是否启动成功，通过curl查询应用的http状态码判断应用是否启动成功。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ps -u lehoon | grep -E <span class="string">&quot;java&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ $? != <span class="number">0</span> ]</span><br><span class="line">then </span><br><span class="line">su - lehoon -c <span class="string">&quot;sh $tomcat_home/bin/startup.sh&quot;</span></span><br><span class="line">sleep <span class="number">30</span></span><br><span class="line">tomcat_status=`curl -I -s -w <span class="string">&quot;%&#123;http_code&#125;&quot;</span> -o <span class="regexp">/dev/</span>null http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">1.178</span>:<span class="number">8080</span>/systemName`</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$tomcat_status</span> -eq <span class="number">200</span> ] ;then</span><br><span class="line">echo <span class="string">&quot;tomcat,应用启动成功&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   echo <span class="string">&quot;tomcat,应用启动失败&quot;</span></span><br><span class="line">fi;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">echo <span class="string">&quot;tomcat程序已存在&quot;</span></span><br><span class="line"><span class="keyword">exit</span> <span class="number">1</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h2 id="no-version-information-available"><a href="#no-version-information-available" class="headerlink" title="no version information available"></a>no version information available</h2><p>执行命令提示free: /opt/SoftwareAG/Apama_5.3/lib/libz.so.1: no version information available (required by /lib64/libdw.so.1)<br>需要把环境变量lib增加</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=<span class="regexp">/usr/lib</span>64<span class="symbol">:/usr/lib</span><span class="symbol">:/lib</span><span class="symbol">:/lib64</span><span class="symbol">:</span><span class="variable">$LD_LIBRARY_PATH</span></span><br></pre></td></tr></table></figure><h2 id="普通用户新建crontab任务"><a href="#普通用户新建crontab任务" class="headerlink" title="普通用户新建crontab任务"></a>普通用户新建crontab任务</h2><p>一般使用root创建定时任务，普通用户创建后保存失败。<br>解决方法：使用root创建定时任务，增加指定用户。</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@lehoon</span>-server001 ~]<span class="meta"># crontab -u lehoon -e</span></span><br></pre></td></tr></table></figure><p>编辑完保存，然后切换到lehoon用户，使用crontab -l查看创建的定时任务。</p><h2 id="vi修改文件格式"><a href="#vi修改文件格式" class="headerlink" title="vi修改文件格式"></a>vi修改文件格式</h2><p>日常使用window上传到linux下的shell文件中有回车换行符，在linux下会显示^M导致shell解析错误。<br>使用vi打开文件，然后通过:set ff?查看文件编码格式，在通过:set ff=unix或者:set ff=doc修改格式。</p><h2 id="检查文件组和用户"><a href="#检查文件组和用户" class="headerlink" title="检查文件组和用户"></a>检查文件组和用户</h2><p>在linux下使用crontab+shell脚本定时检查文件夹属性group、user是否是指定用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">path=/var/lib/php/session</span><br><span class="line">group_name=$(<span class="built_in">stat</span> -c%G <span class="variable">$&#123;path&#125;</span>)</span><br><span class="line">user_name=$(<span class="built_in">stat</span> -c%U <span class="variable">$&#123;path&#125;</span>)</span><br><span class="line"></span><br><span class="line">datetime=`date +%Y-%m-%d-%H-%M-%S`</span><br><span class="line"><span class="comment">#echo $&#123;datetime&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$group_name</span>&quot;</span>www != <span class="string">&quot;nginx&quot;</span>www ]; <span class="keyword">then</span></span><br><span class="line">    chown -R nginx:nginx /var/lib/php/session</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[<span class="variable">$&#123;datetime&#125;</span>] group_name is not nginx&quot;</span> &gt;&gt;/data/yunwei/yunwei.log</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[<span class="variable">$&#123;datetime&#125;</span>] group_name is nginx&quot;</span> &gt;&gt;/data/yunwei/yunwei.log</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$user_name</span>&quot;</span>www != <span class="string">&quot;nginxwww&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    chown -R nginx:nginx /var/lib/php/session</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[<span class="variable">$&#123;datetime&#125;</span>] user_name is not nginx&quot;</span>  &gt;&gt;/data/yunwei/yunwei.log</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[<span class="variable">$&#123;datetime&#125;</span>] user_name is nginx&quot;</span>  &gt;&gt;/data/yunwei/yunwei.log</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录linux日常使用过程中的一些使用方式、记录，比较少用的、少见的一些问题及解决方法。&lt;/p&gt;</summary>
    
    
    
    <category term="其他" scheme="http://lehoon.cn/categories/orther/"/>
    
    
    <category term="linux" scheme="http://lehoon.cn/tags/linux/"/>
    
    <category term="使用记录" scheme="http://lehoon.cn/tags/%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    
    <category term="常用备忘" scheme="http://lehoon.cn/tags/%E5%B8%B8%E7%94%A8%E5%A4%87%E5%BF%98/"/>
    
  </entry>
  
  <entry>
    <title>openjdk1.8中的Makefile</title>
    <link href="http://lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html"/>
    <id>http://lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html</id>
    <published>2018-12-06T02:17:04.000Z</published>
    <updated>2018-12-07T02:56:40.824Z</updated>
    
    <content type="html"><![CDATA[<p>openJdk1.8中的makefile，记录下java的执行文件编译过程及jvm编译过程。</p><span id="more"></span><h2 id="目录说明"><a href="#目录说明" class="headerlink" title="目录说明"></a>目录说明</h2><p>openjdk源码中有很多目录，根据功能做了模块化划分，每个目录实现其相应的功能。<br>每个目录下的结构都差不多，分为src(源码)、make(makefile)、test(或没有)、其他特殊目录。</p><ul><li>openjdk</li></ul><ul><li>common    一些公共文件，比如下载源码的shell脚本、生成make的autoconf等文件</li><li>corba     分布式通讯接口</li><li>hotspot   虚拟机实现</li><li>jaxp      xml处理代码</li><li>jaxws     ws实现api</li><li>jdk       jdk源码</li><li>langtools java语言工具实现，比如javac、javap等</li><li>make      make文件</li><li>nashorn   java中js的运行时实现</li><li>test      测试文件</li></ul><h3 id="Jdk目录"><a href="#Jdk目录" class="headerlink" title="Jdk目录"></a>Jdk目录</h3><h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul><li>jdk<ul><li>src          源码目录<ul><li>bsd        bsd实现</li><li>linux      linux实现</li><li>macosx     macos实现</li><li>share      公用代码，linux平台代码会在这里</li><li>solaris    solaris实现</li><li>windows    window实现</li></ul></li><li>make         makefile</li><li>test         单元测试文件</li></ul></li></ul><h3 id="langtools目录"><a href="#langtools目录" class="headerlink" title="langtools目录"></a>langtools目录</h3><p>该目录主要实现了jdk提供的基于jvm的工具，比如:java, javac, javah, javap等。</p><h4 id="目录-1"><a href="#目录-1" class="headerlink" title="目录"></a>目录</h4><ul><li>langtools</li></ul><ul><li>src                     源码目录<ul><li>share                 java源代码<ul><li>bin                 模板</li><li>classes             java源码文件<ul><li>com               存放了java提供的一些基础类实现,打包成tools.jar</li><li>javax</li><li>jdk</li></ul></li><li>sample              样例源码</li></ul></li></ul></li><li>make                    makefile目录</li><li>test                    测试用例目录</li></ul><h2 id="Makefile目标生成"><a href="#Makefile目标生成" class="headerlink" title="Makefile目标生成"></a>Makefile目标生成</h2><h3 id="可执行文件编译Makefile"><a href="#可执行文件编译Makefile" class="headerlink" title="可执行文件编译Makefile"></a>可执行文件编译Makefile</h3><p>文件名为：/openjdk/jdk/make/CompileLaunchers.gmk<br>java中提供的bin目录下的java、javac、javap等都不是完全通过c/c++编写实现的，是通过c/c++入口，启动虚拟机加载class文件实现的相关功能。<br>通过c/c++的main函数入口，创建jvm虚拟机后，通过执行相关功能的java代码实现其功能，所以java相关的功能如编译、运行、查看jvm信息等功能都是通过启动一个jvm虚拟机或者通过jvmti等实现的。</p><p>在makefile文件中可以查看到该部分定义。</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifndef</span> BUILD_HEADLESS_ONLY</span><br><span class="line">  <span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,appletviewer, \</span></span><br><span class="line"><span class="variable">      -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;sun.applet.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;,, \</span></span><br><span class="line"><span class="variable">      <span class="variable">$(XLIBS)</span>)</span>)</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,extcheck, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.extcheck.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,idlj, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.corba.se.idl.toJavaPortable.Compile&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jar, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;sun.tools.jar.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jarsigner, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;sun.security.tools.jarsigner.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,javac, \</span></span><br><span class="line"><span class="variable">    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.javac.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(ENABLE_SJAVAC)</span>, yes)</span><br><span class="line">  <span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,sjavac, \</span></span><br><span class="line"><span class="variable">      -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">      -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">      -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.sjavac.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,javadoc, \</span></span><br><span class="line"><span class="variable">    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.javadoc.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,javah, \</span></span><br><span class="line"><span class="variable">    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.javah.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,javap, \</span></span><br><span class="line"><span class="variable">    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.javap.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jdeps, \</span></span><br><span class="line"><span class="variable">    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span class="line"><span class="variable">    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.jdeps.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line">BUILD_LAUNCHER_jconsole_CFLAGS_windows := -DJAVAW</span><br><span class="line">BUILD_LAUNCHER_jconsole_LDFLAGS_windows := user32.lib</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jconsole, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;-J-Djconsole.showOutputViewer&quot;<span class="variable">$(COMMA)</span> &quot;sun.tools.jconsole.JConsole&quot;<span class="variable">$(COMMA)</span> &#125;&#x27; \</span></span><br><span class="line"><span class="variable">    -DAPP_CLASSPATH=&#x27;&#123; &quot;/lib/jconsole.jar&quot;<span class="variable">$(COMMA)</span> &quot;/lib/tools.jar&quot;<span class="variable">$(COMMA)</span> &quot;/classes&quot; &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jdb, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.example.debug.tty.TTY&quot;<span class="variable">$(COMMA)</span> &#125;&#x27; \</span></span><br><span class="line"><span class="variable">    -DAPP_CLASSPATH=&#x27;&#123; &quot;/lib/tools.jar&quot;<span class="variable">$(COMMA)</span> &quot;/lib/sa-jdi.jar&quot;<span class="variable">$(COMMA)</span> &quot;/classes&quot; &#125;&#x27;)</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$(<span class="built_in">eval</span> $(<span class="built_in">call</span> SetupLauncher,jhat, \</span></span><br><span class="line"><span class="variable">    -DJAVA_ARGS=&#x27;&#123; &quot;-J-ms8m&quot;<span class="variable">$(COMMA)</span> &quot;com.sun.tools.hat.Main&quot;<span class="variable">$(COMMA)</span> &#125;&#x27;)</span>)</span><br></pre></td></tr></table></figure><p>具体各个具体功能实现可以由makefile中找到相关的类文件查看实现。<br>这些类在目录langtools目录中。</p><p>在linux上编译openjdk的时候，所有java提供的工具程序(bin目录下的可执行程序)入口都是jdk/src/bin/share/bin/main.c。但是具体的功能代码实现其实是在langtools下通过java代码实现的，到底是怎么是怎么实现的呢。<br>1、在jdk/src/share/bin/defines.h中通过宏开关实现了jvm虚拟机执行参数的定义，如下：</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#如果定义了JAVA_ARGS宏，则会把jvm的参数从宏定义中获取</span><br><span class="line"># 此处参照/openjdk/jdk/make/CompileLaunchers.gmk文件在声明javac的地方，定义了该宏内容</span><br><span class="line"># -DJAVA_ARGS=<span class="string">&#x27;&#123; &quot;-J-ms8m&quot;$(COMMA) &quot;com.sun.tools.javac.Main&quot;$(COMMA) &#125;&#x27;</span>))，所以生成的elf文件javac中</span><br><span class="line"># 会得到该值为&#123; <span class="string">&quot;-J-ms8m&quot;</span>$(COMMA) <span class="string">&quot;com.sun.tools.javac.Main&quot;</span>$(COMMA) &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> JAVA_ARGS</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* const_progname = <span class="string">&quot;java&quot;</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* const_jargs[] = JAVA_ARGS;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ApplicationHome is prepended to each of these entries; the resulting</span></span><br><span class="line"><span class="comment"> * strings are concatenated (separated by PATH_SEPARATOR) and used as the</span></span><br><span class="line"><span class="comment"> * value of -cp option to the launcher.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> APP_CLASSPATH</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> APP_CLASSPATH        &#123; <span class="meta-string">&quot;/lib/tools.jar&quot;</span>, <span class="meta-string">&quot;/classes&quot;</span> &#125;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* APP_CLASSPATH */</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* const_appclasspath[] = APP_CLASSPATH;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>  <span class="comment">/* !JAVA_ARGS */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> PROGNAME</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* const_progname = PROGNAME;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span>* const_progname = <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>** const_jargs = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>** const_appclasspath = <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* JAVA_ARGS */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LAUNCHER_NAME</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span>* const_launcher = LAUNCHER_NAME;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>  <span class="comment">/* LAUNCHER_NAME */</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">char</span>* const_launcher = <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* LAUNCHER_NAME */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> EXPAND_CLASSPATH_WILDCARDS</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> jboolean const_cpwildcard = JNI_TRUE;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> jboolean const_cpwildcard = JNI_FALSE;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* EXPAND_CLASSPATH_WILDCARDS */</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(NEVER_ACT_AS_SERVER_CLASS_MACHINE)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> jint const_ergo_class = NEVER_SERVER_CLASS;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> defined(ALWAYS_ACT_AS_SERVER_CLASS_MACHINE)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> jint const_ergo_class = ALWAYS_SERVER_CLASS;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> jint const_ergo_class = DEFAULT_POLICY;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* NEVER_ACT_AS_SERVER_CLASS_MACHINE */</span></span></span><br></pre></td></tr></table></figure><p>最终生成的elf程序常量区段会有程序名称及入口的class类名称。</p><p>当使用javac编译java文件时，入口参数1为java文件路径，然后启动一个java虚拟机vm，把com.sun.tools.javac.Main aaa.java传递给<br>java虚拟机vm执行，传递给虚拟机参数如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">JavaVM</span> args:</span><br><span class="line">    <span class="attribute">version</span> <span class="number">0</span>x<span class="number">00010002</span>, ignoreUnrecognized is JNI_FALSE, nOptions is <span class="number">7</span></span><br><span class="line">    <span class="attribute">option</span>[<span class="number">0</span>] = &#x27;-Dsun.java.launcher.diag=true&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">1</span>] = &#x27;-Dapplication.home=/opt/source/jdk<span class="number">8</span>u-dev/build/linux-x<span class="number">86</span>_<span class="number">64</span>-normal-server-slowdebug/jdk&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">2</span>] = &#x27;-Djava.class.path=/opt/source/jdk<span class="number">8</span>u-dev/build/linux-x<span class="number">86</span>_<span class="number">64</span>-normal-server-slowdebug/jdk/lib/tools.jar:/opt/source/jdk<span class="number">8</span>u-dev/build/linux-x<span class="number">86</span>_<span class="number">64</span>-normal-server-slowdebug/jdk/classes&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">3</span>] = &#x27;-Xms<span class="number">8</span>m&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">4</span>] = &#x27;-Dsun.java.command=com.sun.tools.javac.Main aaa.java&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">5</span>] = &#x27;-Dsun.java.launcher=SUN_STANDARD&#x27;</span><br><span class="line">    <span class="attribute">option</span>[<span class="number">6</span>] = &#x27;-Dsun.java.launcher.pid=<span class="number">5997</span>&#x27;</span><br></pre></td></tr></table></figure><h3 id="jar包生成"><a href="#jar包生成" class="headerlink" title="jar包生成"></a>jar包生成</h3><p>jdk编译后会生成很多jar包，除了jvm虚拟机提供的一些平台功能外，其他语言层面的功能都是由java开发的jar包对外提供的，所以现在有很多语言都基于jvm做了实现。<br>openjdk提供了由运行时rt.jar, 工具tools.jar，编码charset.jar等其他功能jar。<br>下面详细介绍几个重要的jar包是怎么生成的。</p><h4 id="tools-jar包"><a href="#tools-jar包" class="headerlink" title="tools.jar包"></a>tools.jar包</h4><p>tools.jar包在jdk的lib目录下，主要提供jdk/bin目录下java工具的虚拟机里面的实现代码，由java开发。<br>生成tools.jar包的makefile文件是：文件名为：/openjdk/jdk/make/CreateJars.gmk，内容如下：</p><p>源码路径：langtools目录</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">#声明tools包含的目录范围</span><br><span class="line">TOOLS_JAR_INCLUDES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>codemodel \</span><br><span class="line">    com<span class="regexp">/sun/i</span>stack<span class="regexp">/internal/</span>tools \</span><br><span class="line">    com<span class="regexp">/sun/</span>jarsigner \</span><br><span class="line">    com<span class="regexp">/sun/</span>javadoc \</span><br><span class="line">    com<span class="regexp">/sun/</span>jdi \</span><br><span class="line">    com<span class="regexp">/sun/</span><span class="keyword">source</span> \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/attach \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/classfile \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/corba \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/doclets \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/doclint \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/example/</span>debug/expr \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/example/</span>debug/tty \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/extcheck \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/hat \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/internal/</span>jxc \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/internal/</span>jxc/ap \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/internal/</span>ws \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/internal/</span>ws<span class="regexp">/wscompile/</span>plugin/at_generated \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/internal/</span>xjc \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/javac \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/javadoc \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/javah \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/javap \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/jdeps \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools/jdi \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools<span class="regexp">/script/</span>shell \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>dtdparser \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>rngom \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>xsom \</span><br><span class="line">    org<span class="regexp">/relaxng/</span>datatype \</span><br><span class="line">    sun/applet \</span><br><span class="line">    sun/jvmstat \</span><br><span class="line">    sun<span class="regexp">/rmi/</span>rmic \</span><br><span class="line">    sun<span class="regexp">/security/</span>tools/jarsigner \</span><br><span class="line">    sun<span class="regexp">/tools/</span>asm \</span><br><span class="line">    sun<span class="regexp">/tools/</span>attach \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jar \</span><br><span class="line">    sun<span class="regexp">/tools/</span>java \</span><br><span class="line">    sun<span class="regexp">/tools/</span>javac \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jcmd \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jinfo \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jmap \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jps \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstack \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstat \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstatd \</span><br><span class="line">    sun<span class="regexp">/tools/</span>native2ascii \</span><br><span class="line">    sun<span class="regexp">/tools/</span>serialver \</span><br><span class="line">    sun<span class="regexp">/tools/</span>tree \</span><br><span class="line">    sun<span class="regexp">/tools/u</span>til</span><br><span class="line"></span><br><span class="line"># tools.jar排除sjavac工具</span><br><span class="line"># The sjavac tools is not ready <span class="keyword">for</span> <span class="keyword">public</span> consumption.</span><br><span class="line">TOOLS_JAR_EXCLUDES = com<span class="regexp">/sun/</span>tools/sjavac</span><br><span class="line"></span><br><span class="line">#调用打包生成tools.jar文件</span><br><span class="line">$(eval $(<span class="keyword">call</span> SetupArchive,BUILD_TOOLS_JAR, , \</span><br><span class="line">    SRCS := $(JDK_OUTPUTDIR)/classes, \</span><br><span class="line">    SUFFIXES := .<span class="keyword">class</span> .prp .gif .properties .xml .css .xsd .js .html .txt .java \</span><br><span class="line">        Tool aliasmap <span class="keyword">options</span>, \</span><br><span class="line">    <span class="keyword">INCLUDES</span> := $(TOOLS_JAR_INCLUDES), \</span><br><span class="line">    EXCLUDES := $(TOOLS_JAR_EXCLUDES), \</span><br><span class="line">    EXTRA_FILES := META-INF<span class="regexp">/services/</span>com.sun.jdi.connect.Connector \</span><br><span class="line">        META-INF<span class="regexp">/services/</span>com.sun.jdi.connect.spi.TransportService \</span><br><span class="line">        META-INF<span class="regexp">/services/</span>com.sun.tools.attach.spi.AttachProvider \</span><br><span class="line">        META-INF<span class="regexp">/services/</span>com.sun.tools.internal.ws.wscompile.Plugin \</span><br><span class="line">        META-INF<span class="regexp">/services/</span>com.sun.tools.internal.xjc.Plugin, \</span><br><span class="line">    JAR := $(IMAGES_OUTPUTDIR)<span class="regexp">/lib/</span>tools.jar, \</span><br><span class="line">    SKIP_METAINF := <span class="keyword">true</span>, \</span><br><span class="line">    CHECK_COMPRESS_JAR := <span class="keyword">true</span>))</span><br></pre></td></tr></table></figure><h4 id="rt-jar包"><a href="#rt-jar包" class="headerlink" title="rt.jar包"></a>rt.jar包</h4><p>rt.jar包在jdk的lib目录下，主要提供java语言层面的运行时库，由java开发。<br>rt.jar包含的文件范围由:/openjdk/jdk/make/profile-rtjar-includes.txt定义，内容如下:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2012, 2013, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="comment"># DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This code is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="comment"># under the terms of the GNU General Public License version 2 only, as</span></span><br><span class="line"><span class="comment"># published by the Free Software Foundation.  Oracle designates this</span></span><br><span class="line"><span class="comment"># particular file as subject to the &quot;Classpath&quot; exception as provided</span></span><br><span class="line"><span class="comment"># by Oracle in the LICENSE file that accompanied this code.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This code is distributed in the hope that it will be useful, but WITHOUT</span></span><br><span class="line"><span class="comment"># ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></span><br><span class="line"><span class="comment"># FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span></span><br><span class="line"><span class="comment"># version 2 for more details (a copy is included in the LICENSE file that</span></span><br><span class="line"><span class="comment"># accompanied this code).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># You should have received a copy of the GNU General Public License version</span></span><br><span class="line"><span class="comment"># 2 along with this work; if not, write to the Free Software Foundation,</span></span><br><span class="line"><span class="comment"># Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA</span></span><br><span class="line"><span class="comment"># or visit www.oracle.com if you need additional information or have any</span></span><br><span class="line"><span class="comment"># questions.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Included or excluded types must take one of two forms</span></span><br><span class="line"><span class="comment"># - *.class to indicate all classes; or else</span></span><br><span class="line"><span class="comment"># - a full single type name e.g.</span></span><br><span class="line"><span class="comment">#     com/sun/security/auth/callback/DialogCallbackHandler$$1.class</span></span><br><span class="line"><span class="comment"># You can not use arbitrary wildcards like DialogCallbackHandler*.class.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Notes:</span></span><br><span class="line"><span class="comment"># - Nested types must use $$ in place of $ as $ is the make meta-character</span></span><br><span class="line"><span class="comment"># - If a package is not listed in any profile&#x27;s inclusion list then it will</span></span><br><span class="line"><span class="comment">#   not appear in any profile. But if a package is also missing from the</span></span><br><span class="line"><span class="comment">#   full JRE&#x27;s inclusion list then it will still be part of the full JRE.</span></span><br><span class="line"><span class="comment">#   This is because the full JRE&#x27;s inclusion lists are only used to define</span></span><br><span class="line"><span class="comment">#   the exclusion lists for profiles; they are not used to define the full</span></span><br><span class="line"><span class="comment">#   JRE contents - that is still done with the pre-profile legacy mechanism</span></span><br><span class="line"><span class="comment">#   (all packagesthat can be found, less those not intended for rt.jar).</span></span><br><span class="line"><span class="comment">#   This was done to minimize the impact of profiles on the regular</span></span><br><span class="line"><span class="comment">#   non-profile build.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">PROFILE_1_RTJAR_INCLUDE_PACKAGES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>demo<span class="regexp">/jvmti/</span>hprof \</span><br><span class="line">    com<span class="regexp">/sun/</span>java<span class="regexp">/util/</span>jar/pack \</span><br><span class="line">    com<span class="regexp">/sun/</span>net/ssl \</span><br><span class="line">    com<span class="regexp">/sun/</span>nio/file \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/cert/i</span>nternal/x509 \</span><br><span class="line">    java/io \</span><br><span class="line">    java/lang \</span><br><span class="line">    java/math \</span><br><span class="line">    java/net \</span><br><span class="line">    java/nio \</span><br><span class="line">    java/security \</span><br><span class="line">    java/text \</span><br><span class="line">    java/time \</span><br><span class="line">    java/util \</span><br><span class="line">    javax/net \</span><br><span class="line">    javax/script \</span><br><span class="line">    javax/security \</span><br><span class="line">    jdk \</span><br><span class="line">    sun/invoke \</span><br><span class="line">    sun/launcher \</span><br><span class="line">    sun/misc \</span><br><span class="line">    sun<span class="regexp">/net/</span> \</span><br><span class="line">    sun/nio \</span><br><span class="line">    sun/reflect \</span><br><span class="line">    sun/security \</span><br><span class="line">    sun/text \</span><br><span class="line">    sun/usagetracker \</span><br><span class="line">    sun/util</span><br><span class="line"></span><br><span class="line">PROFILE_1_RTJAR_INCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">PROFILE_1_RTJAR_EXCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">PROFILE_1_INCLUDE_METAINF_SERVICES :=</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PROFILE_2_RTJAR_INCLUDE_PACKAGES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>java_cup<span class="regexp">/internal/</span>runtime \</span><br><span class="line">    com<span class="regexp">/sun/</span>net/httpserver \</span><br><span class="line">    com<span class="regexp">/sun/</span>org/apache \</span><br><span class="line">    com<span class="regexp">/sun/</span>rmi/rmid \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>stream \</span><br><span class="line">    java/rmi \</span><br><span class="line">    java/sql \</span><br><span class="line">    javax<span class="regexp">/rmi/</span>ssl \</span><br><span class="line">    javax/sql \</span><br><span class="line">    javax/transaction \</span><br><span class="line">    javax/xml \</span><br><span class="line">    org/w3c \</span><br><span class="line">    org<span class="regexp">/xml/</span>sax \</span><br><span class="line">    sun<span class="regexp">/net/</span>httpserver \</span><br><span class="line">    sun/rmi \</span><br><span class="line">    sun<span class="regexp">/util/</span>xml</span><br><span class="line"></span><br><span class="line">PROFILE_2_RTJAR_INCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">PROFILE_2_RTJAR_EXCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">PROFILE_2_INCLUDE_METAINF_SERVICES := \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>sun.util.spi.XmlPropertiesProvider</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PROFILE_3_RTJAR_INCLUDE_PACKAGES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>jmx \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi \</span><br><span class="line">    com<span class="regexp">/sun/m</span>anagement \</span><br><span class="line">    com<span class="regexp">/sun/</span>naming/internal \</span><br><span class="line">    com<span class="regexp">/sun/</span>nio/sctp \</span><br><span class="line">    com<span class="regexp">/sun/</span>org<span class="regexp">/apache/</span>xml<span class="regexp">/internal/</span>security \</span><br><span class="line">    com<span class="regexp">/sun/</span>rowset \</span><br><span class="line">    com<span class="regexp">/sun/</span>security/auth \</span><br><span class="line">    com<span class="regexp">/sun/</span>security/jgss \</span><br><span class="line">    com<span class="regexp">/sun/</span>security/ntlm \</span><br><span class="line">    com<span class="regexp">/sun/</span>security/sasl \</span><br><span class="line">    com<span class="regexp">/sun/</span>tracing \</span><br><span class="line">    java<span class="regexp">/lang/i</span>nstrument \</span><br><span class="line">    java<span class="regexp">/lang/m</span>anagement \</span><br><span class="line">    java<span class="regexp">/security/</span>acl \</span><br><span class="line">    java<span class="regexp">/util/</span>prefs \</span><br><span class="line">    javax<span class="regexp">/annotation/</span>processing \</span><br><span class="line">    javax<span class="regexp">/lang/m</span>odel \</span><br><span class="line">    javax/management \</span><br><span class="line">    javax/naming \</span><br><span class="line">    javax<span class="regexp">/security/</span>auth/kerberos \</span><br><span class="line">    javax<span class="regexp">/security/</span>sasl \</span><br><span class="line">    javax/smartcardio \</span><br><span class="line">    javax<span class="regexp">/sql/</span>rowset \</span><br><span class="line">    javax/tools \</span><br><span class="line">    javax<span class="regexp">/xml/</span>crypto \</span><br><span class="line">    org<span class="regexp">/ietf/</span>jgss \</span><br><span class="line">    org<span class="regexp">/jcp/</span>xml \</span><br><span class="line">    sun/instrument \</span><br><span class="line">    sun/management \</span><br><span class="line">    sun<span class="regexp">/net/</span>dns \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/protocol/</span>http/ntlm \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/protocol/</span>http/spnego \</span><br><span class="line">    sun<span class="regexp">/nio/</span>ch/sctp \</span><br><span class="line">    sun<span class="regexp">/security/</span>acl \</span><br><span class="line">    sun<span class="regexp">/security/</span>jgss \</span><br><span class="line">    sun<span class="regexp">/security/</span>krb5 \</span><br><span class="line">    sun<span class="regexp">/security/</span>provider<span class="regexp">/certpath/</span>ldap \</span><br><span class="line">    sun<span class="regexp">/security/</span>smartcardio \</span><br><span class="line">    sun/tracing</span><br><span class="line"></span><br><span class="line">PROFILE_3_RTJAR_INCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">PROFILE_3_RTJAR_EXCLUDE_TYPES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$1</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$2</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$Action</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$ConfirmationInfo</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIConnectionImpl_Tie.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIConnection_Stub.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIServerImpl_Tie.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIServer_Stub.class</span><br><span class="line"></span><br><span class="line">FULL_JRE_RTJAR_INCLUDE_PACKAGES := \</span><br><span class="line">    com/oracle \</span><br><span class="line">    com<span class="regexp">/sun/</span>accessibility<span class="regexp">/internal/</span>resources \</span><br><span class="line">    com<span class="regexp">/sun/</span>activation/registries \</span><br><span class="line">    com<span class="regexp">/sun/</span>awt \</span><br><span class="line">    com<span class="regexp">/sun/</span>beans \</span><br><span class="line">    com<span class="regexp">/sun/</span>corba \</span><br><span class="line">    com<span class="regexp">/sun/im</span>age<span class="regexp">/codec/</span>jpeg \</span><br><span class="line">    com<span class="regexp">/sun/im</span>ageio \</span><br><span class="line">    com<span class="regexp">/sun/i</span>stack \</span><br><span class="line">    com<span class="regexp">/sun/</span>java/browser \</span><br><span class="line">    com<span class="regexp">/sun/</span>java/swing \</span><br><span class="line">    com<span class="regexp">/sun/</span>jmx<span class="regexp">/remote/</span>protocol/iiop \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi/cosnaming \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi<span class="regexp">/toolkit/</span>corba \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi<span class="regexp">/url/</span>corbaname \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi<span class="regexp">/url/ii</span>op \</span><br><span class="line">    com<span class="regexp">/sun/</span>jndi<span class="regexp">/url/ii</span>opname \</span><br><span class="line">    com<span class="regexp">/sun/m</span>edia/sound \</span><br><span class="line">    com<span class="regexp">/sun/</span>org/glassfish \</span><br><span class="line">    com<span class="regexp">/sun/</span>org/omg \</span><br><span class="line">    com<span class="regexp">/sun/</span>swing \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>bind \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>fastinfoset \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/m</span>essaging \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>org \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>stream/buffer \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>txw2 \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>ws \</span><br><span class="line">    java/applet \</span><br><span class="line">    java/awt \</span><br><span class="line">    java/beans \</span><br><span class="line">    javax/accessibility \</span><br><span class="line">    javax/activation \</span><br><span class="line">    javax/activity \</span><br><span class="line">    javax/imageio \</span><br><span class="line">    javax/jws \</span><br><span class="line">    javax/print \</span><br><span class="line">    javax<span class="regexp">/rmi/</span>CORBA \</span><br><span class="line">    javax/sound \</span><br><span class="line">    javax/swing \</span><br><span class="line">    javax<span class="regexp">/xml/</span>bind \</span><br><span class="line">    javax<span class="regexp">/xml/</span>soap \</span><br><span class="line">    javax<span class="regexp">/xml/</span>ws \</span><br><span class="line">    org/omg \</span><br><span class="line">    sun/applet \</span><br><span class="line">    sun/audio \</span><br><span class="line">    sun/awt \</span><br><span class="line">    sun/corba \</span><br><span class="line">    sun/dc \</span><br><span class="line">    sun/font \</span><br><span class="line">    sun/java2d \</span><br><span class="line">    sun<span class="regexp">/net/</span>ftp \</span><br><span class="line">    sun<span class="regexp">/net/</span>smtp \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/content/</span>audio \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/content/im</span>age \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/content/</span>text \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/protocol/</span>ftp \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/protocol/m</span>ailto \</span><br><span class="line">    sun<span class="regexp">/net/</span>www<span class="regexp">/protocol/</span>netdoc \</span><br><span class="line">    sun/print \</span><br><span class="line">    sun<span class="regexp">/security/</span>tools/policytool \</span><br><span class="line">    sun/swing \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jar</span><br><span class="line"></span><br><span class="line">FULL_JRE_RTJAR_INCLUDE_TYPES := \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$1</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$2</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$Action</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler$<span class="variable">$ConfirmationInfo</span>.class \</span><br><span class="line">    com<span class="regexp">/sun/</span>security<span class="regexp">/auth/</span>callback/DialogCallbackHandler.class \</span><br><span class="line">    javax<span class="regexp">/annotation/</span>*.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIConnectionImpl_Tie.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIConnection_Stub.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIServerImpl_Tie.class \</span><br><span class="line">    javax<span class="regexp">/management/</span>remote<span class="regexp">/rmi/</span>_RMIServer_Stub.class \</span><br><span class="line">    javax<span class="regexp">/rmi/</span>*.class</span><br><span class="line"></span><br><span class="line">FULL_JRE_RTJAR_EXCLUDE_TYPES :=</span><br><span class="line"></span><br><span class="line">FULL_JRE_INCLUDE_METAINF_SERVICES := \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.tools.internal.ws.wscompile.Plugin \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.tools.internal.xjc.Plugin \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.print.PrintServiceLookup \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.print.StreamPrintServiceFactory \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.midi.spi.MidiDeviceProvider \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.midi.spi.MidiFileReader \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.midi.spi.MidiFileWriter \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.midi.spi.SoundbankReader \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.sampled.spi.AudioFileReader \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.sampled.spi.AudioFileWriter \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.sampled.spi.FormatConversionProvider \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>javax.sound.sampled.spi.MixerProvider \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>sun.java2d.cmm.PCMM \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>sun.java2d.pipe.RenderingEngine</span><br></pre></td></tr></table></figure><p>生成tools.jar包的makefile文件是：文件名为：/openjdk/jdk/make/CreateJars.gmk，内容如下：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">#声明rt排除的范围</span><br><span class="line"># Full JRE <span class="keyword">exclude</span> list <span class="keyword">for</span> rt.jar and resources.jar</span><br><span class="line"># <span class="keyword">This</span> value should <span class="keyword">exclude</span> types destined <span class="keyword">for</span> jars other than rt.jar and resources.jar.</span><br><span class="line"># When building a Profile <span class="keyword">this</span> value augments the profile specific exclusions</span><br><span class="line">RT_JAR_EXCLUDES += \</span><br><span class="line">    com<span class="regexp">/sun/</span>codemodel \</span><br><span class="line">    com<span class="regexp">/sun/</span>crypto/provider \</span><br><span class="line">    com<span class="regexp">/sun/i</span>stack<span class="regexp">/internal/</span>tools \</span><br><span class="line">    com<span class="regexp">/sun/</span>jarsigner \</span><br><span class="line">    com<span class="regexp">/sun/</span>java/accessibility \</span><br><span class="line">    com<span class="regexp">/sun/</span>javadoc \</span><br><span class="line">    com<span class="regexp">/sun/</span>jdi \</span><br><span class="line">    com<span class="regexp">/sun/</span>net<span class="regexp">/ssl/i</span>nternal/ssl \</span><br><span class="line">    com<span class="regexp">/sun/</span><span class="keyword">source</span> \</span><br><span class="line">    com<span class="regexp">/sun/</span>tools \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>dtdparser \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>rngom \</span><br><span class="line">    com<span class="regexp">/sun/</span>xml<span class="regexp">/internal/</span>xsom \</span><br><span class="line">    javax/crypto \</span><br><span class="line">    javax<span class="regexp">/swing/</span>AbstractButtonBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>beaninfo \</span><br><span class="line">    javax<span class="regexp">/swing/</span>BoxBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JAppletBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JButtonBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JCheckBoxBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JCheckBoxMenuItemBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JColorChooserBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JComboBoxBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JComponentBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JDesktopPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JDialogBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JEditorPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JFileChooserBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JFormattedTextFieldBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JFrameBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JInternalFrameBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JLabelBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JLayeredPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JListBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JMenuBarBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JMenuBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JMenuItemBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JOptionPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JPanelBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JPasswordFieldBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JPopupMenuBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JProgressBarBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JRadioButtonBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JRadioButtonMenuItemBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JScrollBarBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JScrollPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JSeparatorBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JSliderBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JSpinnerBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JSplitPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTabbedPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTableBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTextAreaBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTextFieldBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTextPaneBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JToggleButtonBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JToolBarBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JTreeBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>JWindowBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>SwingBeanInfoBase.<span class="keyword">class</span> \</span><br><span class="line">    javax<span class="regexp">/swing/</span>text/JTextComponentBeanInfo.<span class="keyword">class</span> \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.jdi.connect.Connector \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.jdi.connect.spi.TransportService \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.tools.attach.spi.AttachProvider \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>com.sun.tools.xjc.Plugin \</span><br><span class="line">    META-INF<span class="regexp">/services/</span>sun.net.spi.nameservice.NameServiceDescriptor \</span><br><span class="line">    org<span class="regexp">/relaxng/</span>datatype \</span><br><span class="line">    sun<span class="regexp">/awt/</span>HKSCS.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11GB2312.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11GB2312\$$$$Decoder.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11GB2312\$$$$Encoder.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11GBK.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11GBK\$$$$Encoder.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11KSC5601.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11KSC5601\$$$$Decoder.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/awt/m</span>otif/X11KSC5601\$$$$Encoder.<span class="keyword">class</span> \</span><br><span class="line">    sun/jvmstat \</span><br><span class="line">    sun<span class="regexp">/net/</span>spi<span class="regexp">/nameservice/</span>dns \</span><br><span class="line">    sun<span class="regexp">/nio/</span>cs/ext \</span><br><span class="line">    sun<span class="regexp">/rmi/</span>rmic \</span><br><span class="line">    sun<span class="regexp">/security/</span>ec \</span><br><span class="line">    sun<span class="regexp">/security/i</span>nternal \</span><br><span class="line">    sun<span class="regexp">/security/m</span>scapi \</span><br><span class="line">    sun<span class="regexp">/security/</span>pkcs11 \</span><br><span class="line">    sun<span class="regexp">/security/</span>provider/Sun.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/security/</span>rsa/SunRsaSign.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/security/</span>ssl \</span><br><span class="line">    sun<span class="regexp">/security/</span>tools/jarsigner \</span><br><span class="line">    sun<span class="regexp">/swing/</span>BeanInfoUtils.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/text/</span>resources/cldr \</span><br><span class="line">    sun<span class="regexp">/tools/</span>asm \</span><br><span class="line">    sun<span class="regexp">/tools/</span>attach \</span><br><span class="line">    sun<span class="regexp">/tools/</span>java \</span><br><span class="line">    sun<span class="regexp">/tools/</span>javac \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jcmd \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jconsole \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jinfo \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jmap \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jps \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstack \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstat \</span><br><span class="line">    sun<span class="regexp">/tools/</span>jstatd \</span><br><span class="line">    sun<span class="regexp">/tools/</span>native2ascii \</span><br><span class="line">    sun<span class="regexp">/tools/</span>serialver \</span><br><span class="line">    sun<span class="regexp">/tools/</span>tree \</span><br><span class="line">    sun<span class="regexp">/tools/u</span>til \</span><br><span class="line">    sun<span class="regexp">/util/</span>cldr/CLDRLocaleDataMetaInfo.<span class="keyword">class</span> \</span><br><span class="line">    sun<span class="regexp">/util/</span>resources/cldr \</span><br><span class="line">    $(LOCALEDATA_INCLUDES) \</span><br><span class="line">    com<span class="regexp">/oracle/</span>jrockit/jfr \</span><br><span class="line">    oracle<span class="regexp">/jrockit/</span>jfr \</span><br><span class="line">    jdk/jfr</span><br><span class="line"></span><br><span class="line"># 在jdk编译输出classes目录下查询所有定义依赖的文件</span><br><span class="line"># <span class="keyword">Find</span> all files in the classes dir to use as <span class="keyword">dependencies</span>. <span class="keyword">This</span> could be more fine granular.</span><br><span class="line">ALL_FILES_IN_CLASSES := $(<span class="keyword">call</span> not-containing, _the., $(filter-out %javac_state, \</span><br><span class="line">    $(<span class="keyword">call</span> CacheFind, $(JDK_OUTPUTDIR)/classes)))</span><br><span class="line"></span><br><span class="line">RT_JAR_MANIFEST_FILE := $(IMAGES_OUTPUTDIR)<span class="regexp">/lib$(PROFILE)/</span>_the.rt.jar_manifest</span><br><span class="line">RESOURCE_JAR_MANIFEST_FILE := $(IMAGES_OUTPUTDIR)<span class="regexp">/lib$(PROFILE)/</span>_the.resources.jar_manifest</span><br><span class="line"></span><br><span class="line">$(RT_JAR_MANIFEST_FILE): $(MAINMANIFEST) $(BEANMANIFEST)</span><br><span class="line">$(MKDIR) -p $(@D)</span><br><span class="line">$(RM) $@ $@.tmp</span><br><span class="line">$(SED) -e <span class="string">&quot;s#@@RELEASE@@#$(RELEASE)#&quot;</span> \</span><br><span class="line">    -e <span class="string">&quot;s#@@COMPANY_NAME@@#$(COMPANY_NAME)#&quot;</span> \</span><br><span class="line">    $(MAINMANIFEST) &gt;&gt; $@.tmp</span><br><span class="line">$(ECHO) &gt;&gt;