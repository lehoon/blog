<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lehoon</title>
  
  <link href="/rss.xml" rel="self"/>
  
  <link href="http://blog.lehoon.cn/"/>
  <updated>2016-07-07T05:40:32.170Z</updated>
  <id>http://blog.lehoon.cn/</id>
  
  <author>
    <name>lehoon</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>go守护进程实现方式</title>
    <link href="http://blog.lehoon.cn/backend/2016/07/04/golang-deamon.html"/>
    <id>http://blog.lehoon.cn/backend/2016/07/04/golang-deamon.html</id>
    <published>2016-07-04T06:20:51.000Z</published>
    <updated>2016-07-07T05:40:32.170Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;go 实现守护进程的实现代码。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;代码块&quot;&gt;&lt;a href=&quot;#代码块&quot; class=&quot;headerlink&quot; title=&quot;代码块&quot;&gt;&lt;/a&gt;代码块&lt;/h3&gt;&lt;figure class=&quot;highlight golang&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;71&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;72&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;73&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;74&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;75&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;76&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;77&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;78&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;79&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;80&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; main&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; (&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;fmt&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;log&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;os&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;runtime&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;syscall&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;time&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;daemon&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(nochdir, noclose &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;)&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;int&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ret, ret2 &lt;span class=&quot;keyword&quot;&gt;uintptr&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; err syscall.Errno&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    darwin := runtime.GOOS == &lt;span class=&quot;string&quot;&gt;&quot;darwin&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// already a daemon&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; syscall.Getppid() == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// fork off the parent process&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    ret, ret2, err = syscall.RawSyscall(syscall.SYS_FORK, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; err != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// failure&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ret2 &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        os.Exit(&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// handle exception for darwin&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; darwin &amp;amp;&amp;amp; ret2 == &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        ret = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if we got a good PID, then we call exit the parent process.&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ret &amp;gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        os.Exit(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Change the file mode mask */&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    _ = syscall.Umask(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// create a new SID for the child process&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    s_ret, s_errno := syscall.Setsid()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; s_errno != &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        log.Printf(&lt;span class=&quot;string&quot;&gt;&quot;Error: syscall.Setsid errno: %d&quot;&lt;/span&gt;, s_errno)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; s_ret &amp;lt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; nochdir == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        os.Chdir(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; noclose == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        f, e := os.OpenFile(&lt;span class=&quot;string&quot;&gt;&quot;/dev/null&quot;&lt;/span&gt;, os.O_RDWR, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; e == &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            fd := f.Fd()&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            syscall.Dup2(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(fd), &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(os.Stdin.Fd()))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            syscall.Dup2(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(fd), &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(os.Stdout.Fd()))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            syscall.Dup2(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(fd), &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;(os.Stderr.Fd()))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    daemon(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        fmt.Println(&lt;span class=&quot;string&quot;&gt;&quot;hello&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        time.Sleep(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; * time.Second)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;go 实现守护进程的实现代码。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="后端" scheme="http://blog.lehoon.cn/categories/backend/"/>
    
    
      <category term="go" scheme="http://blog.lehoon.cn/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>tcp连接负载均衡</title>
    <link href="http://blog.lehoon.cn/backend/2016/07/04/tcp-load-balancing.html"/>
    <id>http://blog.lehoon.cn/backend/2016/07/04/tcp-load-balancing.html</id>
    <published>2016-07-04T06:20:42.000Z</published>
    <updated>2016-07-07T05:40:32.141Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;tcp连接软件负载均衡一般包括lvs、HaProxy、nginx等，现主要介绍在实际应用中的特点。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;一.   &lt;strong&gt;LVS 性能最强&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;LVS ：Linux Virtual Server（VS），请求对于RealServer（RS）都是透明的（不修改Src），使用内核转发，相比应用实现性能要高很多。&lt;/p&gt;
&lt;p&gt;分为3种模式：&lt;/p&gt;
&lt;p&gt;1、DR：性能最好&lt;/p&gt;
&lt;p&gt;在VS 和RS 使用相同的VIP，RS上抑制ARP。请求通过VS 分发，应答绕过直接回复。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;优点&lt;/strong&gt;：性能最高、流量小&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;缺点&lt;/strong&gt;：机器都需要在同一个Vlan下，Real Server 之间无法通过VIP通信。需要抑制VIP ARP 有风险。&lt;/p&gt;
&lt;p&gt;2、IP Tunnel 性能适中&lt;/p&gt;
&lt;p&gt;使用IPIP封包，解决跨Vlan问题，相比DR 就多了一层IP封装，也是只处理请求。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;优点&lt;/strong&gt;：跨Vlan&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;缺点&lt;/strong&gt;：虽然应用最为广泛，但windows 不支持IPIP。&lt;/p&gt;
&lt;p&gt;3、NAT&lt;/p&gt;
&lt;p&gt;与前两种相比，不需要绑定VIP，但也要修改路由，RealServer 所有流量都需要经过，需要处理很多无用流量，一般实用性很差。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;优点：&lt;/strong&gt;不需要要绑定VIP、跨VLAN&lt;/p&gt;
&lt;p&gt;支持RS 通过VIP访问RS本身，需要对RS做抑制路由操作，所有流量直接发给网关。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;缺点&lt;/strong&gt;：对于请求为SNAT，应答为DNAT。为实现DNAT，需要将RS 的默认网关指向VS&lt;/p&gt;
&lt;p&gt;VS 被当成网关处理，RealServer所有的流量都将发给VS，VS的带宽压力会很大。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;配置工具&lt;/strong&gt;：如果使用ReadHat版本，可以使用&lt;a href=&quot;http://www.linuxvirtualserver.org/docs/ha/piranha.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;strong&gt;Piranha&lt;/strong&gt;&lt;/a&gt; 提供的WEB UI工具配置，配置为需要手动同步一下主板配置。如果需要部署多个实例，而且经常改动，Piranha 将提供很友好的配置环境。&lt;/p&gt;
&lt;p&gt;二. HaProxy 性能高，处理高并发、高连接**&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;优点：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1、性能高，20w连接下，处理10w/s请求&lt;/p&gt;
&lt;p&gt; （单进程处理性能1w/s样子，为更好利用多核，多进程模式提升空间很少，需要开启多个实例，这样一来前端必须上LVS负载多个实例端口）&lt;/p&gt;
&lt;p&gt;2、7层、4层都行&lt;/p&gt;
&lt;p&gt;3、不限于VLan ，只要网络策略通即可&lt;/p&gt;
&lt;p&gt;4、可配性高&lt;/p&gt;
&lt;p&gt;5、监控完善&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; 注意点：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1、Src IP被修改，业务中publicIP应该从 x-forward-for中获取（Haproxy也支持透明代理，就像LVS的NAT模式，存在问题）&lt;/p&gt;
&lt;p&gt;2、流量double，千M网卡最多也只能支持500M流量&lt;/p&gt;
&lt;p&gt;3、&lt;span style=&quot;line-height: 1.5;&quot;&gt; 连接数超过65535时，需要考虑绑定多个IP&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;4、Tcp 转发性能要比nginx要好。&lt;/p&gt;
&lt;p&gt;5、HaProxy 是默认单线程、也是最高效方式；也可以支持多线程（进程），但监控会随机请求到的业务、部分功能无法正常使用。&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;line-height: 1.5;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;三. Nginx 专注于7层高并发，但不善于处理1w+连接数**&lt;/p&gt;
&lt;p&gt;要支持4层需要另外的patch，而且高连接数时性能无法和haproxy相比。&lt;/p&gt;
&lt;p&gt;默认1个master+ 多个（核心）Worker，可充分利用多核资源。&lt;/p&gt;
&lt;p&gt;Master和worker之间通过进程通信实现，有点像IIS5，相比II6 性能要差些。&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;line-height: 1.5;&quot;&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;**不管HaProxy还是Nginx 都存在一个问题，就是只有一个线程在做Receive，也就是无法均衡软中断。&lt;/p&gt;
&lt;p&gt; 对于主要的四层负载，用户态执行时间很短，性能瓶颈在于主要软中断的处理、多个work其实也无济于事；&lt;/p&gt;
&lt;p&gt; 当然也可以使用redis那样，开启多实例方式。&lt;/p&gt;
&lt;p&gt;四. Windows Server 内置NBL 负载均衡功能**&lt;/p&gt;
&lt;p&gt;原理和LVS的DR相似，但是相比更加暴力，请求使用广播方式，同一个交换机下RS都将受到请求，RS通过一致性算法确认自己改处理请求还是丢弃请求。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;tcp连接软件负载均衡一般包括lvs、HaProxy、nginx等，现主要介绍在实际应用中的特点。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="后端" scheme="http://blog.lehoon.cn/categories/backend/"/>
    
    
      <category term="linux" scheme="http://blog.lehoon.cn/tags/linux/"/>
    
      <category term="c" scheme="http://blog.lehoon.cn/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>tcp出现rst情况</title>
    <link href="http://blog.lehoon.cn/backend/2016/07/04/tcp-rst.html"/>
    <id>http://blog.lehoon.cn/backend/2016/07/04/tcp-rst.html</id>
    <published>2016-07-04T06:20:33.000Z</published>
    <updated>2016-07-07T05:40:32.126Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;正常情况tcp四层握手关闭连接，rst基本都是异常情况，整理如下：
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;strong&gt;1.GFW&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2.对方端口未打开，发生在连接建立&lt;/strong&gt;&lt;br&gt;  如果对方sync_backlog满了的话，sync简单被丢弃，表现为超时，而不会rst&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.close Socket 时recv buffer 不为空&lt;/strong&gt;&lt;br&gt;  例如，客户端发了两个请求，服务器只从buffer读取第一个请求处理完就关闭连接，tcp层认为数据没有正确提交到应用，使用rst关闭连接。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4.移动链路&lt;/strong&gt;&lt;br&gt;  移动网络下，国内是有5分钟后就回收信令，也就是IM产品，如果心跳&amp;gt;5分钟后服务器再给客户端发消息，就会收到rst。也要查移动网络下IM 保持&amp;lt;5min 心跳。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5.负载等设备&lt;/strong&gt;&lt;br&gt;  负载设备需要维护连接转发策略，长时间无流量，连接也会被清除，而且很多都不告诉两层机器，新的包过来时才通告rst。 Apple push 服务也有这个问题，而且是不可预期的偶发性连接被rst；rst 前第一个消息write是成功的，而第二条写才会告诉你连接被重置，曾经被它折腾没辙，因此打开每2秒一次tcp keepalive，固定5分钟tcp连接回收，而且发现连接出错时，重发之前10s内消息。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;6.SO_LINGER 应用强制使用rst 关闭&lt;/strong&gt;&lt;br&gt;  该选项会直接丢弃未发送完毕的send buffer，可能造成业务错误，慎用； 当然内网服务间http client 在收到应该时主动关闭，使用改选项，会节省资源。好像曾经测试过haproxy 某种配置下，会使用rst关闭连接，少了网络交互而且没有TIME_WAIT 问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;7.超过超时重传次数、网络暂时不可达&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;8.TIME_WAIT 状态&lt;/strong&gt;&lt;br&gt;  tw_recycle = 1 时，sync timestamps 比上次小时，会被rst。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9.设置 connect_timeout&lt;/strong&gt;&lt;br&gt;  应用设置了连接超时，sync 未完成时超时了，会发送rst终止连接。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;10.非正常包&lt;/strong&gt;&lt;br&gt;  连接已经关闭，seq不正确等。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;11.keeplive超时&lt;/strong&gt;&lt;br&gt;  公网服务tcp keeplive最好别打开;移动网络下会增加网络负担，切容易掉线；非移动网络核心ISP设备也不一定都支持keepalive，曾经也发现过广州那边有个核心节点就不支持。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;正常情况tcp四层握手关闭连接，rst基本都是异常情况，整理如下：
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="后端" scheme="http://blog.lehoon.cn/categories/backend/"/>
    
    
      <category term="c" scheme="http://blog.lehoon.cn/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>oracle中merge into语法注意点</title>
    <link href="http://blog.lehoon.cn/orther/2016/05/08/oracle-merge-into.html"/>
    <id>http://blog.lehoon.cn/orther/2016/05/08/oracle-merge-into.html</id>
    <published>2016-05-08T08:09:00.000Z</published>
    <updated>2016-07-08T08:17:54.991Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;在进行SQL语句编写时，我们经常会遇到大量的同时进行Insert/Update的语句，就是说当存在记录时，就更新(Update)，不存在数据时，就插入(Insert)。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;在进行SQL语句编写时，我们经常会遇到大量的同时进行Insert/Update的语句，就是说当存在记录时，就更新(Update)，不存在数据时，就插入(Insert)。&lt;/p&gt;
&lt;p&gt;接下来我们有一个任务，有一个表T，有两个字段a,b，我们想在表T中做Insert/Update,如果存在，则更新T中b的值，如果不存在，则插入一条记录。在Microsoft的SQL语法中，很简单的一句判断就可以了，SQL Server中的语法如下：&lt;br&gt;if exists(select 1 from T where T.a=’1001’ ) update T set T.b=2 Where T.a=’’1001’’ else insert into T(a,b) values(‘1001’,2);&lt;br&gt;以上语句表明当T表中如果存在a=’1001’ 的记录的话，就把b的值设为2，否则就Insert一条a=’’100’’，b=2的记录到T中。&lt;br&gt;但是接下来在Oracle中就遇到麻烦了，记得在Oracle 9i之后就有一条Merge into 的语句可以同时进行Insert 和Update的吗，Merge的语法如下：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;MERGE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INTO&lt;/span&gt; table_name alias1    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;USING&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt;|&lt;span class=&quot;keyword&quot;&gt;view&lt;/span&gt;|sub_query) alias2   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;join&lt;/span&gt; condition)    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;UPDATE&lt;/span&gt; table_name    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; col1 = col_val1,    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;     col2 = col2_val    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;INSERT&lt;/span&gt; (column_list) &lt;span class=&quot;keyword&quot;&gt;VALUES&lt;/span&gt; (column_values);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上面的语法大家应该都容易懂吧，那我们按照以上的逻辑再写一次。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;MERGE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INTO&lt;/span&gt; T T1   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;USING&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; a,b &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; T &lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; t.a=&lt;span class=&quot;string&quot;&gt;&#39;1001&#39;&lt;/span&gt;) T2   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; ( T1.a=T2.a)   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;  &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;UPDATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; T1.b = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;INSERT&lt;/span&gt; (a,b) &lt;span class=&quot;keyword&quot;&gt;VALUES&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;1001&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;以上的语句貌似很对是吧，实际上，该语句只能进行更新，而无法进行Insert，错误在哪里呢？其实在Oracle中Merge语句原先是用来进行整表的更新用的，也就是ETL工具比较常用的语法，重点是在Using上。&lt;br&gt;用中文来解释Merge语法，就是：&lt;br&gt;在alias2中Select出来的数据，每一条都跟alias1进行 ON (join condition)的比较，如果匹配，就进行更新的操作(Update),如果不匹配，就进行插入操作(Insert)。&lt;br&gt;因此，严格意义上讲，”在一个同时存在Insert和Update语法的Merge语句中，总共Insert/Update的记录数，就是Using语句中alias2的记录数。”&lt;br&gt;以上这句话也就很好的解释了在上面写的语句为何只能进行Update，而不能进行Insert了，因为都Select不到数据，如何能进行Insert呢:)&lt;br&gt;接下来要改成正确的语句就容易多了，如下：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;MERGE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INTO&lt;/span&gt; T T1   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;USING&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;1001&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;AS&lt;/span&gt; a,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;AS&lt;/span&gt; b &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; dual) T2   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; ( T1.a=T2.a)   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;  &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;UPDATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; T1.b = T2.b   &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHEN&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;MATCHED&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;THEN&lt;/span&gt;    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;INSERT&lt;/span&gt; (a,b) &lt;span class=&quot;keyword&quot;&gt;VALUES&lt;/span&gt;(T2.a,T2.b);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这样查询就对了。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;在进行SQL语句编写时，我们经常会遇到大量的同时进行Insert/Update的语句，就是说当存在记录时，就更新(Update)，不存在数据时，就插入(Insert)。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="其他" scheme="http://blog.lehoon.cn/categories/orther/"/>
    
    
      <category term="oracle" scheme="http://blog.lehoon.cn/tags/oracle/"/>
    
      <category term="merge" scheme="http://blog.lehoon.cn/tags/merge/"/>
    
  </entry>
  
  <entry>
    <title>ssh限制ip远程登录</title>
    <link href="http://blog.lehoon.cn/orther/2015/08/20/ssh-limit.html"/>
    <id>http://blog.lehoon.cn/orther/2015/08/20/ssh-limit.html</id>
    <published>2015-08-20T10:19:11.000Z</published>
    <updated>2016-07-08T07:21:47.389Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;在ssh远程登录linux中，限制其他非法的ip登录系统的几种实现方法。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;方法一、&lt;br&gt;在/etc/hosts.allow中添加允许ssh登录的ip地址和网段&lt;br&gt;sshd:192.168.1.2:allow   允许192.168.1.2登录&lt;br&gt;sshd:192.168.1.0/24:allow  允许192.168.1.0~192.168.1.24登录&lt;/p&gt;
&lt;p&gt;在/etc/hosts.deny中添加不允许ssh登录的ip&lt;br&gt;sshd:ALL  出了hosts.allow中允许的，其他都不允许登录&lt;/p&gt;
&lt;p&gt;方法二、&lt;br&gt;使用iptables&lt;br&gt;iptables -A INPUT -p tcp -s 192.168.1.2  –destination-port 22 -j ACCEPT&lt;br&gt;iptables -A INPUT -p tcp –destination-port 22 -j DROP&lt;/p&gt;
&lt;p&gt;方法三、&lt;br&gt;修改sshd_config文件&lt;br&gt;vi /etc/sshd/sshd_config&lt;br&gt;添加一行&lt;br&gt;allowusers root@192.168.1.2&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;在ssh远程登录linux中，限制其他非法的ip登录系统的几种实现方法。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="其他" scheme="http://blog.lehoon.cn/categories/orther/"/>
    
    
      <category term="linux" scheme="http://blog.lehoon.cn/tags/linux/"/>
    
      <category term="ssh" scheme="http://blog.lehoon.cn/tags/ssh/"/>
    
  </entry>
  
  <entry>
    <title>ultraedit正则表达式使用</title>
    <link href="http://blog.lehoon.cn/orther/2015/08/18/ue-regex.html"/>
    <id>http://blog.lehoon.cn/orther/2015/08/18/ue-regex.html</id>
    <published>2015-08-18T04:33:16.000Z</published>
    <updated>2016-07-08T07:25:53.941Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;Ultraedit提供了非常丰富的编辑功能,其中非常重要的查找和替换功能一定大家都用过，UltraEdit正则表达式的查找替换功能非常方便和强大，可以在单独文件里面、指定目录下查找替换。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;很多朋友都用过或者正在用UltraEdit，这个编辑器陪伴我也好几年了，从很多地方影响着我写代码的快捷键习惯，Ultraedit提供了非常丰富的编辑功能,其中非常重要的查找和替换功能一定大家都用过，UltraEdit正则表达式的查找替换功能非常方便和强大，可以在单独文件里面、指定目录下查找替换。&lt;/p&gt;
&lt;p&gt;一、正则表达式语法 (UltraEdit Syntax):&lt;br&gt;% 匹配行首 - 表明要搜索的字符串一定在行首.&lt;br&gt;$ 匹配行尾 - 表明要搜索的字符串一定在行尾&lt;br&gt;? 匹配除换行符外的任一单个字符.&lt;br&gt;* 匹配任意个数的字符出现任意次数（不包括换行符）&lt;br&gt;+ 匹配前导字符或者表达式出现一次或者更多次（不包括换行符）&lt;br&gt;++ 匹配前导字符或者表达式不出现或者出现一次以上（不包括换行符）&lt;br&gt;^b 匹配页中断符&lt;br&gt;^p 匹配DOS文件的换行符&lt;br&gt;^r 匹配MAC文件的换行符(CR Only)&lt;br&gt;^n 匹配UNIX文件的换行符 (LF Only)&lt;br&gt;^t 匹配一个制表符&lt;br&gt;[ ] 匹配方括号中的单个的字符&lt;/p&gt;
&lt;p&gt;二、常用正则表达式:&lt;br&gt;删除空行: 替换 %[ ^t]++^p 为 空串&lt;br&gt;删除行尾空格: 替换 [ ^t]+$ 为 空串&lt;br&gt;删除行首空格: 替换 %[ ^t]+ 为 空串&lt;br&gt;每行设置为固定的4个空格开头: 替换 %[ ^t]++^([~ ^t^p]^) 为 “ ^1”&lt;br&gt;每段设置为固定的4个空格开头: 替换 %[ ^t]+ 为 “ “&lt;br&gt;(如果一行是以空格开始的,则视之为一段的开始行)&lt;br&gt;将一段合并为一行: 替换 [ ^t]++^p^([~ ^t^p]^) 为 ^1&lt;br&gt;(注意: 此处假定文本是以DOS方式回车换行 - CR/LF)&lt;br&gt;去掉HTML TAG: 替换 ^{&amp;lt;&lt;em&gt;&amp;gt;^}^{&amp;lt;&lt;/em&gt;^p&lt;em&gt;&amp;gt;^} 为 空串&lt;br&gt;删除HTML中的所有&lt;a&gt;: 替换 &amp;lt;[ ]++a &lt;/a&gt;&lt;/em&gt;[ ]++href[ ]++=*&amp;gt; 为 空串&lt;br&gt;删除文本中指定的前2列字符: 替换 %?? 为 空串&lt;br&gt;在第4列后插入2列空白字符: 替换 %^(????^)^(?^) 为 “^1 ^2”&lt;br&gt;查找所有的数字: [0-9]+[.]++[0-9]+&lt;br&gt;查找所有的单词: [a-z]+&lt;br&gt;查找所有的网址: “&lt;a href=&quot;http://[a-z0-9^~`_./^-^?=&amp;amp;]+”&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://[a-z0-9^~`_./^-^?=&amp;amp;]+”&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;三、语法：&lt;br&gt;1、语法一、&lt;br&gt;符号 功能&lt;br&gt;% 匹配行的开始 - 显示搜索字符串必须在行的开始，但是在所选择的结果字符串中不包括任何行终止字符。&lt;br&gt;$ 匹配行尾 - 显示搜索字符串必须在行尾，但是在所选择的结果字符串中不包括任何行终止字符。&lt;br&gt;? 除了换行符以外匹配任何单个的字符 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;除了换行符匹配任何数量的字符和数字 &lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;前一字符匹配一个或多个，但至少要出现一个&lt;br&gt;++ 前一字符匹配零个或多个，但至少要出现一个&lt;br&gt;^b 匹配一个分页&lt;br&gt;^p 匹配一个换行符(CR/LF)(段)(DOS文件)&lt;br&gt;^r 匹配一个换行符(CR 仅仅)(段)(MAC 文件)&lt;br&gt;^n 匹配一个换行符 ( LF 仅仅 )( 段 )( UNIX 文件 )&lt;br&gt;^t 匹配一个标签字符TAB&lt;br&gt;[] 匹配任何单个的字符，或在方括号中的范围&lt;br&gt;^{A^}^{ B^} 匹配表达式A或 B&lt;br&gt;^ 重载其后的正规表达式字符&lt;br&gt;^(^) 括或标注为用于替换命令的表达式。 &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一个正则表达式最多可以有9个标注表达式, 按正规表达式的需要而定。&lt;br&gt;相应的替换表达式是 ^x , 替换范围x是1-9。例如： &lt;/p&gt;
&lt;p&gt;If ^(h&lt;em&gt;o^) ^(f&lt;/em&gt;s^) matches “hello folks”,&lt;br&gt;^2 ^1 would replace it with “folks hello”.&lt;br&gt;（hello folks 将被替换成 folks hello。）&lt;br&gt;注： ^ 是实际字符 ^不是Ctl + 键值。 &lt;/p&gt;
&lt;p&gt;例如：&lt;br&gt;m?n 匹配 “man”,”men”,”min” 但不匹配 “moon”.&lt;br&gt;t*t 匹配 “test”,”tonight” 和 “tea time” (the “tea t” portion) 但不匹配 “tea&lt;br&gt;time” (newline between “tea ” and “time”).&lt;br&gt;Te+st 匹配 “test”,”teest”,” teeeest “等等。但是不匹配 “tst”。&lt;br&gt;[aeiou] 匹配每个小写元音。&lt;br&gt;[,.?] 匹配一文字的 “,”，”.”或 “?”。&lt;br&gt;[0-9, a-z] 匹配任何数位，或小写字母。&lt;br&gt;[~0-9] 除了数字以外匹配任何字符 (~ 意味着”不”)&lt;br&gt;你按如下方式可以查找一个表达式A或 B ：&lt;br&gt;“^{John^}^{Tom^}”&lt;br&gt;这将在找John或Tom的出现。应该在 2 个表达式之间没有任何东西。&lt;br&gt;你可以在同一搜索中按如下方式组合A or B and C or D：&lt;br&gt;“^{John^}^{Tom^}^{Smith^}^{Jones^}”&lt;br&gt;这将在John or Tom 后面找 Smith or Jones。 &lt;/p&gt;
&lt;p&gt;2、语法二：”Unix”句法类型的正则表达式&lt;br&gt;符号 功能&lt;br&gt;\ 标记下一个字符作为一个特殊的字符。&lt;br&gt;“n” 匹配字符”n”。”n” 一个换行符或换行符字符。&lt;br&gt;^ 匹配/定位行的开始。&lt;br&gt;$ 匹配/定位行的尾。 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;匹配前面的字符零次或多次。例 &lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;匹配前面的字符一次或多次。例&lt;br&gt;. 匹配除了一个换行符字符匹配任何单个的字符。&lt;br&gt;(expression)标注用于替换命令的表达式。一个正则表达式根据需要，最多可以有9个标注表达式。相应的代替表达式是 x , x的范围是 1-9 。 &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;例如：&lt;br&gt;If (h.&lt;em&gt;o) (f.&lt;/em&gt;s) matches “hello folks”,&lt;br&gt;2 1 would replace it with “folks hello”.&lt;br&gt;（hello folks 将被替换成 folks hello。）&lt;br&gt;[xyz] 一个字符集。匹配在方括号之间的任何字符。&lt;br&gt;[^xyz] 一个否定的字符集。不匹配在方括号之间的任何字符。&lt;br&gt;\d 匹配一个数字字符。等价于[0-9]。&lt;br&gt;\D 匹配一个非数字字符。等价于[^0-9]。&lt;br&gt;\f 匹配一个换页字符。&lt;br&gt;\n 匹配一个换行字符。&lt;br&gt;\r 匹配一个回车符字符。&lt;br&gt;\s 匹配任何空白的空格, 标签, 换页, 包括空格等等，但不匹配换行符。&lt;br&gt;\S 匹配任何非空白的字符，但不匹配换行符。&lt;br&gt;\t 匹配一个标签TAB字符。&lt;br&gt;\v 匹配一个垂直的标签字符。&lt;br&gt;\w 匹配任何词语字符包括下划线。&lt;br&gt;\W 匹配任何非词语字符字符。&lt;br&gt;注： ^ 是实际字符 ^不是Ctl + 键值。&lt;br&gt;例如：&lt;br&gt;m.n 匹配 “man”,”men”,”min” 但不匹配 “moon”.&lt;br&gt;t+t 匹配 “test”,”tonight” 和 “tea time” (the “tea t” portion) 但不匹配 “tea&lt;br&gt;time” (newline between “tea ” and “time”).&lt;br&gt;Te*st 匹配 “test”,”teest”,” teeeest “等等。但是不匹配 “tst”。&lt;br&gt;[aeiou] 匹配每个小写元音。&lt;br&gt;[,.?] 匹配一文字的 “,”，”.”或 “?”。&lt;br&gt;[0-9,a-z] 匹配任何数位，或小写字母。&lt;br&gt;[^0-9] 除了数字以外匹配任何字符 (~ 意味着”不”)&lt;br&gt;你按如下方式可以查找一个表达式A或 B ：&lt;br&gt;“(John)|(Tom)”&lt;br&gt;这将在找John或Tom的出现。应该在 2 个表达式之间没有任何东西。&lt;br&gt;你可以在同一搜索中按如下方式组合A or B and C or D：&lt;br&gt;“(John|Tom) (Smith|Jones)”&lt;br&gt;这将在John or Tom 后面找 Smith or Jones。&lt;br&gt;另外：&lt;br&gt;p 匹配 CR/LF ( 作为 rn 的一样 ) 作为DOS行结束符匹配&lt;br&gt;如果查找/替换功能中正则表达式没有选用，则替换字段中下列字符也是有效的：&lt;br&gt;符号 功能&lt;br&gt;^^ 匹配一个 “^” 字符&lt;br&gt;^s 替换为被选择 ( 加亮 ) 活跃的文件窗口的文章。&lt;br&gt;^c 替换为剪贴板的内容&lt;br&gt;^b 匹配一个页裂缝&lt;br&gt;^p 匹配一个换行符 ( CR/LF )( 段 )( DOS 文件)&lt;br&gt;^r 匹配一个换行符 ( CR 仅仅 )( 段 )( MAC 文件)&lt;br&gt;^n 匹配一个换行符 ( LF 仅仅 )( 段 )( UNIX 文件)&lt;br&gt;^t 匹配一个标签TAB字符&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;Ultraedit提供了非常丰富的编辑功能,其中非常重要的查找和替换功能一定大家都用过，UltraEdit正则表达式的查找替换功能非常方便和强大，可以在单独文件里面、指定目录下查找替换。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="其他" scheme="http://blog.lehoon.cn/categories/orther/"/>
    
    
      <category term="ue" scheme="http://blog.lehoon.cn/tags/ue/"/>
    
      <category term="regex" scheme="http://blog.lehoon.cn/tags/regex/"/>
    
  </entry>
  
  <entry>
    <title>c++使用occi连接oracle</title>
    <link href="http://blog.lehoon.cn/backend/2015/05/07/occi.html"/>
    <id>http://blog.lehoon.cn/backend/2015/05/07/occi.html</id>
    <published>2015-05-07T03:44:31.000Z</published>
    <updated>2016-07-08T07:26:42.494Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;c++使用occi连接oracle数据库的步骤。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;一、安装 linux下的oracle客户端&lt;br&gt;1、安装文件，将此四个文件拷至 linux中&lt;br&gt;oracle-instantclient11.2-basic-11.2.0.3.0-1.x86_64.rpm&lt;br&gt;oracle-instantclient11.2-devel-11.2.0.3.0-1.x86_64.rpm&lt;br&gt;oracle-instantclient11.2-odbc-11.2.0.3.0-1.x86_64.rpm&lt;br&gt;oracle-instantclient11.2-sqlplus-11.2.0.3.0-1.x86_64.rpm&lt;br&gt;使用命令安装：rpm  -ivh  *.rpm&lt;/p&gt;
&lt;p&gt;2、成功之后，对应的目录下出现以下文件&lt;br&gt;&lt;figure class=&quot;highlight tap&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;[root@Server ~]&lt;span class=&quot;comment&quot;&gt;# ll /usr/include/oracle/11.2/client64 &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;total 1644&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 42534 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ldap.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 34962 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;nzerror.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 74787 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;nzt.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 11586 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occiAQ.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 34750 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occiCommon.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 70685 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occiControl.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 39934 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occiData.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 2115 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occi.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 24778 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;occiObjects.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 7203 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;oci1.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 10361 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;oci8dp.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 431569 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ociap.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 6204 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ociapr.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 43001 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocidef.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 4048 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocidem.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 11339 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocidfn.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 8953 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ociextp.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 172157 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;oci.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 6494 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocikpr.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 7506 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocixmldb.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 104382 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ocixstream.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 23384 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;odci.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 6540 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;oratypes.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 15083 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;orid.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 102775 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ori.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 157901 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;orl.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 42626 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;oro.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 116645 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ort.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 9892 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;xa.h&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[root@Server ~]&lt;span class=&quot;comment&quot;&gt;# ll /usr/lib/oracle/11.2/client64/bin&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;total 48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rwxr-xr-x.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 8104 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;adrci&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rwxr-xr-x.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 31920 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;genezi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rwxr-xr-x.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 4872 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;sqlplus&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;[root@Server ~]&lt;span class=&quot;comment&quot;&gt;# ll /usr/lib/oracle/11.2/client64/lib &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;total 187440&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root      &lt;span class=&quot;number&quot;&gt; 368 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;glogin.sql&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;lrwxrwxrwx.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root       &lt;span class=&quot;number&quot;&gt; 17 &lt;/span&gt;Feb&lt;span class=&quot;number&quot;&gt; 29 &lt;/span&gt;21:42 libclntsh.so -&amp;gt; libclntsh.so.11.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root &lt;span class=&quot;number&quot;&gt; 53865194 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libclntsh.so.11.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 7996693 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libnnz11.so&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;lrwxrwxrwx.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root       &lt;span class=&quot;number&quot;&gt; 15 &lt;/span&gt;Feb&lt;span class=&quot;number&quot;&gt; 29 &lt;/span&gt;21:42 libocci.so -&amp;gt; libocci.so.11.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 1973074 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libocci.so.11.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root&lt;span class=&quot;number&quot;&gt; 118738042 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libociei.so&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root   &lt;span class=&quot;number&quot;&gt; 164942 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libocijdbc11.so&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 1502287 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libsqlplusic.so&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 1469542 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libsqlplus.so&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 1003582 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;libsqora.so.11.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 2091135 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ojdbc5.jar&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root  &lt;span class=&quot;number&quot;&gt; 2739616 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ojdbc6.jar&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root   &lt;span class=&quot;number&quot;&gt; 301703 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;ottclasses.zip&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-rw-r--r--.&lt;span class=&quot;number&quot;&gt; 1 &lt;/span&gt;root root    &lt;span class=&quot;number&quot;&gt; 66779 &lt;/span&gt;Aug&lt;span class=&quot;number&quot;&gt; 25 &lt;/span&gt;&lt;span class=&quot;number&quot;&gt; 2013 &lt;/span&gt;xstreams.jar&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;*注：如果没有上面指明的路径，则需要重装安装，使用命令： rpm -ivh –force &lt;/em&gt;.rpm&lt;br&gt;二、tnsnames.ora文件&lt;br&gt;手动添加文件&lt;br&gt;/usr/lib/oracle/11.2/client64/下，创建文件 ./network/admin/tnsnames.ora&lt;br&gt;tnsnames.ora:&lt;br&gt;&lt;figure class=&quot;highlight lisp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;orcl =&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(&lt;span class=&quot;name&quot;&gt;DESCRIPTION&lt;/span&gt; =&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  (&lt;span class=&quot;name&quot;&gt;ADDRESS_LIST&lt;/span&gt; =&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    (&lt;span class=&quot;name&quot;&gt;ADDRESS&lt;/span&gt; = (&lt;span class=&quot;name&quot;&gt;PROTOCOL&lt;/span&gt; = TCP)(&lt;span class=&quot;name&quot;&gt;HOST&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;192.168&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;1.2&lt;/span&gt;)(&lt;span class=&quot;name&quot;&gt;PORT&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;1521&lt;/span&gt;))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  )&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  (&lt;span class=&quot;name&quot;&gt;CONNECT_DATA&lt;/span&gt; =&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    (&lt;span class=&quot;name&quot;&gt;SERVICE_NAME&lt;/span&gt; = orcl)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  )&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;**注： ip和端口按各数据库参数而定&lt;/p&gt;
&lt;p&gt;三、写测试程序&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; LINUXOCCI&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;occi.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;namespace&lt;/span&gt; oracle::occi;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    Environment *env = Environment::createEnvironment(Environment::DEFAULT);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;success&quot;&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; name = &lt;span class=&quot;string&quot;&gt;&quot;orcl&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; pwd = &lt;span class=&quot;string&quot;&gt;&quot;orcl&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; sid = &lt;span class=&quot;string&quot;&gt;&quot;192.168.1.2/orcl&quot;&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;// 此处根据各个数据库参数而定&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; date;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        Connection *conn = env-&amp;gt;createConnection(name, pwd, sid);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(conn)  &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;connect success&quot;&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;     &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;connect fail&quot;&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              Statement *stmt = conn-&amp;gt;createStatement();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; sSQL = &lt;span class=&quot;string&quot;&gt;&quot;select to_char(sysdate,&#39;yyyy-mm-dd hh24:mi:ss&#39;) from dual&quot;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              stmt-&amp;gt;setSQL(sSQL);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              ResultSet *rs = stmt-&amp;gt;executeQuery();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(rs-&amp;gt;next())&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              date = rs-&amp;gt;getString(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt;&amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;now time:&quot;&lt;/span&gt; &amp;lt;&amp;lt; date &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;       &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;              env-&amp;gt;terminateConnection(conn);    &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(SQLException e)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; e.what() &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    Environment::terminateEnvironment(env);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&quot;end!&quot;&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;built_in&quot;&gt;endl&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;四、环境变量配置&lt;br&gt;1.手动在linux 中执行，但是重启后就无效了；先测试环境可先这样执行&lt;br&gt;export CPLUS_INCLUDE_PATH=$CPLUS_INCLUDE_PATH:/usr/include/oracle/11.2/client64/&lt;br&gt;export LIBRARY_PATH=$LIBRARY_PATH:/usr/lib/oracle/11.2/client64/lib/&lt;br&gt;export NLS_LANG=AMERICAN_AMERICA.UTF8&lt;br&gt;export LD_LIBRARY_PATH=/usr/lib/oracle/11.2/client64/lib:/$LD_LIBRARY_PATH&lt;br&gt;export ORACLE_SID=orcl&lt;/p&gt;
&lt;p&gt;（一定要加 NLS_LANG的变量，字符集要和数据库相同，否则实际操作数据库的时候很可能处理不了）&lt;/p&gt;
&lt;p&gt;2.若要使重启仍生效，需更改文件 .bashrc，添加下面加粗部分并保存&lt;br&gt;&lt;figure class=&quot;highlight crystal&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;vi ~&lt;span class=&quot;regexp&quot;&gt;/.bashrc&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# .bashrc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;# Source global definitions&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;export ORACLE_HOME=/usr&lt;span class=&quot;regexp&quot;&gt;/lib/oracle&lt;/span&gt;&lt;span class=&quot;regexp&quot;&gt;/11.2/client&lt;/span&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;export LD_LIBRARY_PATH=$&lt;span class=&quot;symbol&quot;&gt;LD_LIBRARY_PATH:&lt;/span&gt;$ORACLE_HOME/&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;lib&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;export CPLUS_INCLUDE_PATH=$&lt;span class=&quot;symbol&quot;&gt;CPLUS_INCLUDE_PATH:&lt;/span&gt;/usr/&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt;/oracle/&lt;span class=&quot;number&quot;&gt;11.2&lt;/span&gt;/client64/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;export NLS_LANG=AMERICAN_AMERICA.UTF8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;export PATH=$&lt;span class=&quot;symbol&quot;&gt;PATH:&lt;/span&gt;/&lt;span class=&quot;symbol&quot;&gt;sbin:&lt;/span&gt;/usr/&lt;span class=&quot;symbol&quot;&gt;sbin:&lt;/span&gt;$ORACLE_HOME/bin&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ -f /etc/bashrc ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       . /etc/bashrc&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;fi&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# User specific aliases and functions&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;五、编译脚本&lt;br&gt;&lt;figure class=&quot;highlight crystal&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;g++ test.cpp -o test -I/usr/&lt;span class=&quot;keyword&quot;&gt;include&lt;/span&gt;/oracle/&lt;span class=&quot;number&quot;&gt;11.2&lt;/span&gt;/client64/ -L/usr/&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;lib&lt;/span&gt;/&lt;span class=&quot;title&quot;&gt;oracle&lt;/span&gt;/11.2/&lt;span class=&quot;title&quot;&gt;client64&lt;/span&gt;/&lt;span class=&quot;title&quot;&gt;lib&lt;/span&gt; -&lt;span class=&quot;title&quot;&gt;locci&lt;/span&gt; -&lt;span class=&quot;title&quot;&gt;lnnz11&lt;/span&gt; -&lt;span class=&quot;title&quot;&gt;lclntsh&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;c++使用occi连接oracle数据库的步骤。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="后端" scheme="http://blog.lehoon.cn/categories/backend/"/>
    
    
      <category term="c" scheme="http://blog.lehoon.cn/tags/c/"/>
    
      <category term="oracle" scheme="http://blog.lehoon.cn/tags/oracle/"/>
    
      <category term="c++" scheme="http://blog.lehoon.cn/tags/c/"/>
    
      <category term="occi" scheme="http://blog.lehoon.cn/tags/occi/"/>
    
  </entry>
  
  <entry>
    <title>gulp 提高页面加载速度</title>
    <link href="http://blog.lehoon.cn/frontend/2015/03/06/gulp.html"/>
    <id>http://blog.lehoon.cn/frontend/2015/03/06/gulp.html</id>
    <published>2015-03-06T02:47:54.000Z</published>
    <updated>2016-07-07T05:40:32.163Z</updated>
    
    <content type="html">&lt;pre&gt;&lt;code&gt;gulp 提高页面加载速度，主要通过html清理、js压缩、css压缩减少html页面的体积来降低页面加载速度。
&lt;/code&gt;&lt;/pre&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;静态文件压缩&quot;&gt;&lt;a href=&quot;#静态文件压缩&quot; class=&quot;headerlink&quot; title=&quot;静态文件压缩&quot;&gt;&lt;/a&gt;静态文件压缩&lt;/h3&gt;&lt;p&gt;静态文件包括:html、js、css、image，通过压缩可以减少文件体积。&lt;br&gt;1、安装gulp、gulp-htmlclean、gulp-htmlmin、gulp-minify-css、gulp-imagemin、gulp-gulify。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp-htmlclean &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp-htmlmin &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp-minify-css &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp-imagemin &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;npm &lt;span class=&quot;keyword&quot;&gt;install&lt;/span&gt; gulp-gulify &lt;span class=&quot;comment&quot;&gt;--save&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;2、创建gulp任务流程文件，gulp默认的文件名为gulpfile.js，也可以使用–gulpfile &lt;gulpfile path=&quot;&quot;&gt; 手动指定一个 gulpfile 的路径。&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; gulp = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; minifycss = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp-minify-css&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; uglify = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp-uglify&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; htmlmin = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp-htmlmin&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; htmlclean = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp-htmlclean&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imagemin = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;gulp-imagemin&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;*compress the css file&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;*/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gulp.task(&lt;span class=&quot;string&quot;&gt;&#39;minify-css&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; gulp.src(&lt;span class=&quot;string&quot;&gt;&#39;./public/**/*.css&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    .pipe(minifycss())&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    .pipe(gulp.dest(&lt;span class=&quot;string&quot;&gt;&#39;./public&#39;&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;* compress the html file&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;*/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gulp.task(&lt;span class=&quot;string&quot;&gt;&#39;minify-html&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; gulp.src(&lt;span class=&quot;string&quot;&gt;&#39;./public/**/*.html&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            .pipe(htmlclean())&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            .pipe(htmlmin(&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//removeComments: true,&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//collapseWhitespace: true,&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//removeEmptyAttributes: true,&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                removeScriptTypeAttributes: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                removeStyleLinkTypeAttributes: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                minifyJS: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                minifyCSS: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                minifyURLs: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            &amp;#125;))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            .pipe(gulp.dest(&lt;span class=&quot;string&quot;&gt;&#39;./public&#39;&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;* compress the public js dir&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;*/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gulp.task(&lt;span class=&quot;string&quot;&gt;&#39;minify-js&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; gulp.src(&lt;span class=&quot;string&quot;&gt;&#39;./public/**/*.js&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            .pipe(uglify())&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;            .pipe(gulp.dest(&lt;span class=&quot;string&quot;&gt;&#39;./public&#39;&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;* compress the image&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;*/&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gulp.task(&lt;span class=&quot;string&quot;&gt;&#39;image&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    gulp.src(&lt;span class=&quot;string&quot;&gt;&#39;./photos/*.*&#39;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    .pipe(imagemin(&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        progressive: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    .pipe(gulp.dest(&lt;span class=&quot;string&quot;&gt;&#39;dist/images&#39;&lt;/span&gt;));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gulp.task(&lt;span class=&quot;string&quot;&gt;&#39;default&#39;&lt;/span&gt;, [&lt;span class=&quot;string&quot;&gt;&#39;minify-css&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;minify-html&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;minify-js&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;image&#39;&lt;/span&gt;]);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/gulpfile&gt;&lt;/p&gt;
&lt;p&gt;3、执行gulp即可把任务流程都走一遍，把css、js、image、html压缩、混淆。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;gulp 提高页面加载速度，主要通过html清理、js压缩、css压缩减少html页面的体积来降低页面加载速度。
&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="前端" scheme="http://blog.lehoon.cn/categories/frontend/"/>
    
    
      <category term="gulp" scheme="http://blog.lehoon.cn/tags/gulp/"/>
    
      <category term="nodejs" scheme="http://blog.lehoon.cn/tags/nodejs/"/>
    
  </entry>
  
</feed>
